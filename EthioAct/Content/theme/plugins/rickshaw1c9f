d3=function(){function ae(n){return null!=n&&!isNaN(n)}function nb(n){return n.length}function tb(n){for(var t=1;n*t%1;)t*=10;return t}function yc(n,t){try{for(var i in t)Object.defineProperty(n.prototype,i,{value:t[i],enumerable:!1})}catch(r){n.prototype=t}}function rt(){}function ve(){}function ib(n,t,i){return function(){var r=i.apply(t,arguments);return r===t?n:r}}function ye(n,t){var i,u,r;if(t in n)return t;for(t=t.charAt(0).toUpperCase()+t.substring(1),i=0,u=fh.length;u>i;++i)if(r=fh[i]+t,r in n)return r}function h(){}function pe(){}function pc(n){function r(){for(var i,r=t,u=-1,f=r.length;++u<f;)(i=r[u].on)&&i.apply(this,arguments);return n}var t=[],i=new rt;return r.on=function(r,u){var e,f=i.get(r);return arguments.length<2?f&&f.on:(f&&(f.on=null,t=t.slice(0,e=t.indexOf(f)).concat(t.slice(e+1)),i.remove(r)),u&&t.push(i.set(r,{on:u})),n)},r}function bt(){n.event.preventDefault()}function wc(){for(var i,t=n.event;i=t.sourceEvent;)t=i;return t}function we(t){for(var i=new pe,r=0,u=arguments.length;++r<u;)i[arguments[r]]=pc(i);return i.of=function(r,u){return function(f){try{var e=f.sourceEvent=n.event;f.target=t;n.event=f;i[f.type].apply(r,u)}finally{n.event=e}}},i}function kt(n){return ff(n,f),n}function be(n){return"function"==typeof n?n:function(){return eh(n,this)}}function bc(n){return"function"==typeof n?n:function(){return oh(n,this)}}function kc(t,i){function r(){this.removeAttribute(t)}function u(){this.removeAttributeNS(t.space,t.local)}function f(){this.setAttribute(t,i)}function e(){this.setAttributeNS(t.space,t.local,i)}function o(){var n=i.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=i.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=n.ns.qualify(t),null==i?t.local?u:r:"function"==typeof i?t.local?s:o:t.local?e:f}function dc(n){return n.trim().replace(/\s+/g," ")}function gc(t){return new RegExp("(?:^|\\s+)"+n.requote(t)+"(?:\\s+|$)","g")}function nl(n,t){function r(){for(var r=-1;++r<i;)n[r](this,t)}function u(){for(var r=-1,u=t.apply(this,arguments);++r<i;)n[r](this,u)}n=n.trim().split(/\s+/).map(rb);var i=n.length;return"function"==typeof t?u:r}function rb(n){var t=gc(n);return function(i,r){if(u=i.classList)return r?u.add(n):u.remove(n);var u=i.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||i.setAttribute("class",dc(u+" "+n))):i.setAttribute("class",dc(u.replace(t," ")))}}function tl(n,t,i){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,i)}function f(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,i)}return null==t?r:"function"==typeof t?f:u}function il(n,t){function i(){delete this[n]}function r(){this[n]=t}function u(){var i=t.apply(this,arguments);null==i?delete this[n]:this[n]=i}return null==t?i:"function"==typeof t?u:r}function rl(t){return"function"==typeof t?t:(t=n.ns.qualify(t)).local?function(){return g.createElementNS(t.space,t.local)}:function(){return g.createElementNS(this.namespaceURI,t)}}function ke(n){return{__data__:n}}function ul(n){return function(){return cp(this,n)}}function ub(t){return arguments.length||(t=n.ascending),function(n,i){return n&&i?t(n.__data__,i.__data__):!n-!i}}function dt(n,t){for(var i=0,u=n.length;u>i;i++)for(var f,e=n[i],r=0,o=e.length;o>r;r++)(f=e[r])&&t(f,r,i);return n}function fl(n){return ff(n,et),n}function fb(n){var t,i;return function(r,u,f){var e,o=n[f].update,s=o.length;for(f!=i&&(i=f,t=0),u>=t&&(t=u+1);!(e=o[t])&&++t<s;);return e}}function nu(){var n=this.__transition__;n&&++n.active}function el(t,i,r){function o(){var n=this[u];n&&(this.removeEventListener(t,n,n.$),delete this[u])}function c(){var n=s(i,ni(arguments));o.call(this);this.addEventListener(t,this[u]=n,n.$=r);n._=i}function l(){var u,f=new RegExp("^__on([^.]+)"+n.requote(t)+"$"),i,r;for(i in this)(u=i.match(f))&&(r=this[i],this.removeEventListener(u[1],r,r.$),delete this[i])}var u="__on"+t,f=t.indexOf("."),s=ol,e;return f>0&&(t=t.substring(0,f)),e=of.get(t),e&&(t=e,s=eb),f?i?c:o:i?h:l}function ol(t,i){return function(r){var u=n.event;n.event=r;i[0]=this.__data__;try{t.apply(this,i)}finally{n.event=u}}}function eb(n,t){var i=ol(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||i.call(t,n)}}function tu(){var t=".dragsuppress-"+ ++lp,f="touchmove"+t,e="selectstart"+t,o="dragstart"+t,u="click"+t,i=n.select(a).on(f,bt).on(e,bt).on(o,bt),r=ti.style,s=r[sf];return r[sf]="none",function(n){function f(){i.on(u,null)}i.on(t,null);r[sf]=s;n&&(i.on(u,function(){bt();f()},!0),setTimeout(f,0))}}function sl(t,i){var u,r,f,e;return(i.changedTouches&&(i=i.changedTouches[0]),u=t.ownerSVGElement||t,u.createSVGPoint)?(r=u.createSVGPoint(),0>hf&&(a.scrollX||a.scrollY)&&(u=n.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),f=u[0][0].getScreenCTM(),hf=!(f.f||f.e),u.remove()),hf?(r.x=i.pageX,r.y=i.pageY):(r.x=i.clientX,r.y=i.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]):(e=t.getBoundingClientRect(),[i.clientX-e.left-t.clientLeft,i.clientY-e.top-t.clientTop])}function hl(n){return n>0?1:0>n?-1:0}function cl(n){return n>1?0:-1>n?u:Math.acos(n)}function hi(n){return n>1?w:-1>n?-w:Math.asin(n)}function ll(n){return((n=Math.exp(n))-1/n)/2}function de(n){return((n=Math.exp(n))+1/n)/2}function ob(n){return((n=Math.exp(2*n))-1)/(n+1)}function al(n){return(n=Math.sin(n/2))*n}function di(){}function gi(n,t,i){return new ge(n,t,i)}function ge(n,t,i){this.h=n;this.s=t;this.l=i}function no(n,t,i){function e(n){return n>360?n-=360:0>n&&(n+=360),60>n?r+(u-r)*n/60:180>n?u:240>n?r+(u-r)*(240-n)/60:r}function f(n){return Math.round(255*e(n))}var r,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,i=0>i?0:i>1?1:i,u=.5>=i?i*(1+t):i+t-i*t,r=2*i-u,ht(f(n+120),f(n),f(n-120))}function nr(n,t,i){return new iu(n,t,i)}function iu(n,t,i){this.h=n;this.c=t;this.l=i}function to(n,t,i){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),tr(i,Math.cos(n*=r)*t,Math.sin(n)*t)}function tr(n,t,i){return new ru(n,t,i)}function ru(n,t,i){this.l=n;this.a=t;this.b=i}function vl(n,t,i){var r=(n+16)/116,u=r+t/500,f=r-i/200;return u=io(u)*pp,r=io(r)*wp,f=io(f)*bp,ht(uo(3.2404542*u-1.5371385*r-.4985314*f),uo(-.969266*u+1.8760108*r+.041556*f),uo(.0556434*u-.2040259*r+1.0572252*f))}function yl(n,t,i){return n>0?nr(Math.atan2(i,t)*o,Math.sqrt(t*t+i*i),n):nr(NaN,NaN,n)}function io(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function ro(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function uo(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function pl(n){return ht(n>>16,255&n>>8,255&n)}function uu(n){return pl(n)+""}function ht(n,t,i){return new fo(n,t,i)}function fo(n,t,i){this.r=n;this.g=t;this.b=i}function ir(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function wl(n,t,i){var s,r,o,u=0,f=0,e=0;if(s=/([a-z]+)\((.*)\)/i.exec(n))switch(r=s[2].split(","),s[1]){case"hsl":return i(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(oo(r[0]),oo(r[1]),oo(r[2]))}return(o=wr.get(n))?t(o.r,o.g,o.b):(null!=n&&"#"===n.charAt(0)&&(4===n.length?(u=n.charAt(1),u+=u,f=n.charAt(2),f+=f,e=n.charAt(3),e+=e):7===n.length&&(u=n.substring(1,3),f=n.substring(3,5),e=n.substring(5,7)),u=parseInt(u,16),f=parseInt(f,16),e=parseInt(e,16)),t(u,f,e))}function bl(n,t,i){var f,s,e=Math.min(n/=255,t/=255,i/=255),r=Math.max(n,t,i),u=r-e,o=(r+e)/2;return u?(s=.5>o?u/(r+e):u/(2-r-e),f=n==r?(t-i)/u+(i>t?6:0):t==r?(i-n)/u+2:(n-t)/u+4,f*=60):(f=NaN,s=o>0&&1>o?0:f),gi(f,s,o)}function kl(n,t,i){n=eo(n);t=eo(t);i=eo(i);var u=ro((.4124564*n+.3575761*t+.1804375*i)/pp),r=ro((.2126729*n+.7151522*t+.072175*i)/wp),f=ro((.0193339*n+.119192*t+.9503041*i)/bp);return tr(116*r-16,500*(u-r),200*(r-f))}function eo(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function oo(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function e(n){return"function"==typeof n?n:function(){return n}}function l(n){return n}function so(n){return function(t,i,r){return 2===arguments.length&&"function"==typeof i&&(r=i,i=null),ho(t,i,n,r)}}function ho(t,i,r,u){function c(){var t,n=e.status;if(!n&&e.responseText||n>=200&&300>n||304===n){try{t=r.call(f,e)}catch(i){return s.error.call(f,i),void 0}s.load.call(f,t)}else s.error.call(f,e)}var f={},s=n.dispatch("beforesend","progress","load","error"),o={},e=new XMLHttpRequest,h=null;return!a.XDomainRequest||"withCredentials"in e||!/^(http(s)?:)?\/\//.test(t)||(e=new XDomainRequest),"onload"in e?e.onload=e.onerror=c:e.onreadystatechange=function(){e.readyState>3&&c()},e.onprogress=function(t){var i=n.event;n.event=t;try{s.progress.call(f,e)}finally{n.event=i}},f.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?o[n]:(null==t?delete o[n]:o[n]=t+"",f)},f.mimeType=function(n){return arguments.length?(i=null==n?null:n+"",f):i},f.responseType=function(n){return arguments.length?(h=n,f):h},f.response=function(n){return r=n,f},["get","post"].forEach(function(n){f[n]=function(){return f.send.apply(f,[n].concat(ni(arguments)))}}),f.send=function(n,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),e.open(n,t,!0),null==i||"accept"in o||(o.accept=i+",*/*"),e.setRequestHeader)for(var c in o)e.setRequestHeader(c,o[c]);return null!=i&&e.overrideMimeType&&e.overrideMimeType(i),null!=h&&(e.responseType=h),null!=u&&f.on("error",u).on("load",function(n){u(null,n)}),s.beforesend.call(f,e),e.send(null==r?null:r),f},f.abort=function(){return e.abort(),f},n.rebind(f,s,"on"),null==u?f:f.get(sb(u))}function sb(n){return 1===n.length?function(t,i){n(null==t?i:null)}:n}function co(){var t=gl(),n=na()-t;n>24?(isFinite(n)&&(clearTimeout(kf),kf=setTimeout(co,n)),bf=0):(bf=1,ah(co))}function dl(n,t,i){var r=arguments.length;2>r&&(t=0);3>r&&(i=Date.now());ot.callback=n;ot.time=i+t}function gl(){var n=Date.now();for(ot=pf;ot;)n>=ot.time&&(ot.flush=ot.callback(n-ot.time)),ot=ot.next;return n}function na(){for(var t,n=pf,i=1/0;n;)n.flush?n=t?t.next=n.next:pf=n.next:(n.time<i&&(i=n.time),n=(t=n).next);return wf=t,i}function hb(n,t){var i=Math.pow(10,3*Math.abs(8-t));return{scale:t>8?function(n){return n/i}:function(n){return n*i},symbol:n}}function lo(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function cb(n){return n+""}function ao(){}function ta(n,t,i){var r=i.s=n+t,u=r-n,f=r-u;i.t=n-f+(t-u)}function fu(n,t){n&&ph.hasOwnProperty(n.type)&&ph[n.type](n,t)}function vo(n,t,i){var r,u=-1,f=n.length-i;for(t.lineStart();++u<f;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function ia(n,t){var i=-1,r=n.length;for(t.polygonStart();++i<r;)vo(n[i],t,1);t.polygonEnd()}function lb(){function f(f,e){f*=r;e=e*r/2+u/4;var o=f-n,s=Math.cos(e),h=Math.sin(e),c=i*h,l=t*s+c*Math.cos(o),a=c*Math.sin(o);ii.add(Math.atan2(a,l));n=f;t=s;i=h}var e,o,n,t,i;b.point=function(s,h){b.point=f;n=(e=s)*r;t=Math.cos(h=(o=h)*r/2+u/4);i=Math.sin(h)};b.lineEnd=function(){f(e,o)}}function ci(n){var t=n[0],i=n[1],r=Math.cos(i);return[r*Math.cos(t),r*Math.sin(t),Math.sin(i)]}function eu(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function rr(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function yo(n,t){n[0]+=t[0];n[1]+=t[1];n[2]+=t[2]}function ou(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function su(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t;n[1]/=t;n[2]/=t}function hu(n){return[Math.atan2(n[1],n[0]),hi(n[2])]}function cu(n,t){return Math.abs(n[0]-t[0])<i&&Math.abs(n[1]-t[1])<i}function po(n,t){n*=r;var i=Math.cos(t*=r);or(i*Math.cos(n),i*Math.sin(n),Math.sin(t))}function or(n,t,i){++kr;pi+=(n-pi)/kr;wi+=(t-wi)/kr;pt+=(i-pt)/kr}function ra(){function u(u,f){u*=r;var c=Math.cos(f*=r),o=c*Math.cos(u),s=c*Math.sin(u),h=Math.sin(f),e=Math.atan2(Math.sqrt((e=t*h-i*s)*e+(e=i*o-n*h)*e+(e=n*s-t*o)*e),n*o+t*s+i*h);ne+=e;ri+=e*(n+(n=o));ui+=e*(t+(t=s));st+=e*(i+(i=h));or(n,t,i)}var n,t,i;tt.point=function(f,e){f*=r;var o=Math.cos(e*=r);n=o*Math.cos(f);t=o*Math.sin(f);i=Math.sin(e);tt.point=u;or(n,t,i)}}function ua(){tt.point=po}function ab(){function u(u,f){u*=r;var p=Math.cos(f*=r),e=p*Math.cos(u),o=p*Math.sin(u),s=Math.sin(f),c=t*s-i*o,l=i*e-n*s,a=n*o-t*e,v=Math.sqrt(c*c+l*l+a*a),w=n*e+t*o+i*s,y=v&&-cl(w)/v,h=Math.atan2(v,w);fr+=y*c;er+=y*l;fi+=y*a;ne+=h;ri+=h*(n+(n=e));ui+=h*(t+(t=o));st+=h*(i+(i=s));or(n,t,i)}var f,e,n,t,i;tt.point=function(o,s){f=o;e=s;tt.point=u;o*=r;var h=Math.cos(s*=r);n=h*Math.cos(o);t=h*Math.sin(o);i=Math.sin(s);or(n,t,i)};tt.lineEnd=function(){u(f,e);tt.lineEnd=ua;tt.point=po}}function sr(){return!0}function fa(n,t,i,r,u){var h=[],s=[],f,o,c,l,e;if(n.forEach(function(n){var o,i,r,e,t,f;if(!((o=n.length-1)<=0)){if(i=n[0],r=n[o],cu(i,r)){for(u.lineStart(),e=0;o>e;++e)u.point((i=n[e])[0],i[1]);return u.lineEnd(),void 0}t={point:i,points:n,other:null,visited:!1,entry:!0,subject:!0};f={point:i,points:[i],other:t,visited:!1,entry:!1,subject:!1};t.other=f;h.push(t);s.push(f);t={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0};f={point:r,points:[r],other:t,visited:!1,entry:!0,subject:!1};t.other=f;h.push(t);s.push(f)}}),s.sort(t),ea(h),ea(s),h.length){for(var e=0,a=i,v=s.length;v>e;++e)s[e].entry=a=!a;for(l=h[0];;){for(f=l;f.visited;)if((f=f.next)===l)return;o=f.points;u.lineStart();do{if(f.visited=f.other.visited=!0,f.entry){if(f.subject)for(e=0;e<o.length;e++)u.point((c=o[e])[0],c[1]);else r(f.point,f.next.point,1,u);f=f.next}else{if(f.subject)for(o=f.prev.points,e=o.length;--e>=0;)u.point((c=o[e])[0],c[1]);else r(f.point,f.prev.point,-1,u);f=f.prev}f=f.other;o=f.points}while(!f.visited);u.lineEnd()}}}function ea(n){if(r=n.length){for(var r,t,u=0,i=n[0];++u<r;)i.next=t=n[u],t.prev=i,i=t;i.next=t=n[0];t.prev=i}}function oa(t,i,r,u){return function(f,e){function a(n,i){var r=f(n,i);t(n=r[0],i=r[1])&&e.point(n,i)}function k(n,t){var i=f(n,t);v.point(i[0],i[1])}function y(){o.point=k;v.lineStart()}function p(){o.point=a;v.lineEnd()}function w(n,t){h.push([n,t]);var i=f(n,t);l.point(i[0],i[1])}function d(){l.lineStart();h=[]}function g(){var f,t,r;w(h[0][0],h[0][1]);l.lineEnd();var i,u=l.clean(),n=b.buffer(),t=n.length;if(h.pop(),c.push(h),h=null,t){if(1&u){for(i=n[0],t=i.length-1,r=-1,e.lineStart();++r<t;)e.point((f=i[r])[0],f[1]);return e.lineEnd(),void 0}t>1&&2&u&&n.push(n.pop().concat(n.shift()));s.push(n.filter(vb))}}var s,c,h,v=i(e),nt=f.invert(u[0],u[1]),o={point:a,lineStart:y,lineEnd:p,polygonStart:function(){o.point=w;o.lineStart=d;o.lineEnd=g;s=[];c=[];e.polygonStart()},polygonEnd:function(){o.point=a;o.lineStart=y;o.lineEnd=p;s=n.merge(s);var t=pb(nt,c);s.length?fa(s,yb,t,r,e):t&&(e.lineStart(),r(null,null,1,e),e.lineEnd());e.polygonEnd();s=c=null},sphere:function(){e.polygonStart();e.lineStart();r(null,null,1,e);e.lineEnd();e.polygonEnd()}},b=sa(),l=i(b);return o}}function vb(n){return n.length>1}function sa(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,i){t.push([n,i])},lineEnd:h,buffer:function(){var i=n;return n=[],t=null,i},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function yb(n,t){return((n=n.point)[0]<0?n[1]-w-i:w-n[1])-((t=t.point)[0]<0?t[1]-w-i:w-t[1])}function pb(n,t){var e=n[0],k=n[1],ot=[Math.sin(e),-Math.cos(e),0],a=0,d=0,o,g,s,v,f,w,b;for(ii.reset(),o=0,g=t.length;g>o;++o)if(s=t[o],v=s.length,v)for(var h=s[0],y=h[0],nt=h[1]/2+u/4,tt=Math.sin(nt),it=Math.cos(nt),c=1;;){c===v&&(c=0);n=s[c];var p=n[0],rt=n[1]/2+u/4,ut=Math.sin(rt),ft=Math.cos(rt),r=p-y,l=Math.abs(r)>u,et=tt*ut;if((ii.add(Math.atan2(et*Math.sin(r),it*ft+et*Math.cos(r))),a+=l?r+(r>=0?2:-2)*u:r,l^y>=e^p>=e)&&(f=rr(ci(h),ci(n)),su(f),w=rr(ot,f),su(w),b=(l^r>=0?-1:1)*hi(w[2]),(k>b||k===b&&(f[0]||f[1]))&&(d+=l^r>=0?1:-1)),!c++)break;y=p;tt=ut;it=ft;h=n}return(-i>a||i>a&&0>ii)^1&d}function wb(n){var e,r=NaN,t=NaN,f=NaN;return{lineStart:function(){n.lineStart();e=1},point:function(o,s){var h=o>0?u:-u,c=Math.abs(o-r);Math.abs(c-u)<i?(n.point(r,t=(t+s)/2>0?w:-w),n.point(f,t),n.lineEnd(),n.lineStart(),n.point(h,t),n.point(o,t),e=0):f!==h&&c>=u&&(Math.abs(r-f)<i&&(r-=f*i),Math.abs(o-h)<i&&(o-=h*i),t=bb(r,t,o,s),n.point(f,t),n.lineEnd(),n.lineStart(),n.point(h,t),e=0);n.point(r=o,t=s);f=h},lineEnd:function(){n.lineEnd();r=t=NaN},clean:function(){return 2-e}}}function bb(n,t,r,u){var f,e,o=Math.sin(n-r);return Math.abs(o)>i?Math.atan((Math.sin(t)*(e=Math.cos(u))*Math.sin(r)-Math.sin(u)*(f=Math.cos(t))*Math.sin(n))/(f*e*o)):(t+u)/2}function kb(n,t,r,f){var e,o;null==n?(e=r*w,f.point(-u,e),f.point(0,e),f.point(u,e),f.point(u,0),f.point(u,-e),f.point(0,-e),f.point(-u,-e),f.point(-u,0),f.point(-u,e)):Math.abs(n[0]-t[0])>i?(o=(n[0]<t[0]?1:-1)*u,e=r*o/2,f.point(-o,e),f.point(0,e),f.point(o,e)):f.point(t[0],t[1])}function db(n){function o(n,i){return Math.cos(n)*Math.cos(i)>t}function h(n){var t,a,r,l,h;return{lineStart:function(){l=r=!1;h=1},point:function(v,y){var w,p=[v,y],b=o(v,y),d=f?b?0:s(v,y):b?s(v+(0>v?u:-u),y):0,k;(!t&&(l=r=b)&&n.lineStart(),b!==r&&(w=e(t,p),(cu(t,w)||cu(p,w))&&(p[0]+=i,p[1]+=i,b=o(p[0],p[1]))),b!==r)?(h=0,b?(n.lineStart(),w=e(p,t),n.point(w[0],w[1])):(w=e(t,p),n.point(w[0],w[1]),n.lineEnd()),t=w):c&&t&&f^b&&(d&a||!(k=e(p,t,!0))||(h=0,f?(n.lineStart(),n.point(k[0][0],k[0][1]),n.point(k[1][0],k[1][1]),n.lineEnd()):(n.point(k[1][0],k[1][1]),n.lineEnd(),n.lineStart(),n.point(k[0][0],k[0][1]))));!b||t&&cu(t,p)||n.point(p[0],p[1]);t=p;r=b;a=d},lineEnd:function(){r&&n.lineEnd();t=null},clean:function(){return h|(l&&r)<<1}}}function e(n,r,f){var ft=ci(n),et=ci(r),it=[1,0,0],l=rr(ft,et),rt=eu(l,l),w=l[0],b=rt-w*w,d,e,tt;if(!b)return!f&&n;var ot=t*rt/b,st=-t*w/b,ht=rr(it,l),o=ou(it,ot),ct=ou(l,st);yo(o,ct);var a=ht,y=eu(o,a),k=eu(a,a),ut=y*y-k*(eu(o,o)-1);if(!(0>ut)){if(d=Math.sqrt(ut),e=ou(a,(-y-d)/k),yo(e,o),e=hu(e),!f)return e;var p,s=n[0],v=r[0],h=n[1],c=r[1];s>v&&(p=s,s=v,v=p);var g=v-s,nt=Math.abs(g-u)<i,lt=nt||i>g;if(!nt&&h>c&&(p=h,h=c,c=p),lt?nt?h+c>0^e[1]<(Math.abs(e[0]-s)<i?h:c):h<=e[1]&&e[1]<=c:g>u^(s<=e[0]&&e[0]<=v))return tt=ou(a,(-y+d)/k),yo(tt,o),[e,hu(tt)]}}function s(t,i){var e=f?n:u-n,r=0;return-e>t?r|=1:t>e&&(r|=2),-e>i?r|=4:i>e&&(r|=8),r}var t=Math.cos(n),f=t>0,c=Math.abs(t)>i,l=go(n,6*r);return oa(o,h,l,f?[0,-n]:[-u,n-u])}function ha(t,r,u,f){function e(n,f){return Math.abs(n[0]-t)<i?f>0?0:3:Math.abs(n[0]-u)<i?f>0?2:1:Math.abs(n[1]-r)<i?f>0?1:0:f>0?3:2}function s(n,t){return o(n.point,t.point)}function o(n,t){var i=e(n,1),r=e(t,1);return i!==r?i-r:0===i?t[1]-n[1]:1===i?n[0]-t[0]:2===i?n[1]-t[1]:t[0]-n[0]}function h(n,e){var s=e[0]-n[0],h=e[1]-n[1],o=[0,1];return Math.abs(s)<i&&Math.abs(h)<i?t<=n[0]&&n[0]<=u&&r<=n[1]&&n[1]<=f:lu(t-n[0],s,o)&&lu(n[0]-u,-s,o)&&lu(r-n[1],h,o)&&lu(n[1]-f,-h,o)?(o[1]<1&&(e[0]=n[0]+o[1]*s,e[1]=n[1]+o[1]*h),o[0]>0&&(n[0]+=o[0]*s,n[1]+=o[0]*h),!0):!1}return function(i){function ot(n){for(var r=0,s=l.length,u=n[1],f=0;s>f;++f)for(var t,e=1,o=l[f],h=o.length,i=o[0];h>e;++e)t=o[e],i[1]<=u?t[1]>u&&g(i,t,n)>0&&++r:t[1]<=u&&g(i,t,n)<0&&--r,i=t;return 0!==r}function g(n,t,i){return(t[0]-n[0])*(i[1]-n[1])-(i[0]-n[0])*(t[1]-n[1])}function nt(n,i,s,h){var c=0,l=0;if(null==n||(c=e(n,s))!==(l=e(i,s))||o(n,i)<0^s>0){do h.point(0===c||3===c?t:u,c>1?f:r);while((c=(c+s+4)%4)!==l)}else h.point(i[0],i[1])}function tt(n,i){return n>=t&&u>=n&&i>=r&&f>=i}function it(n,t){tt(n,t)&&i.point(n,t)}function st(){d.point=rt;l&&l.push(y=[]);b=!0;a=!1;p=w=NaN}function ht(){c&&(rt(ut,ft),et&&a&&k.rejoin(),c.push(k.buffer()));d.point=it;a&&i.lineEnd()}function rt(n,t){var r,u,f;n=Math.max(-te,Math.min(te,n));t=Math.max(-te,Math.min(te,t));r=tt(n,t);(l&&y.push([n,t]),b)?(ut=n,ft=t,et=r,b=!1,r&&(i.lineStart(),i.point(n,t))):r&&a?i.point(n,t):(u=[p,w],f=[n,t],h(u,f)?(a||(i.lineStart(),i.point(u[0],u[1])),i.point(f[0],f[1]),r||i.lineEnd(),v=!1):r&&(i.lineStart(),i.point(n,t),v=!1));p=n;w=t;a=r}var c,l,y,ut,ft,et,p,w,a,b,v,ct=i,k=sa(),d={point:it,lineStart:st,lineEnd:ht,polygonStart:function(){i=k;c=[];l=[];v=!0},polygonEnd:function(){i=ct;c=n.merge(c);var r=ot([t,f]),u=v&&r,e=c.length;(u||e)&&(i.polygonStart(),u&&(i.lineStart(),nt(null,null,1,i),i.lineEnd()),e&&fa(c,s,r,nt,i),i.polygonEnd());c=l=y=null}};return d}}function lu(n,t,r){if(Math.abs(t)<i)return 0>=n;var u=n/t;if(t>0){if(u>r[1])return!1;u>r[0]&&(r[0]=u)}else{if(u<r[0])return!1;u<r[1]&&(r[1]=u)}return!0}function ca(n,t){function i(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(i.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),i}function wo(n){var t=0,i=u/3,r=bo(n),f=r(t,i);return f.parallels=function(n){return arguments.length?r(t=n[0]*u/180,i=n[1]*u/180):[180*(t/u),180*(i/u)]},f}function la(n,t){function f(n,t){var r=Math.sqrt(u-2*i*Math.sin(t))/i;return[r*Math.sin(n*=i),e-r*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),e=Math.sqrt(u)/i;return f.invert=function(n,t){var r=e-t;return[Math.atan2(n,r)/i,hi((u-(n*n+r*r)*i*i)/(2*i))]},f}function gb(){function i(i,r){bh+=t*i-n*r;n=i;t=r}var r,u,n,t;ei.point=function(f,e){ei.point=i;r=n=f;u=t=e};ei.lineEnd=function(){i(r,u)}}function nk(n,t){ie>n&&(ie=n);n>ue&&(ue=n);re>t&&(re=t);t>fe&&(fe=t)}function tk(){function i(n,i){t.push("M",n,",",i,u)}function f(i,r){t.push("M",i,",",r);n.point=e}function e(n,i){t.push("L",n,",",i)}function r(){n.point=i}function o(){t.push("Z")}var u=aa(4.5),t=[],n={point:i,lineStart:function(){n.point=f},lineEnd:r,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=r;n.point=i},pointRadius:function(t){return u=aa(t),n},result:function(){if(t.length){var n=t.join("");return t=[],n}}};return n}function aa(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function li(n,t){pi+=n;wi+=t;++pt}function va(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ri+=u*(n+i)/2;ui+=u*(t+r)/2;st+=u;li(n=i,t=r)}var n,t;it.point=function(r,u){it.point=i;li(n=r,t=u)}}function ya(){it.point=li}function ik(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);ri+=u*(n+i)/2;ui+=u*(t+r)/2;st+=u;u=t*i-n*r;fr+=u*(n+i);er+=u*(t+r);fi+=3*u;li(n=i,t=r)}var r,u,n,t;it.point=function(f,e){it.point=i;li(r=n=f,u=t=e)};it.lineEnd=function(){i(r,u)}}function rk(n){function i(t,i){n.moveTo(t,i);n.arc(t,i,u,0,nt)}function f(i,r){n.moveTo(i,r);t.point=e}function e(t,i){n.lineTo(t,i)}function r(){t.point=i}function o(){n.closePath()}var u=4.5,t={point:i,lineStart:function(){t.point=f},lineEnd:r,polygonStart:function(){t.lineEnd=o},polygonEnd:function(){t.lineEnd=r;t.point=i},pointRadius:function(n){return u=n,t},result:h};return t}function pa(n){function f(i){function y(t,r){t=n(t,r);i.point(t[0],t[1])}function c(){u=NaN;r.point=l;i.lineStart()}function l(r,c){var l=ci([r,c]),a=n(r,c);t(u,f,v,o,s,h,u=a[0],f=a[1],v=r,o=l[0],s=l[1],h=l[2],e,i);i.point(u,f)}function a(){r.point=y;i.lineEnd()}function nt(){c();r.point=tt;r.lineEnd=it}function tt(n,t){l(p=n,rt=t);w=u;b=f;k=o;d=s;g=h;r.point=l}function it(){t(u,f,v,o,s,h,w,b,p,k,d,g,e,i);r.lineEnd=a;a()}var p,rt,w,b,k,d,g,v,u,f,o,s,h,r={point:y,lineStart:c,lineEnd:a,polygonStart:function(){i.polygonStart();r.lineStart=nt},polygonEnd:function(){i.polygonEnd();r.lineStart=c}};return r}function t(r,f,e,s,h,c,l,a,v,y,p,w,b,k){var tt=l-r,it=a-f,ft=tt*tt+it*it;if(ft>4*u&&b--){var g=s+y,nt=h+p,d=c+w,et=Math.sqrt(g*g+nt*nt+d*d),at=Math.asin(d/=et),ot=Math.abs(Math.abs(d)-1)<i?(e+v)/2:Math.atan2(nt,g),st=n(ot,at),rt=st[0],ut=st[1],ht=rt-r,ct=ut-f,lt=it*ht-tt*ct;(lt*lt/ft>u||Math.abs((tt*ht+it*ct)/ft-.5)>.3||o>s*y+h*p+c*w)&&(t(r,f,e,s,h,c,rt,ut,ot,g/=et,nt/=et,d,b,k),k.point(rt,ut),t(rt,ut,ot,g,nt,d,l,a,v,y,p,w,b,k))}}var u=.5,o=Math.cos(30*r),e=16;return f.precision=function(n){return arguments.length?(e=(u=n*n)>0&&16,f):Math.sqrt(u)},f}function au(n){this.stream=n}function uk(n){var t=pa(function(t,i){return n([t*o,i*o])});return function(n){var i=new au(n=t(n));return i.point=function(t,i){n.point(t*r,i*r)},i}}function gt(n){return bo(function(){return n})()}function bo(t){function i(n){return n=v(n[0]*r,n[1]*r),[n[0]*u+h,c-n[1]*u]}function et(n){return n=v.invert((n[0]-h)/u,(c-n[1])/u),n&&[n[0]*o,n[1]*o]}function e(){v=ca(tt=ko(k,d,g),s);var n=s(w,b);return h=y-n[0]*u,c=p+n[1]*u,a()}function a(){return f&&(f.valid=!1,f=null),i}var s,tt,v,h,c,f,it=pa(function(n,t){return n=s(n,t),[n[0]*u+h,c-n[1]*u]}),u=150,y=480,p=250,w=0,b=0,k=0,d=0,g=0,rt=gp,ut=l,nt=null,ft=null;return i.stream=function(n){return f&&(f.valid=!1),f=fk(rt(tt,it(ut(n)))),f.valid=!0,f},i.clipAngle=function(n){return arguments.length?(rt=null==n?(nt=n,gp):db((nt=+n)*r),a()):nt},i.clipExtent=function(n){return arguments.length?(ft=n,ut=n?ha(n[0][0],n[0][1],n[1][0],n[1][1]):l,a()):ft},i.scale=function(n){return arguments.length?(u=+n,e()):u},i.translate=function(n){return arguments.length?(y=+n[0],p=+n[1],e()):[y,p]},i.center=function(n){return arguments.length?(w=n[0]%360*r,b=n[1]%360*r,e()):[w*o,b*o]},i.rotate=function(n){return arguments.length?(k=n[0]%360*r,d=n[1]%360*r,g=n.length>2?n[2]%360*r:0,e()):[k*o,d*o,g*o]},n.rebind(i,it,"precision"),function(){return s=t.apply(this,arguments),i.invert=s.invert&&et,e()}}function fk(n){var t=new au(n);return t.point=function(t,i){n.point(t*r,i*r)},t}function hr(n,t){return[n,t]}function wa(n,t){return[n>u?n-nt:-u>n?n+nt:n,t]}function ko(n,t,i){return n?t||i?ca(ka(n),da(t,i)):ka(n):t||i?da(t,i):wa}function ba(n){return function(t,i){return t+=n,[t>u?t-nt:-u>t?t+nt:t,i]}}function ka(n){var t=ba(n);return t.invert=ba(-n),t}function da(n,t){function e(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*i+o*r;return[Math.atan2(s*u-c*f,o*i-h*r),hi(c*u+s*f)]}var i=Math.cos(n),r=Math.sin(n),u=Math.cos(t),f=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*u-s*f;return[Math.atan2(s*u+h*f,o*i+c*r),hi(c*i-o*r)]},e}function go(n,t){var i=Math.cos(n),r=Math.sin(n);return function(u,f,e,o){var h=e*t,c,s;for(null!=u?(u=ga(i,u),f=ga(i,f),(e>0?f>u:u>f)&&(u+=e*nt)):(u=n+e*nt,f=n-.5*h),s=u;e>0?s>f:f>s;s-=h)o.point((c=hu([i,-r*Math.cos(s),-r*Math.sin(s)]))[0],c[1])}}function ga(n,t){var r=ci(t),u;return r[0]-=n,su(r),u=cl(-r[1]),((-r[2]<0?-u:u)+2*Math.PI-i)%(2*Math.PI)}function nv(t,r,u){var f=n.range(t,r-i,u).concat(r);return function(n){return f.map(function(t){return[n,t]})}}function tv(t,r,u){var f=n.range(t,r-i,u).concat(r);return function(n){return f.map(function(t){return[t,n]})}}function ns(n){return n.source}function ts(n){return n.target}function ek(n,t,i,r){var f=Math.cos(t),c=Math.sin(t),e=Math.cos(r),l=Math.sin(r),a=f*Math.cos(n),v=f*Math.sin(n),y=e*Math.cos(i),p=e*Math.sin(i),u=2*Math.asin(Math.sqrt(al(r-t)+f*e*al(i-n))),s=1/Math.sin(u),h=u?function(n){var t=Math.sin(n*=u)*s,i=Math.sin(u-n)*s,r=i*a+t*y,f=i*v+t*p,e=i*c+t*l;return[Math.atan2(f,r)*o,Math.atan2(e,Math.sqrt(r*r+f*f))*o]}:function(){return[n*o,t*o]};return h.distance=u,h}function ok(){function u(u,f){var s=Math.sin(f*=r),o=Math.cos(f),e=Math.abs((u*=r)-i),h=Math.cos(e);kh+=Math.atan2(Math.sqrt((e=o*Math.sin(e))*e+(e=t*s-n*o*h)*e),n*s+t*o*h);i=u;n=s;t=o}var i,n,t;bi.point=function(f,e){i=f*r;n=Math.sin(e*=r);t=Math.cos(e);bi.point=u};bi.lineEnd=function(){bi.point=bi.lineEnd=h}}function cr(n,t){function i(t,i){var f=Math.cos(t),r=Math.cos(i),u=n(f*r);return[u*r*Math.sin(t),u*Math.sin(i)]}return i.invert=function(n,i){var r=Math.sqrt(n*n+i*i),u=t(r),f=Math.sin(u),e=Math.cos(u);return[Math.atan2(n*f,r*e),Math.asin(r&&i*f/r)]},i}function iv(n,t){function o(n,t){var u=Math.abs(Math.abs(t)-w)<i?0:e/Math.pow(f(t),r);return[u*Math.sin(r*n),e-u*Math.cos(r*n)]}var s=Math.cos(n),f=function(n){return Math.tan(u/4+n/2)},r=n===t?Math.sin(n):Math.log(s/Math.cos(t))/Math.log(f(t)/f(n)),e=s*Math.pow(f(n),r)/r;return r?(o.invert=function(n,t){var i=e-t,u=hl(r)*Math.sqrt(n*n+i*i);return[Math.atan2(n,i)/r,2*Math.atan(Math.pow(e/u,1/r))-w]},o):vu}function rv(n,t){function f(n,t){var i=u-t;return[i*Math.sin(r*n),u-i*Math.cos(r*n)]}var e=Math.cos(n),r=n===t?Math.sin(n):(e-Math.cos(t))/(t-n),u=e/r+n;return Math.abs(r)<i?hr:(f.invert=function(n,t){var i=u-t;return[Math.atan2(n,i)/r,u-hl(r)*Math.sqrt(n*n+i*i)]},f)}function vu(n,t){return[n,Math.log(Math.tan(u/4+t/2))]}function uv(n){var i,t=gt(n),r=t.scale,f=t.translate,e=t.clipExtent;return t.scale=function(){var n=r.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.translate=function(){var n=f.apply(t,arguments);return n===t?i?t.clipExtent(null):t:n},t.clipExtent=function(n){var h=e.apply(t,arguments),o,s;return h===t?(i=null==n)&&(o=u*r(),s=f(),e([[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]])):i&&(h=null),h},t.clipExtent(null)}function is(n,t){var i=Math.cos(t)*Math.sin(n);return[Math.log((1+i)/(1-i))/2,Math.atan2(Math.tan(t),Math.cos(n))]}function fv(n){function t(t){function a(){l.push("M",i(n(s),o))}for(var c,l=[],s=[],h=-1,v=t.length,y=e(r),p=e(u);++h<v;)f.call(this,c=t[h],h)?s.push([+y.call(this,c,h),+p.call(this,c,h)]):s.length&&(a(),s=[]);return s.length&&a(),l.length?l.join(""):null}var r=ut,u=ct,f=sr,i=k,s=i.key,o=.7;return t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(f=n,t):f},t.interpolate=function(n){return arguments.length?(s="function"==typeof n?i=n:(i=ee.get(n)||k).key,t):s},t.tension=function(n){return arguments.length?(o=n,t):o},t}function ut(n){return n[0]}function ct(n){return n[1]}function k(n){return n.join("L")}function sk(n){return k(n)+"Z"}function hk(n){for(var r=0,u=n.length,t=n[0],i=[t[0],",",t[1]];++r<u;)i.push("H",(t[0]+(t=n[r])[0])/2,"V",t[1]);return u>1&&i.push("H",t[0]),i.join("")}function rs(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("V",(t=n[i])[1],"H",t[0]);return r.join("")}function us(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("H",(t=n[i])[0],"V",t[1]);return r.join("")}function ck(n,t){return n.length<4?k(n):n[1]+yu(n.slice(1,n.length-1),fs(n,t))}function lk(n,t){return n.length<3?k(n):n[0]+yu((n.push(n[0]),n),fs([n[n.length-2]].concat(n,[n[1]]),t))}function ak(n,t){return n.length<3?k(n):n[0]+yu(n,fs(n,t))}function yu(n,t){var o,h;if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return k(n);var c=n.length!=t.length,f="",s=n[0],i=n[1],e=t[0],r=e,u=1;if(c&&(f+="Q"+(i[0]-2*e[0]/3)+","+(i[1]-2*e[1]/3)+","+i[0]+","+i[1],s=n[1],u=2),t.length>1)for(r=t[1],i=n[u],u++,f+="C"+(s[0]+e[0])+","+(s[1]+e[1])+","+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1],o=2;o<t.length;o++,u++)i=n[u],r=t[o],f+="S"+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1];return c&&(h=n[u],f+="Q"+(i[0]+2*r[0]/3)+","+(i[1]+2*r[1]/3)+","+h[0]+","+h[1]),f}function fs(n,t){for(var r,u=[],f=(1-t)/2,e=n[0],i=n[1],o=1,s=n.length;++o<s;)r=e,e=i,i=n[o],u.push([f*(i[0]-r[0]),f*(i[1]-r[1])]);return u}function ev(n){if(n.length<3)return k(n);var o=1,s=n.length,t=n[0],i=t[0],r=t[1],u=[i,i,i,(t=n[1])[0]],f=[r,r,r,t[1]],e=[i,",",r,"L",d(oi,u),",",d(oi,f)];for(n.push(n[s-1]);++o<=s;)t=n[o],u.shift(),u.push(t[0]),f.shift(),f.push(t[1]),es(e,u,f);return n.pop(),e.push("L",t),e.join("")}function vk(n){if(n.length<4)return k(n);for(var t,f=[],i=-1,e=n.length,r=[0],u=[0];++i<3;)t=n[i],r.push(t[0]),u.push(t[1]);for(f.push(d(oi,r)+","+d(oi,u)),--i;++i<e;)t=n[i],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),es(f,r,u);return f.join("")}function yk(n){for(var f,t,i=-1,e=n.length,o=e+4,r=[],u=[];++i<4;)t=n[i%e],r.push(t[0]),u.push(t[1]);for(f=[d(oi,r),",",d(oi,u)],--i;++i<o;)t=n[i%e],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),es(f,r,u);return f.join("")}function pk(n,t){var i=n.length-1;if(i)for(var r,u,e=n[0][0],o=n[0][1],s=n[i][0]-e,h=n[i][1]-o,f=-1;++f<=i;)r=n[f],u=f/i,r[0]=t*r[0]+(1-t)*(e+u*s),r[1]=t*r[1]+(1-t)*(o+u*h);return ev(n)}function d(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function es(n,t,i){n.push("C",d(nw,t),",",d(nw,i),",",d(tw,t),",",d(tw,i),",",d(oi,t),",",d(oi,i))}function os(n,t){return(t[1]-n[1])/(t[0]-n[0])}function wk(n){for(var t=0,e=n.length-1,i=[],f=n[0],r=n[1],u=i[0]=os(f,r);++t<e;)i[t]=(u+(u=os(f=r,r=n[t+1])))/2;return i[t]=u,i}function bk(n){for(var f,e,o,r,h=[],u=wk(n),t=-1,s=n.length-1;++t<s;)f=os(n[t],n[t+1]),Math.abs(f)<i?u[t]=u[t+1]=0:(e=u[t]/f,o=u[t+1]/f,r=e*e+o*o,r>9&&(r=3*f/Math.sqrt(r),u[t]=r*e,u[t+1]=r*o));for(t=-1;++t<=s;)r=(n[Math.min(s,t+1)][0]-n[Math.max(0,t-1)][0])/(6*(1+u[t]*u[t])),h.push([r||0,u[t]*r||0]);return h}function kk(n){return n.length<3?k(n):n[0]+yu(n,bk(n))}function dk(n,t,i,r){var u,f,e,o,s,h,c;return u=r[n],f=u[0],e=u[1],u=r[t],o=u[0],s=u[1],u=r[i],h=u[0],c=u[1],(c-e)*(o-f)-(s-e)*(h-f)>0}function ss(n,t,i){return(i[0]-t[0])*(n[1]-t[1])<(i[1]-t[1])*(n[0]-t[0])}function ov(n,t,i,r){var u=n[0],e=i[0],o=t[0]-u,s=r[0]-e,f=n[1],h=i[1],c=t[1]-f,l=r[1]-h,a=(s*(f-h)-l*(u-e))/(l*o-s*c);return[u+a*o,f+a*c]}function sv(n){var t=n[0],i=n[n.length-1];return!(t[0]-i[0]||t[1]-i[1])}function hs(n,t){var l={list:n.map(function(n,t){return{index:t,x:n[0],y:n[1]}}).sort(function(n,t){return n.y<t.y?-1:n.y>t.y?1:n.x<t.x?-1:n.x>t.x?1:0}),bottomSite:null},i={list:[],leftEnd:null,rightEnd:null,init:function(){i.leftEnd=i.createHalfEdge(null,"l");i.rightEnd=i.createHalfEdge(null,"l");i.leftEnd.r=i.rightEnd;i.rightEnd.l=i.leftEnd;i.list.unshift(i.leftEnd,i.rightEnd)},createHalfEdge:function(n,t){return{edge:n,side:t,vertex:null,l:null,r:null}},insert:function(n,t){t.l=n;t.r=n.r;n.r.l=t;n.r=t},leftBound:function(n){var t=i.leftEnd;do t=t.r;while(t!=i.rightEnd&&e.rightOf(t,n));return t.l},del:function(n){n.l.r=n.r;n.r.l=n.l;n.edge=null},right:function(n){return n.r},left:function(n){return n.l},leftRegion:function(n){return null==n.edge?l.bottomSite:n.edge.region[n.side]},rightRegion:function(n){return null==n.edge?l.bottomSite:n.edge.region[oe[n.side]]}},e={bisect:function(n,t){var u={region:{l:n,r:t},ep:{l:null,r:null}},i=t.x-n.x,r=t.y-n.y,f=i>0?i:-i,e=r>0?r:-r;return u.c=n.x*i+n.y*r+.5*(i*i+r*r),f>e?(u.a=1,u.b=r/i,u.c/=i):(u.b=1,u.a=i/r,u.c/=r),u},intersect:function(n,t){var i=n.edge,r=t.edge,u,h;if(!i||!r||i.region.r==r.region.r||(u=i.a*r.b-i.b*r.a,Math.abs(u)<1e-10))return null;var f,e,c=(i.c*r.b-r.c*i.b)/u,l=(r.c*i.a-i.c*r.a)/u,o=i.region.r,s=r.region.r;return o.y<s.y||o.y==s.y&&o.x<s.x?(f=n,e=i):(f=t,e=r),h=c>=e.region.r.x,h&&"l"===f.side||!h&&"r"===f.side?null:{x:c,y:l}},rightOf:function(n,t){var i=n.edge,u=i.region.r,f=t.x>u.x,h;if(f&&"l"===n.side)return 1;if(!f&&"r"===n.side)return 0;if(1===i.a){var e=t.y-u.y,o=t.x-u.x,s=0,r=0;(!f&&i.b<0||f&&i.b>=0?r=s=e>=i.b*o:(r=t.x+t.y*i.b>i.c,i.b<0&&(r=!r),r||(s=1)),s)||(h=u.x-i.region.l.x,r=i.b*(o*o-e*e)<h*e*(1+2*o/h+i.b*i.b),i.b<0&&(r=!r))}else{var c=i.c-i.a*t.x,l=t.y-c,a=t.x-u.x,v=c-u.y;r=l*l>a*a+v*v}return"l"===n.side?r:!r},endPoint:function(n,i,r){n.ep[i]=r;n.ep[oe[i]]&&t(n)},distance:function(n,t){var i=n.x-t.x,r=n.y-t.y;return Math.sqrt(i*i+r*r)}},u={list:[],insert:function(n,t,i){var f;n.vertex=t;n.ystar=t.y+i;for(var r=0,e=u.list,o=e.length;o>r;r++)if(f=e[r],!(n.ystar>f.ystar||n.ystar==f.ystar&&t.x>f.vertex.x))break;e.splice(r,0,n)},del:function(n){for(var t=0,i=u.list,r=i.length;r>t&&i[t]!=n;++t);i.splice(t,1)},empty:function(){return 0===u.list.length},nextEvent:function(n){for(var t=0,i=u.list,r=i.length;r>t;++t)if(i[t]==n)return i[t+1];return null},min:function(){var n=u.list[0];return{x:n.vertex.x,y:n.ystar}},extractMin:function(){return u.list.shift()}},p,r,h,v,k,o,c,y,d,f,w,a,b,s;for(i.init(),l.bottomSite=l.list.shift(),s=l.list.shift();;)if(u.empty()||(p=u.min()),s&&(u.empty()||s.y<p.y||s.y==p.y&&s.x<p.x))r=i.leftBound(s),h=i.right(r),c=i.rightRegion(r),a=e.bisect(c,s),o=i.createHalfEdge(a,"l"),i.insert(r,o),f=e.intersect(r,o),f&&(u.del(r),u.insert(r,f,e.distance(f,s))),r=o,o=i.createHalfEdge(a,"r"),i.insert(r,o),f=e.intersect(o,h),f&&u.insert(o,f,e.distance(f,s)),s=l.list.shift();else{if(u.empty())break;r=u.extractMin();v=i.left(r);h=i.right(r);k=i.right(h);c=i.leftRegion(r);y=i.rightRegion(h);w=r.vertex;e.endPoint(r.edge,r.side,w);e.endPoint(h.edge,h.side,w);i.del(r);u.del(h);i.del(h);b="l";c.y>y.y&&(d=c,c=y,y=d,b="r");a=e.bisect(c,y);o=i.createHalfEdge(a,b);i.insert(v,o);e.endPoint(a,oe[b],w);f=e.intersect(v,o);f&&(u.del(v),u.insert(v,f,e.distance(f,c)));f=e.intersect(o,k);f&&u.insert(o,f,e.distance(f,c))}for(r=i.right(i.leftEnd);r!=i.rightEnd;r=i.right(r))t(r.edge)}function gk(n){return n.x}function nd(n){return n.y}function hv(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function lr(n,t,i,r,u,f){if(!n(t,i,r,u,f)){var o=.5*(i+u),s=.5*(r+f),e=t.nodes;e[0]&&lr(n,e[0],i,r,o,s);e[1]&&lr(n,e[1],o,r,u,s);e[2]&&lr(n,e[2],i,s,o,f);e[3]&&lr(n,e[3],o,s,u,f)}}function cs(t,i){t=n.rgb(t);i=n.rgb(i);var r=t.r,u=t.g,f=t.b,e=i.r-r,o=i.g-u,s=i.b-f;return function(n){return"#"+ir(Math.round(r+e*n))+ir(Math.round(u+o*n))+ir(Math.round(f+s*n))}}function cv(n,t){var i,u={},r={};for(i in n)i in t?u[i]=ai(n[i],t[i]):r[i]=n[i];for(i in t)i in n||(r[i]=t[i]);return function(n){for(i in u)r[i]=u[i](n);return r}}function lt(n,t){return t-=n=+n,function(i){return n+t*i}}function lv(n,t){var s,u,f,o,i,h=0,c=0,r=[],e=[];for(n+="",t+="",gr.lastIndex=0,u=0;s=gr.exec(t);++u)s.index&&r.push(t.substring(h,c=s.index)),e.push({i:r.length,x:s[0]}),r.push(null),h=gr.lastIndex;for(h<t.length&&r.push(t.substring(h)),u=0,o=e.length;(s=gr.exec(n))&&o>u;++u)if(i=e[u],i.x==s[0]){if(i.i)if(null==r[i.i+1])for(r[i.i-1]+=i.x,r.splice(i.i,1),f=u+1;o>f;++f)e[f].i--;else for(r[i.i-1]+=i.x+r[i.i+1],r.splice(i.i,2),f=u+1;o>f;++f)e[f].i-=2;else if(null==r[i.i+1])r[i.i]=i.x;else for(r[i.i]=i.x+r[i.i+1],r.splice(i.i+1,1),f=u+1;o>f;++f)e[f].i--;e.splice(u,1);o--;u--}else i.x=lt(parseFloat(s[0]),parseFloat(i.x));for(;o>u;)i=e.pop(),null==r[i.i+1]?r[i.i]=i.x:(r[i.i]=i.x+r[i.i+1],r.splice(i.i+1,1)),o--;return 1===r.length?null==r[0]?(i=e[0].x,function(n){return i(n)+""}):function(){return t}:function(n){for(u=0;o>u;++u)r[(i=e[u]).i]=i.x(n);return r.join("")}}function ai(t,i){for(var r,u=n.interpolators.length;--u>=0&&!(r=n.interpolators[u](t,i)););return r}function pu(n,t){for(var u=[],r=[],e=n.length,o=t.length,f=Math.min(n.length,t.length),i=0;f>i;++i)u.push(ai(n[i],t[i]));for(;e>i;++i)r[i]=n[i];for(;o>i;++i)r[i]=t[i];return function(n){for(i=0;f>i;++i)r[i]=u[i](n);return r}}function td(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function av(n){return function(t){return 1-n(1-t)}}function vv(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function id(n){return n*n}function rd(n){return n*n*n}function ud(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,i=t*n;return 4*(.5>n?i:3*(n-t)+i-.75)}function fd(n){return function(t){return Math.pow(t,n)}}function ed(n){return 1-Math.cos(n*w)}function od(n){return Math.pow(2,10*(n-1))}function sd(n){return 1-Math.sqrt(1-n*n)}function hd(n,t){var i;return arguments.length<2&&(t=.45),arguments.length?i=t/nt*Math.asin(1/n):(n=1,i=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-i)*nt/t)}}function cd(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function ld(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function ad(t,i){t=n.hcl(t);i=n.hcl(i);var u=t.h,f=t.c,o=t.l,r=i.h-u,e=i.c-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.c:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return to(u+r*n,f+e*n,o+s*n)+""}}function vd(t,i){t=n.hsl(t);i=n.hsl(i);var u=t.h,f=t.s,o=t.l,r=i.h-u,e=i.s-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.s:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return no(u+r*n,f+e*n,o+s*n)+""}}function yd(t,i){t=n.lab(t);i=n.lab(i);var r=t.l,u=t.a,f=t.b,e=i.l-r,o=i.a-u,s=i.b-f;return function(n){return vl(r+e*n,u+o*n,f+s*n)+""}}function yv(n,t){return t-=n,function(i){return Math.round(n+t*i)}}function pv(n){var t=[n.a,n.b],i=[n.c,n.d],r=bv(t),u=wv(t,i),f=bv(pd(i,t,-u))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1);this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*o;this.translate=[n.e,n.f];this.scale=[r,f];this.skew=f?Math.atan2(u,f)*o:0}function wv(n,t){return n[0]*t[0]+n[1]*t[1]}function bv(n){var t=Math.sqrt(wv(n,n));return t&&(n[0]/=t,n[1]/=t),t}function pd(n,t,i){return n[0]+=i*t[0],n[1]+=i*t[1],n}function kv(t,i){var s,r=[],o=[],c=n.transform(t),l=n.transform(i),a=c.translate,u=l.translate,h=c.rotate,f=l.rotate,p=c.skew,v=l.skew,y=c.scale,e=l.scale;return a[0]!=u[0]||a[1]!=u[1]?(r.push("translate(",null,",",null,")"),o.push({i:1,x:lt(a[0],u[0])},{i:3,x:lt(a[1],u[1])})):u[0]||u[1]?r.push("translate("+u+")"):r.push(""),h!=f?(h-f>180?f+=360:f-h>180&&(h+=360),o.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:lt(h,f)})):f&&r.push(r.pop()+"rotate("+f+")"),p!=v?o.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:lt(p,v)}):v&&r.push(r.pop()+"skewX("+v+")"),y[0]!=e[0]||y[1]!=e[1]?(s=r.push(r.pop()+"scale(",null,",",null,")"),o.push({i:s-4,x:lt(y[0],e[0])},{i:s-2,x:lt(y[1],e[1])})):(1!=e[0]||1!=e[1])&&r.push(r.pop()+"scale("+e+")"),s=o.length,function(n){for(var t,i=-1;++i<s;)r[(t=o[i]).i]=t.x(n);return r.join("")}}function wd(n,t){return t=t-(n=+n)?1/(t-n):0,function(i){return(i-n)*t}}function bd(n,t){return t=t-(n=+n)?1/(t-n):0,function(i){return Math.max(0,Math.min(1,(i-n)*t))}}function kd(n){for(var f,t=n.source,i=n.target,u=dd(t,i),r=[t];t!==u;)t=t.parent,r.push(t);for(f=r.length;i!==u;)r.splice(f,0,i),i=i.parent;return r}function dv(n){for(var i=[],t=n.parent;null!=t;)i.push(n),n=t,t=t.parent;return i.push(n),i}function dd(n,t){if(n===t)return n;for(var r=dv(n),u=dv(t),i=r.pop(),f=u.pop(),e=null;i===f;)e=i,i=r.pop(),f=u.pop();return e}function gd(n){n.fixed|=2}function ng(n){n.fixed&=-7}function tg(n){n.fixed|=4;n.px=n.x;n.py=n.y}function ig(n){n.fixed&=-5}function gv(n,t,i){var f=0,e=0,u;if(n.charge=0,!n.leaf)for(var r,o=n.nodes,h=o.length,s=-1;++s<h;)r=o[s],null!=r&&(gv(r,t,i),n.charge+=r.charge,f+=r.charge*r.cx,e+=r.charge*r.cy);n.point&&(n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5),u=t*i[n.point.index],n.charge+=n.pointCharge=u,f+=u*n.point.x,e+=u*n.point.y);n.cx=f/n.charge;n.cy=e/n.charge}function ar(t,i){return n.rebind(t,i,"sort","children","value"),t.nodes=t,t.links=eg,t}function rg(n){return n.children}function ug(n){return n.value}function fg(n,t){return t.value-n.value}function eg(t){return n.merge(t.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function og(n){return n.x}function sg(n){return n.y}function hg(n,t,i){n.y0=t;n.y=i}function ls(t){return n.range(t.length)}function as(n){for(var t=-1,r=n[0].length,i=[];++t<r;)i[t]=0;return i}function cg(n){for(var i,t=1,r=0,u=n[0][1],f=n.length;f>t;++t)(i=n[t][1])>u&&(r=t,u=i);return r}function lg(n){return n.reduce(ag,0)}function ag(n,t){return n+t[1]}function vg(n,t){return ny(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ny(n,t){for(var i=-1,r=+n[0],f=(n[1]-r)/t,u=[];++i<=t;)u[i]=f*i+r;return u}function yg(t){return[n.min(t),n.max(t)]}function ty(n,t){return n.parent==t.parent?1:2}function vs(n){var t=n.children;return t&&t.length?t[0]:n._tree.thread}function ys(n){var i,t=n.children;return t&&(i=t.length)?t[i-1]:n._tree.thread}function wu(n,t){var i=n.children,u,f,r;if(i&&(f=i.length))for(r=-1;++r<f;)t(u=wu(i[r],t),n)>0&&(n=u);return n}function pg(n,t){return n.x-t.x}function wg(n,t){return t.x-n.x}function bg(n,t){return n.depth-t.depth}function at(n,t){function i(n,r){var u=n.children,f,s,e,o;if(u&&(s=u.length))for(e=null,o=-1;++o<s;)f=u[o],i(f,e),e=f;t(n,r)}i(n,null)}function kg(n){for(var t,i=0,f=0,r=n.children,u=r.length;--u>=0;)t=r[u]._tree,t.prelim+=i,t.mod+=i,i+=t.shift+(f+=t.change)}function dg(n,t,i){n=n._tree;t=t._tree;var r=i/(t.number-n.number);n.change+=r;t.change-=r;t.shift+=i;t.prelim+=i;t.mod+=i}function gg(n,t,i){return n._tree.ancestor.parent==t.parent?n._tree.ancestor:i}function nn(n,t){return n.value-t.value}function ps(n,t){var i=n._pack_next;n._pack_next=t;t._pack_prev=n;t._pack_next=i;i._pack_prev=t}function iy(n,t){n._pack_next=t;t._pack_prev=n}function ry(n,t){var i=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>i*i+r*r}function uy(n){function h(n){c=Math.min(n.x-n.r,c);l=Math.max(n.x+n.r,l);a=Math.min(n.y-n.r,a);v=Math.max(n.y+n.r,v)}if((u=n.children)&&(s=u.length)){var u,i,r,t,f,e,o,s,c=1/0,l=-1/0,a=1/0,v=-1/0;if(u.forEach(tn),i=u[0],i.x=-i.r,i.y=0,h(i),s>1&&(r=u[1],r.x=r.r,r.y=0,h(r),s>2))for(t=u[2],ey(i,r,t),h(t),ps(i,t),i._pack_prev=t,ps(t,r),r=i._pack_next,f=3;s>f;f++){ey(i,r,t=u[f]);var y=0,p=1,w=1;for(e=r._pack_next;e!==r;e=e._pack_next,p++)if(ry(e,t)){y=1;break}if(1==y)for(o=i._pack_prev;o!==e._pack_prev&&!ry(o,t);o=o._pack_prev,w++);y?(w>p||p==w&&r.r<i.r?iy(i,r=e):iy(i=o,r),f--):(ps(i,t),r=t,h(t))}var k=(c+l)/2,d=(a+v)/2,b=0;for(f=0;s>f;f++)t=u[f],t.x-=k,t.y-=d,b=Math.max(b,t.r+Math.sqrt(t.x*t.x+t.y*t.y));n.r=b;u.forEach(rn)}}function tn(n){n._pack_next=n._pack_prev=n}function rn(n){delete n._pack_next;delete n._pack_prev}function fy(n,t,i,r){var u=n.children,f,e;if(n.x=t+=r*n.x,n.y=i+=r*n.y,n.r*=r,u)for(f=-1,e=u.length;++f<e;)fy(u[f],t,i,r)}function ey(n,t,i){var r=n.r+i.r,f=t.x-n.x,e=t.y-n.y,u,o,s,h;r&&(f||e)?(u=t.r+i.r,o=f*f+e*e,u*=u,r*=r,s=.5+(r-u)/(2*o),h=Math.sqrt(Math.max(0,2*u*(r+o)-(r-=o)*r-u*u))/(2*o),i.x=n.x+s*f+h*e,i.y=n.y+s*e-h*f):(i.x=n.x+r,i.y=n.y)}function un(t){return 1+n.max(t,function(n){return n.y})}function fn(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function oy(n){var t=n.children;return t&&t.length?oy(t[0]):n}function sy(n){var i,t=n.children;return t&&(i=t.length)?sy(t[i-1]):n}function ws(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function hy(n,t){var u=n.x+t[3],f=n.y+t[0],i=n.dx-t[1]-t[3],r=n.dy-t[0]-t[2];return 0>i&&(u+=i/2,i=0),0>r&&(f+=r/2,r=0),{x:u,y:f,dx:i,dy:r}}function ur(n){var t=n[0],i=n[n.length-1];return i>t?[t,i]:[i,t]}function bu(n){return n.rangeExtent?n.rangeExtent():ur(n.range())}function en(n,t,i,r){var u=i(n[0],n[1]),f=r(t[0],t[1]);return function(n){return f(u(n))}}function bs(n,t){var i,r=0,u=n.length-1,f=n[r],e=n[u];return f>e&&(i=r,r=u,u=i,i=f,f=e,e=i),n[r]=t.floor(f),n[u]=t.ceil(e),n}function on(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:sw}function sn(t,i,r,u){var o=[],s=[],f=0,e=Math.min(t.length,i.length)-1;for(t[e]<t[0]&&(t=t.slice().reverse(),i=i.slice().reverse());++f<=e;)o.push(r(t[f-1],t[f])),s.push(u(i[f-1],i[f]));return function(i){var r=n.bisect(t,i,1,e)-1;return s[r](o[r](i))}}function cy(n,t,i,r){function f(){var f=Math.min(n.length,t.length)>2?sn:en,s=r?bd:wd;return e=f(n,t,s,i),o=f(t,n,s,ai),u}function u(n){return e(n)}var e,o;return u.invert=function(n){return o(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),f()):n},u.range=function(n){return arguments.length?(t=n,f()):t},u.rangeRound=function(n){return u.range(n).interpolate(yv)},u.clamp=function(n){return arguments.length?(r=n,f()):r},u.interpolate=function(n){return arguments.length?(i=n,f()):i},u.ticks=function(t){return ds(n,t)},u.tickFormat=function(t,i){return gs(n,t,i)},u.nice=function(t){return ly(n,t),f()},u.copy=function(){return cy(n,t,i,r)},f()}function ks(t,i){return n.rebind(t,i,"range","rangeRound","interpolate","clamp")}function ly(n,t){return bs(n,on(vr(n,t)[2]))}function vr(n,t){null==t&&(t=10);var r=ur(n),f=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(f/t)/Math.LN10)),u=t/f*i;return.15>=u?i*=10:.35>=u?i*=5:.75>=u&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+.5*i,r[2]=i,r}function ds(t,i){return n.range.apply(n,vr(t,i))}function gs(t,i,r){var u=-Math.floor(Math.log(vr(t,i)[2])/Math.LN10+.01);return n.format(r?r.replace(kp,function(n,t,i,r,f,e,o,s,h,c){return[t,i,r,f,e,o,s,h||"."+(u-2*("%"===c)),c].join("")}):",."+u+"f")}function ay(t,i,r,u){function e(n){return(r?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(i)}function o(n){return r?Math.pow(i,n):-Math.pow(i,-n)}function f(n){return t(e(n))}return f.invert=function(n){return o(t.invert(n))},f.domain=function(n){return arguments.length?(r=n[0]>=0,t.domain((u=n.map(Number)).map(e)),f):u},f.base=function(n){return arguments.length?(i=+n,t.domain(u.map(e)),f):i},f.nice=function(){var n=bs(u.map(e),r?Math:hw);return t.domain(n),u=n.map(o),f},f.ticks=function(){var h=ur(u),t=[],c=h[0],l=h[1],n=Math.floor(e(c)),s=Math.ceil(e(l)),a=i%1?2:i,f;if(isFinite(s-n)){if(r){for(;s>n;n++)for(f=1;a>f;f++)t.push(o(n)*f);t.push(o(n))}else for(t.push(o(n));n++<s;)for(f=a-1;f>0;f--)t.push(o(n)*f);for(n=0;t[n]<c;n++);for(s=t.length;t[s-1]>l;s--);t=t.slice(n,s)}return t},f.tickFormat=function(t,i){if(!arguments.length)return uc;arguments.length<2?i=uc:"function"!=typeof i&&(i=n.format(i));var u,s=Math.max(.1,t/f.ticks().length),h=r?(u=1e-12,Math.ceil):(u=-1e-12,Math.floor);return function(n){return n/o(h(e(n)+u))<=s?i(n):""}},f.copy=function(){return ay(t.copy(),i,r,u)},ks(f,t)}function vy(n,t,i){function r(t){return n(u(t))}var u=ku(t),f=ku(1/t);return r.invert=function(t){return f(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((i=t.map(Number)).map(u)),r):i},r.ticks=function(n){return ds(i,n)},r.tickFormat=function(n,t){return gs(i,n,t)},r.nice=function(n){return r.domain(ly(i,n))},r.exponent=function(e){return arguments.length?(u=ku(t=e),f=ku(1/t),n.domain(i.map(u)),r):t},r.copy=function(){return vy(n.copy(),t,i)},ks(r,n)}function ku(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function yy(t,i){function r(n){return u[((f.get(n)||"range"===i.t&&f.set(n,t.push(n)))-1)%u.length]}function o(i,r){return n.range(t.length).map(function(n){return i+r*n})}var f,u,e;return r.domain=function(n){if(!arguments.length)return t;t=[];f=new rt;for(var u,e=-1,o=n.length;++e<o;)f.has(u=n[e])||f.set(u,t.push(u));return r[i.t].apply(r,i.a)},r.range=function(n){return arguments.length?(u=n,e=0,i={t:"range",a:arguments},r):u},r.rangePoints=function(n,f){arguments.length<2&&(f=0);var s=n[0],h=n[1],c=(h-s)/(Math.max(1,t.length-1)+f);return u=o(t.length<2?(s+h)/2:s+c*f/2,c),e=0,i={t:"rangePoints",a:arguments},r},r.rangeBands=function(n,f,s){arguments.length<2&&(f=0);arguments.length<3&&(s=f);var h=n[1]<n[0],l=n[+h],a=n[1-h],c=(a-l)/(t.length-f+2*s);return u=o(l+c*s,c),h&&u.reverse(),e=c*(1-f),i={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,f,s){arguments.length<2&&(f=0);arguments.length<3&&(s=f);var h=n[1]<n[0],c=n[+h],a=n[1-h],l=Math.floor((a-c)/(t.length-f+2*s)),v=a-c-(t.length-f)*l;return u=o(c+Math.round(v/2),l),h&&u.reverse(),e=Math.round(l*(1-f)),i={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return e},r.rangeExtent=function(){return ur(i.a[0])},r.copy=function(){return yy(t,i)},r.domain(t)}function py(t,i){function f(){var f=0,e=i.length;for(r=[];++f<e;)r[f-1]=n.quantile(t,f/e);return u}function u(t){if(!isNaN(t=+t))return i[n.bisect(r,t)]}var r;return u.domain=function(i){return arguments.length?(t=i.filter(function(n){return!isNaN(n)}).sort(n.ascending),f()):t},u.range=function(n){return arguments.length?(i=n,f()):i},u.quantiles=function(){return r},u.invertExtent=function(n){return n=i.indexOf(n),0>n?[NaN,NaN]:[n>0?r[n-1]:t[0],n<r.length?r[n]:t[t.length-1]]},u.copy=function(){return py(t,i)},f()}function wy(n,t,i){function r(t){return i[Math.max(0,Math.min(e,Math.floor(u*(t-n))))]}function f(){return u=i.length/(t-n),e=i.length-1,r}var u,e;return r.domain=function(i){return arguments.length?(n=+i[0],t=+i[i.length-1],f()):[n,t]},r.range=function(n){return arguments.length?(i=n,f()):i},r.invertExtent=function(t){return t=i.indexOf(t),t=0>t?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return wy(n,t,i)},f()}function by(t,i){function r(r){if(r>=r)return i[n.bisect(t,r)]}return r.domain=function(n){return arguments.length?(t=n,r):t},r.range=function(n){return arguments.length?(i=n,r):i},r.invertExtent=function(n){return n=i.indexOf(n),[t[n-1],t[n]]},r.copy=function(){return by(t,i)},r}function ky(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=i.map(t),t):n},t.ticks=function(t){return ds(n,t)},t.tickFormat=function(t,i){return gs(n,t,i)},t.copy=function(){return ky(n)},t}function hn(n){return n.innerRadius}function cn(n){return n.outerRadius}function dy(n){return n.startAngle}function gy(n){return n.endAngle}function np(n){for(var t,i,r,u=-1,f=n.length;++u<f;)t=n[u],i=t[0],r=t[1]+si,t[0]=i*Math.cos(r),t[1]=i*Math.sin(r);return n}function tp(n){function t(t){function b(){p.push("M",i(n(w),s),a,l(n(y.reverse()),s),"Z")}for(var v,k,d,p=[],y=[],w=[],c=-1,g=t.length,nt=e(f),tt=e(o),it=f===r?function(){return k}:e(r),rt=o===u?function(){return d}:e(u);++c<g;)h.call(this,v=t[c],c)?(y.push([k=+nt.call(this,v,c),d=+tt.call(this,v,c)]),w.push([+it.call(this,v,c),+rt.call(this,v,c)])):y.length&&(b(),y=[],w=[]);return y.length&&b(),p.length?p.join(""):null}var f=ut,r=ut,o=0,u=ct,h=sr,i=k,c=i.key,l=i,a="L",s=.7;return t.x=function(n){return arguments.length?(f=r=n,t):r},t.x0=function(n){return arguments.length?(f=n,t):f},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(o=u=n,t):u},t.y0=function(n){return arguments.length?(o=n,t):o},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(h=n,t):h},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?i=n:(i=ee.get(n)||k).key,l=i.reverse||i,a=i.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(s=n,t):s},t}function ln(n){return n.radius}function ip(n){return[n.x,n.y]}function an(n){return function(){var t=n.apply(this,arguments),i=t[0],r=t[1]+si;return[i*Math.cos(r),i*Math.sin(r)]}}function vn(){return 64}function yn(){return"circle"}function rp(n){var t=Math.sqrt(n/u);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function yr(n,t){return ff(n,c),n.id=t,n}function nh(n,t,i,r){var u=n.id;return dt(n,"function"==typeof i?function(n,f,e){n.__transition__[u].tween.set(t,r(i.call(n,n.__data__,f,e)))}:(i=r(i),function(n){n.__transition__[u].tween.set(t,i)}))}function pn(n){return null==n&&(n=""),function(){this.textContent=n}}function du(t,i,r,u){var e=t.__transition__||(t.__transition__={active:0,count:0}),f=e[r],o;f||(o=u.time,f=e[r]={tween:new rt,time:o,ease:u.ease,delay:u.delay,duration:u.duration},++e.count,n.timer(function(n){function l(n){return e.active>r?s():(e.active=r,f.event&&f.event.start.call(t,h,i),f.tween.forEach(function(n,r){(r=r.call(t,h,i))&&c.push(r)}),a(n||1)?1:(dl(a,u,o),void 0))}function a(n){if(e.active!==r)return s();for(var u=n/y,l=v(u),o=c.length;o>0;)c[--o].call(t,l);if(u>=1)return(f.event&&f.event.end.call(t,h,i),s())}function s(){return--e.count?delete e[r]:delete t.__transition__,1}var h=t.__data__,v=f.ease,u=f.delay,y=f.duration,c=[];return n>=u?l(n-u):(dl(l,u,o),void 0)},0,o))}function up(n,t){n.attr("transform",function(n){return"translate("+t(n)+",0)"})}function fp(n,t){n.attr("transform",function(n){return"translate(0,"+t(n)+")"})}function vt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function vi(n,t,i){function e(t){var i=n(t),r=f(i,1);return r-t>t-i?i:r}function u(i){return t(i=n(new v(i-1)),1),i}function f(n,i){return t(n=new v(+n),i),n}function o(n,r,f){var e=u(n),o=[];if(f>1)for(;r>e;)i(e)%f||o.push(new Date(+e)),t(e,1);else for(;r>e;)o.push(new Date(+e)),t(e,1);return o}function s(n,t,i){try{v=vt;var r=new vt;return r._=n,o(r,t,i)}finally{v=Date}}n.floor=n;n.round=e;n.ceil=u;n.offset=f;n.range=o;var r=n.utc=gu(n);return r.floor=r,r.round=gu(e),r.ceil=gu(u),r.offset=gu(f),r.range=s,n}function gu(n){return function(t,i){try{v=vt;var r=new vt;return r._=t,n(r,i)._}finally{v=Date}}}function y(n){function t(t){for(var u,e,s,f=[],r=-1,o=0;++r<i;)37===n.charCodeAt(r)&&(f.push(n.substring(o,r)),null!=(e=dw[u=n.charAt(++r)])&&(u=n.charAt(++r)),(s=ce[u])&&(u=s(t,null==e?"e"===u?" ":"0":e)),f.push(u),o=r+1);return f.push(n.substring(o,r)),f.join("")}var i=n.length;return t.parse=function(t){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},f=nf(i,n,t,0),u,r;return f!=t.length?null:("p"in i&&(i.H=i.H%12+12*i.p),u=null!=i.Z&&v!==vt,r=new(u?vt:v),"j"in i?r.setFullYear(i.y,0,i.j):"w"in i&&("W"in i||"U"in i)?(r.setFullYear(i.y,0,1),r.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(r.getDay()+5)%7:i.w+7*i.U-(r.getDay()+6)%7)):r.setFullYear(i.y,i.m,i.d),r.setHours(i.H+Math.floor(i.Z/100),i.M+i.Z%100,i.S,i.L),u?r._:r)},t.toString=function(){return n},t}function nf(n,t,i,r){for(var f,e,o,u=0,s=t.length,h=i.length;s>u;){if(r>=h)return-1;if(f=t.charCodeAt(u++),37===f){if(o=t.charAt(u++),e=nrt[o in dw?t.charAt(u++):o],!e||(r=e(n,i,r))<0)return-1}else if(f!=i.charCodeAt(r++))return-1}return r}function tf(t){return new RegExp("^(?:"+t.map(n.requote).join("|")+")","i")}function rf(n){for(var i=new rt,t=-1,r=n.length;++t<r;)i.set(n[t].toLowerCase(),t);return i}function p(n,t,i){var u=0>n?"-":"",r=(u?-n:n)+"",f=r.length;return u+(i>f?new Array(i-f+1).join(t)+r:r)}function wn(n,t,i){pw.lastIndex=0;var r=pw.exec(t.substring(i));return r?(n.w=kit.get(r[0].toLowerCase()),i+r[0].length):-1}function bn(n,t,i){yw.lastIndex=0;var r=yw.exec(t.substring(i));return r?(n.w=bit.get(r[0].toLowerCase()),i+r[0].length):-1}function kn(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+1));return r?(n.w=+r[0],i+r[0].length):-1}function dn(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i));return r?(n.U=+r[0],i+r[0].length):-1}function gn(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i));return r?(n.W=+r[0],i+r[0].length):-1}function ntt(n,t,i){bw.lastIndex=0;var r=bw.exec(t.substring(i));return r?(n.m=git.get(r[0].toLowerCase()),i+r[0].length):-1}function ttt(n,t,i){ww.lastIndex=0;var r=ww.exec(t.substring(i));return r?(n.m=dit.get(r[0].toLowerCase()),i+r[0].length):-1}function itt(n,t,i){return nf(n,ce.c.toString(),t,i)}function rtt(n,t,i){return nf(n,ce.x.toString(),t,i)}function utt(n,t,i){return nf(n,ce.X.toString(),t,i)}function ftt(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+4));return r?(n.y=+r[0],i+r[0].length):-1}function ett(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.y=stt(+r[0]),i+r[0].length):-1}function ott(n,t,i){return/^[+-]\d{4}$/.test(t=t.substring(i,i+5))?(n.Z=+t,i+5):-1}function stt(n){return n+(n>68?1900:2e3)}function htt(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.m=r[0]-1,i+r[0].length):-1}function ep(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.d=+r[0],i+r[0].length):-1}function ctt(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+3));return r?(n.j=+r[0],i+r[0].length):-1}function op(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.H=+r[0],i+r[0].length):-1}function ltt(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.M=+r[0],i+r[0].length):-1}function att(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+2));return r?(n.S=+r[0],i+r[0].length):-1}function vtt(n,t,i){s.lastIndex=0;var r=s.exec(t.substring(i,i+3));return r?(n.L=+r[0],i+r[0].length):-1}function ytt(n,t,i){var r=trt.get(t.substring(i,i+=2).toLowerCase());return null==r?-1:(n.p=r,i)}function ptt(n){var t=n.getTimezoneOffset(),i=t>0?"-":"+",r=~~(Math.abs(t)/60),u=Math.abs(t)%60;return i+p(r,"0",2)+p(u,"0",2)}function wtt(n,t,i){kw.lastIndex=0;var r=kw.exec(t.substring(i,i+1));return r?i+r[0].length:-1}function ft(n){function t(n){try{v=vt;var t=new v;return t._=n,i(t)}finally{v=Date}}var i=y(n);return t.parse=function(n){try{v=vt;var t=i.parse(n);return t&&t._}finally{v=Date}},t.toString=i.toString,t}function th(n){return n.toISOString()}function ih(t,i,r){function u(n){return t(n)}function f(t,r){var e=t[1]-t[0],f=e/r,u=n.bisect(le,f);return u==le.length?[i.year,vr(t.map(function(n){return n/31536e6}),r)[2]]:u?i[f/le[u-1]<le[u]/f?u-1:u]:[urt,vr(t,r)[2]]}return u.invert=function(n){return yi(t.invert(n))},u.domain=function(n){return arguments.length?(t.domain(n),u):t.domain().map(yi)},u.nice=function(n,t){function r(i){return!isNaN(i)&&!n.range(i,yi(+i+1),t).length}var e=u.domain(),o=ur(e),i=null==n?f(o,10):"number"==typeof n&&f(o,n);return i&&(n=i[0],t=i[1]),u.domain(bs(e,t>1?{floor:function(t){for(;r(t=n.floor(t));)t=yi(t-1);return t},ceil:function(t){for(;r(t=n.ceil(t));)t=yi(+t+1);return t}}:n))},u.ticks=function(n,t){var i=ur(u.domain()),r=null==n?f(i,10):"number"==typeof n?f(i,n):!n.range&&[{range:n},t];return r&&(n=r[0],t=r[1]),n.range(i[0],yi(+i[1]+1),1>t?1:t)},u.tickFormat=function(){return r},u.copy=function(){return ih(t.copy(),i,r)},ks(u,t)}function yi(n){return new Date(n)}function sp(n){return function(t){for(var r=n.length-1,i=n[r];!i[1](t);)i=n[--r];return i[0](t)}}function btt(n){return JSON.parse(n.responseText)}function ktt(n){var t=g.createRange();return t.selectNode(g.body),t.createContextualFragment(n.responseText)}var n={version:"3.3.6"},rh,yt,uh,fh,f,ef,et,sh,of,sf,lp,hf,lf,ch,yp,af,vf,pr,wr,pf,wf,bf,kf,ot,ah,dp,br,yh,ph,gf,ii,b,kh,bi,dh,gh,nc,tc,ic,ee,dr,oe,gr,rw,uw,fw,rc,ew,ow,sw,uc,hw,si,cw,fc,ec,vw,ac;Date.now||(Date.now=function(){return+new Date});var dtt=[].slice,ni=function(n){return dtt.call(n)},g=document,ti=g.documentElement,a=window;try{ni(ti.childNodes)[0].nodeType}catch(ort){ni=function(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i}}try{g.createElement("div").style.setProperty("opacity",0,"")}catch(srt){var uf=a.Element.prototype,gtt=uf.setAttribute,nit=uf.setAttributeNS,hp=a.CSSStyleDeclaration.prototype,tit=hp.setProperty;uf.setAttribute=function(n,t){gtt.call(this,n,t+"")};uf.setAttributeNS=function(n,t,i){nit.call(this,n,t,i+"")};hp.setProperty=function(n,t,i){tit.call(this,n,t+"",i)}}n.ascending=function(n,t){return t>n?-1:n>t?1:n>=t?0:NaN};n.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN};n.min=function(n,t){var i,u,r=-1,f=n.length;if(1===arguments.length){for(;++r<f&&!(null!=(i=n[r])&&i>=i);)i=void 0;for(;++r<f;)null!=(u=n[r])&&i>u&&(i=u)}else{for(;++r<f&&!(null!=(i=t.call(n,n[r],r))&&i>=i);)i=void 0;for(;++r<f;)null!=(u=t.call(n,n[r],r))&&i>u&&(i=u)}return i};n.max=function(n,t){var i,u,r=-1,f=n.length;if(1===arguments.length){for(;++r<f&&!(null!=(i=n[r])&&i>=i);)i=void 0;for(;++r<f;)null!=(u=n[r])&&u>i&&(i=u)}else{for(;++r<f&&!(null!=(i=t.call(n,n[r],r))&&i>=i);)i=void 0;for(;++r<f;)null!=(u=t.call(n,n[r],r))&&u>i&&(i=u)}return i};n.extent=function(n,t){var i,r,f,u=-1,e=n.length;if(1===arguments.length){for(;++u<e&&!(null!=(i=f=n[u])&&i>=i);)i=f=void 0;for(;++u<e;)null!=(r=n[u])&&(i>r&&(i=r),r>f&&(f=r))}else{for(;++u<e&&!(null!=(i=f=t.call(n,n[u],u))&&i>=i);)i=void 0;for(;++u<e;)null!=(r=t.call(n,n[u],u))&&(i>r&&(i=r),r>f&&(f=r))}return[i,f]};n.sum=function(n,t){var r,u=0,f=n.length,i=-1;if(1===arguments.length)for(;++i<f;)isNaN(r=+n[i])||(u+=r);else for(;++i<f;)isNaN(r=+t.call(n,n[i],i))||(u+=r);return u};n.mean=function(n,t){var u,e=n.length,i=0,r=-1,f=0;if(1===arguments.length)for(;++r<e;)ae(u=n[r])&&(i+=(u-i)/++f);else for(;++r<e;)ae(u=t.call(n,n[r],r))&&(i+=(u-i)/++f);if(f)return i};n.quantile=function(n,t){var u=(n.length-1)*t+1,i=Math.floor(u),r=+n[i-1],f=u-i;return f?r+f*(n[i]-r):r};n.median=function(t,i){return arguments.length>1&&(t=t.map(i)),t=t.filter(ae),t.length?n.quantile(t.sort(n.ascending),.5):void 0};n.bisector=function(n){return{left:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;n.call(t,t[f],f)<i?r=f+1:u=f}return r},right:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;i<n.call(t,t[f],f)?u=f:r=f+1}return r}}};rh=n.bisector(function(n){return n});n.bisectLeft=rh.left;n.bisect=n.bisectRight=rh.right;n.shuffle=function(n){for(var r,i,t=n.length;t;)i=0|Math.random()*t--,r=n[t],n[t]=n[i],n[i]=r;return n};n.permute=function(n,t){for(var i=t.length,r=new Array(i);i--;)r[i]=n[t[i]];return r};n.pairs=function(n){for(var f,t=0,i=n.length-1,r=n[0],u=new Array(0>i?0:i);i>t;)u[t]=[f=r,r=n[++t]];return u};n.zip=function(){var r,t,e;if(!(r=arguments.length))return[];for(var i=-1,u=n.min(arguments,nb),f=new Array(u);++i<u;)for(t=-1,e=f[i]=new Array(r);++t<r;)e[t]=arguments[t][i];return f};n.transpose=function(t){return n.zip.apply(n,t)};n.keys=function(n){var t=[];for(var i in n)t.push(i);return t};n.values=function(n){var t=[];for(var i in n)t.push(n[i]);return t};n.entries=function(n){var t=[];for(var i in n)t.push({key:i,value:n[i]});return t};n.merge=function(n){return Array.prototype.concat.apply([],n)};n.range=function(n,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=n,n=0)),1/0==(t-n)/i)throw new Error("infinite range");var u,f=[],r=tb(Math.abs(i)),e=-1;if(n*=r,t*=r,i*=r,0>i)for(;(u=n+i*++e)>t;)f.push(u/r);else for(;(u=n+i*++e)<t;)f.push(u/r);return f};n.map=function(n){var t=new rt,i;if(n instanceof rt)n.forEach(function(n,i){t.set(n,i)});else for(i in n)t.set(i,n[i]);return t};yc(rt,{has:function(n){return yt+n in this},get:function(n){return this[yt+n]},set:function(n,t){return this[yt+n]=t},remove:function(n){return n=yt+n,n in this&&delete this[n]},keys:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},values:function(){var n=[];return this.forEach(function(t,i){n.push(i)}),n},entries:function(){var n=[];return this.forEach(function(t,i){n.push({key:t,value:i})}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===uh&&n.call(this,t.substring(1),this[t])}});yt="\x00";uh=yt.charCodeAt(0);n.nest=function(){function r(n,e,o){if(o>=i.length)return f?f.call(t,e):u?e.sort(u):e;for(var l,s,h,a,v=-1,y=e.length,p=i[o++],c=new rt;++v<y;)(a=c.get(l=p(s=e[v])))?a.push(s):c.set(l,[s]);return n?(s=n(),h=function(t,i){s.set(t,r(n,i,o))}):(s={},h=function(t,i){s[t]=r(n,i,o)}),c.forEach(h),s}function e(n,t){if(t>=i.length)return n;var r=[],u=o[t++];return n.forEach(function(n,i){r.push({key:n,values:e(i,t)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var u,f,t={},i=[],o=[];return t.map=function(n,t){return r(t,n,0)},t.entries=function(t){return e(r(n.map,t,0),0)},t.key=function(n){return i.push(n),t},t.sortKeys=function(n){return o[i.length-1]=n,t},t.sortValues=function(n){return u=n,t},t.rollup=function(n){return f=n,t},t};n.set=function(n){var i=new ve,t,r;if(n)for(t=0,r=n.length;r>t;++t)i.add(n[t]);return i};yc(ve,{has:function(n){return yt+n in this},add:function(n){return this[yt+n]=!0,n},remove:function(n){return n=yt+n,n in this&&delete this[n]},values:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===uh&&n.call(this,t.substring(1))}});n.behavior={};n.rebind=function(n,t){for(var i,r=1,u=arguments.length;++r<u;)n[i=arguments[r]]=ib(n,t,t[i]);return n};fh=["webkit","ms","moz","Moz","o","O"];n.dispatch=function(){for(var n=new pe,t=-1,i=arguments.length;++t<i;)n[arguments[t]]=pc(n);return n};pe.prototype.on=function(n,t){var r=n.indexOf("."),i="";if(r>=0&&(i=n.substring(r+1),n=n.substring(0,r)),n)return arguments.length<2?this[n].on(i):this[n].on(i,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(i,null);return this}};n.event=null;n.requote=function(n){return n.replace(iit,"\\$&")};var iit=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ff={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)n[i]=t[i]},eh=function(n,t){return t.querySelector(n)},oh=function(n,t){return t.querySelectorAll(n)},rit=ti[ye(ti,"matchesSelector")],cp=function(n,t){return rit.call(n,t)};"function"==typeof Sizzle&&(eh=function(n,t){return Sizzle(n,t)[0]||null},oh=function(n,t){return Sizzle.uniqueSort(Sizzle(n,t))},cp=Sizzle.matchesSelector);n.selection=function(){return sh};f=n.selection.prototype=[];f.select=function(n){var i,f,e,t,o=[],r,s,u,h;for(n=be(n),r=-1,s=this.length;++r<s;)for(o.push(i=[]),i.parentNode=(e=this[r]).parentNode,u=-1,h=e.length;++u<h;)(t=e[u])?(i.push(f=n.call(t,t.__data__,u,r)),f&&"__data__"in t&&(f.__data__=t.__data__)):i.push(null);return kt(o)};f.selectAll=function(n){var u,t,f=[],i,e;for(n=bc(n),i=-1,e=this.length;++i<e;)for(var o=this[i],r=-1,s=o.length;++r<s;)(t=o[r])&&(f.push(u=ni(n.call(t,t.__data__,r,i))),u.parentNode=t);return kt(f)};ef={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};n.ns={prefix:ef,qualify:function(n){var t=n.indexOf(":"),i=n;return t>=0&&(i=n.substring(0,t),n=n.substring(t+1)),ef.hasOwnProperty(i)?{space:ef[i],local:n}:n}};f.attr=function(t,i){if(arguments.length<2){if("string"==typeof t){var r=this.node();return t=n.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(i in t)this.each(kc(i,t[i]));return this}return this.each(kc(t,i))};f.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var r=this.node(),u=(n=n.trim().split(/^|\s+/g)).length,i=-1;if(t=r.classList){for(;++i<u;)if(!t.contains(n[i]))return!1}else for(t=r.getAttribute("class");++i<u;)if(!gc(n[i]).test(t))return!1;return!0}for(t in n)this.each(nl(t,n[t]));return this}return this.each(nl(n,t))};f.style=function(n,t,i){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.each(tl(i,n[i],t));return this}if(2>r)return a.getComputedStyle(this.node(),null).getPropertyValue(n);i=""}return this.each(tl(n,t,i))};f.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(il(t,n[t]));return this}return this.each(il(n,t))};f.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent};f.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML};f.append=function(n){return n=rl(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})};f.insert=function(n,t){return n=rl(n),t=be(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments))})};f.remove=function(){return this.each(function(){var n=this.parentNode;n&&n.removeChild(this)})};f.data=function(n,t){function e(n,i){var r,u,o,l=n.length,a=i.length,k=Math.min(l,a),v=new Array(a),c=new Array(a),y=new Array(l);if(t){var e,p=new rt,w=new rt,b=[];for(r=-1;++r<l;)e=t.call(u=n[r],u.__data__,r),p.has(e)?y[r]=u:p.set(e,u),b.push(e);for(r=-1;++r<a;)e=t.call(i,o=i[r],r),(u=p.get(e))?(v[r]=u,u.__data__=o):w.has(e)||(c[r]=ke(o)),w.set(e,o),p.remove(e);for(r=-1;++r<l;)p.has(b[r])&&(y[r]=n[r])}else{for(r=-1;++r<k;)u=n[r],o=i[r],u?(u.__data__=o,v[r]=u):c[r]=ke(o);for(;a>r;++r)c[r]=ke(i[r]);for(;l>r;++r)y[r]=n[r]}c.update=v;c.parentNode=v.parentNode=y.parentNode=n.parentNode;s.push(c);f.push(v);h.push(y)}var r,o,i=-1,u=this.length;if(!arguments.length){for(n=new Array(u=(r=this[0]).length);++i<u;)(o=r[i])&&(n[i]=o.__data__);return n}var s=fl([]),f=kt([]),h=kt([]);if("function"==typeof n)for(;++i<u;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<u;)e(r=this[i],n);return f.enter=function(){return s},f.exit=function(){return h},f};f.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")};f.filter=function(n){var u,f,i,e=[],r,o,t,s;for("function"!=typeof n&&(n=ul(n)),r=0,o=this.length;o>r;r++)for(e.push(u=[]),u.parentNode=(f=this[r]).parentNode,t=0,s=f.length;s>t;t++)(i=f[t])&&n.call(i,i.__data__,t)&&u.push(i);return kt(e)};f.order=function(){for(var i=-1,f=this.length;++i<f;)for(var t,r=this[i],u=r.length-1,n=r[u];--u>=0;)(t=r[u])&&(n&&n!==t.nextSibling&&n.parentNode.insertBefore(t,n),n=t);return this};f.sort=function(n){n=ub.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(n);return this.order()};f.each=function(n){return dt(this,function(t,i,r){n.call(t,t.__data__,i,r)})};f.call=function(n){var t=ni(arguments);return n.apply(t[0]=this,t),this};f.empty=function(){return!this.node()};f.node=function(){for(var i,n=0,r=this.length;r>n;n++)for(var u=this[n],t=0,f=u.length;f>t;t++)if(i=u[t],i)return i;return null};f.size=function(){var n=0;return this.each(function(){++n}),n};et=[];n.selection.enter=fl;n.selection.enter.prototype=et;et.append=f.append;et.empty=f.empty;et.node=f.node;et.call=f.call;et.size=f.size;et.select=function(n){for(var i,h,r,e,o,t,u,s=[],f=-1,c=this.length;++f<c;)for(o=(t=this[f]).update,s.push(r=[]),r.parentNode=t.parentNode,i=-1,h=t.length;++i<h;)(u=t[i])?(r.push(o[i]=e=n.call(t.parentNode,u.__data__,i,f)),e.__data__=u.__data__):r.push(null);return kt(s)};et.insert=function(n,t){return arguments.length<2&&(t=fb(this)),f.insert.call(this,n,t)};f.transition=function(){for(var i,n,r=ki||++aw,u=[],o=se||{time:Date.now(),ease:ud,delay:0,duration:250},f=-1,s=this.length;++f<s;){u.push(i=[]);for(var e=this[f],t=-1,h=e.length;++t<h;)(n=e[t])&&du(n,t,r,o),i.push(n)}return yr(u,r)};f.interrupt=function(){return this.each(nu)};n.select=function(n){var t=["string"==typeof n?eh(n,g):n];return t.parentNode=ti,kt([t])};n.selectAll=function(n){var t=ni("string"==typeof n?oh(n,g):n);return t.parentNode=ti,kt([t])};sh=n.select(ti);f.on=function(n,t,i){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(i in n)this.each(el(i,n[i],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;i=!1}return this.each(el(n,t,i))};of=n.map({mouseenter:"mouseover",mouseleave:"mouseout"});of.forEach(function(n){"on"+n in g&&of.remove(n)});sf=ye(ti.style,"userSelect");lp=0;n.mouse=function(n){return sl(n,wc())};hf=/WebKit/.test(a.navigator.userAgent)?-1:0;n.touches=function(n,t){return arguments.length<2&&(t=wc().touches),t?ni(t).map(function(t){var i=sl(n,t);return i.identifier=t.identifier,i}):[]};n.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",s)}function f(){return n.event.changedTouches[0].identifier}function e(t,i){return n.touches(t).filter(function(n){return n.identifier===i})[0]}function r(t,r,f,e){return function(){function w(){var n=r(y,h),t=n[0]-s[0],i=n[1]-s[1];p|=t|i;s=n;v({type:"drag",x:n[0]+o[0],y:n[1]+o[1],dx:t,dy:i})}function b(){d.on(f+"."+c,null).on(e+"."+c,null);g(p&&n.event.target===k);v({type:"dragend"})}var o,l=this,y=l.parentNode,v=u.of(l,arguments),k=n.event.target,h=t(),c=null==h?"drag":"drag-"+h,s=r(y,h),p=0,d=n.select(a).on(f+"."+c,w).on(e+"."+c,b),g=tu();i?(o=i.apply(l,arguments),o=[o.x-s[0],o.y-s[1]]):o=[0,0];v({type:"dragstart"})}}var u=we(t,"drag","dragstart","dragend"),i=null,o=r(h,n.mouse,"mousemove","mouseup"),s=r(f,e,"touchmove","touchend");return t.origin=function(n){return arguments.length?(i=n,t):i},n.rebind(t,u,"on")};var u=Math.PI,nt=2*u,w=u/2,i=1e-6,ap=i*i,r=u/180,o=180/u,cf=Math.SQRT2,hh=2,vp=4;n.interpolateZoom=function(n,t){function v(n){var t=n*p,r,h;return y?(r=de(u),h=i/(hh*c)*(r*ob(cf*t+u)-ll(u)),[o+h*f,s+h*e,i*r/de(cf*t+u)]):[o+n*f,s+n*e,i*Math.exp(cf*t)]}var o=n[0],s=n[1],i=n[2],w=t[0],b=t[1],r=t[2],f=w-o,e=b-s,h=f*f+e*e,c=Math.sqrt(h),l=(r*r-i*i+vp*h)/(2*i*hh*c),a=(r*r-i*i-vp*h)/(2*r*hh*c),u=Math.log(Math.sqrt(l*l+1)-l),k=Math.log(Math.sqrt(a*a+1)-a),y=k-u,p=(y||Math.log(r/i))/cf;return v.duration=1e3*p,v};n.behavior.zoom=function(){function i(n){n.on(tt,ut).on(yp+".zoom",ht).on(it,et).on("dblclick.zoom",ct).on(rt,ft)}function s(n){return[(n[0]-t.x)/t.k,(n[1]-t.y)/t.k]}function st(n){return[n[0]*t.k+t.x,n[1]*t.k+t.y]}function h(n){t.k=Math.max(w[0],Math.min(w[1],n))}function o(n,i){i=st(i);t.x+=n[0]-i[0];t.y+=n[1]-i[1]}function b(){v&&v.domain(g.range().map(function(n){return(n-t.x)/t.k}).map(g.invert));y&&y.domain(nt.range().map(function(n){return(n-t.y)/t.k}).map(nt.invert))}function u(n){n({type:"zoomstart"})}function r(n){b();n({type:"zoom",scale:t.k,translate:[t.x,t.y]})}function f(n){n({type:"zoomend"})}function ut(){function c(){h=1;o(n.mouse(t),p);r(i)}function l(){y.on(it,a===t?et:null).on(ot,null);w(h&&n.event.target===v);f(i)}var t=this,i=e.of(t,arguments),v=n.event.target,h=0,y=n.select(a).on(it,c).on(ot,l),p=s(n.mouse(t)),w=tu();nu.call(t);u(i)}function ft(){function y(){var r=n.touches(c);return w=t.k,r.forEach(function(n){n.identifier in i&&(i[n.identifier]=s(n))}),r}function p(){for(var u,s,f,a,c=n.event.changedTouches,e=0,k=c.length;k>e;++e)i[c[e].identifier]=null;if(u=y(),s=Date.now(),1===u.length)500>s-d&&(f=u[0],a=i[f.identifier],h(2*t.k),o(f,a),bt(),r(l)),d=s;else if(u.length>1){var f=u[0],p=u[1],w=f[0]-p[0],b=f[1]-p[1];v=w*w+b*b}}function nt(){for(var s,p,t,f,u,e,y=n.touches(c),a=0,b=y.length;b>a;++a,e=null)if(u=y[a],e=i[u.identifier]){if(f)break;t=u;f=e}e&&(s=(s=u[0]-t[0])*s+(s=u[1]-t[1])*s,p=v&&Math.sqrt(s/v),t=[(t[0]+u[0])/2,(t[1]+u[1])/2],f=[(f[0]+e[0])/2,(f[1]+e[1])/2],h(p*w));d=null;o(t,f);r(l)}function it(){var e;if(n.event.touches.length){for(var r=n.event.changedTouches,t=0,u=r.length;u>t;++t)delete i[r[t].identifier];for(e in i)return void y()}et.on(k,null).on(g,null);ot.on(tt,ut).on(rt,ft);st();f(l)}var w,c=this,l=e.of(c,arguments),i={},v=0,b=n.event.changedTouches[0].identifier,k="touchmove.zoom-"+b,g="touchend.zoom-"+b,et=n.select(a).on(k,nt).on(g,it),ot=n.select(c).on(tt,null).on(rt,p),st=tu();nu.call(c);p();u(l)}function ht(){var i=e.of(this,arguments),a;l?clearTimeout(l):(nu.call(this),u(i));l=setTimeout(function(){l=null;f(i)},50);bt();a=k||n.mouse(this);c||(c=s(a));h(Math.pow(2,.002*lf())*t.k);o(a,c);r(i)}function et(){c=null}function ct(){var i=e.of(this,arguments),c=n.mouse(this),a=s(c),l=Math.log(t.k)/Math.LN2;u(i);h(Math.pow(2,n.event.shiftKey?Math.ceil(l)-1:Math.floor(l)+1));o(c,a);r(i);f(i)}var c,k,l,d,g,v,nt,y,t={x:0,y:0,k:1},p=[960,500],w=ch,tt="mousedown.zoom",it="mousemove.zoom",ot="mouseup.zoom",rt="touchstart.zoom",e=we(i,"zoomstart","zoom","zoomend");return i.event=function(i){i.each(function(){var i=e.of(this,arguments),o=t;ki?n.select(this).transition().each("start.zoom",function(){t=this.__chart__||{x:0,y:0,k:1};u(i)}).tween("zoom:zoom",function(){var u=p[0],s=p[1],f=u/2,e=s/2,h=n.interpolateZoom([(f-t.x)/t.k,(e-t.y)/t.k,u/t.k],[(f-o.x)/o.k,(e-o.y)/o.k,u/o.k]);return function(n){var o=h(n),s=u/o[2];this.__chart__=t={x:f-o[0]*s,y:e-o[1]*s,k:s};r(i)}}).each("end.zoom",function(){f(i)}):(this.__chart__=t,u(i),r(i),f(i))})},i.translate=function(n){return arguments.length?(t={x:+n[0],y:+n[1],k:t.k},b(),i):[t.x,t.y]},i.scale=function(n){return arguments.length?(t={x:t.x,y:t.y,k:+n},b(),i):t.k},i.scaleExtent=function(n){return arguments.length?(w=null==n?ch:[+n[0],+n[1]],i):w},i.center=function(n){return arguments.length?(k=n&&[+n[0],+n[1]],i):k},i.size=function(n){return arguments.length?(p=n&&[+n[0],+n[1]],i):p},i.x=function(n){return arguments.length?(v=n,g=n.copy(),t={x:0,y:0,k:1},i):v},i.y=function(n){return arguments.length?(y=n,nt=n.copy(),t={x:0,y:0,k:1},i):y},n.rebind(i,e,"on")};ch=[0,1/0];yp="onwheel"in g?(lf=function(){return-n.event.deltaY*(n.event.deltaMode?120:1)},"wheel"):"onmousewheel"in g?(lf=function(){return n.event.wheelDelta},"mousewheel"):(lf=function(){return-n.event.detail},"MozMousePixelScroll");di.prototype.toString=function(){return this.rgb()+""};n.hsl=function(n,t,i){return 1===arguments.length?n instanceof ge?gi(n.h,n.s,n.l):wl(""+n,bl,gi):gi(+n,+t,+i)};af=ge.prototype=new di;af.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),gi(this.h,this.s,this.l/n)};af.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),gi(this.h,this.s,n*this.l)};af.rgb=function(){return no(this.h,this.s,this.l)};n.hcl=function(t,i,r){return 1===arguments.length?t instanceof iu?nr(t.h,t.c,t.l):t instanceof ru?yl(t.l,t.a,t.b):yl((t=kl((t=n.rgb(t)).r,t.g,t.b)).l,t.a,t.b):nr(+t,+i,+r)};vf=iu.prototype=new di;vf.brighter=function(n){return nr(this.h,this.c,Math.min(100,this.l+yf*(arguments.length?n:1)))};vf.darker=function(n){return nr(this.h,this.c,Math.max(0,this.l-yf*(arguments.length?n:1)))};vf.rgb=function(){return to(this.h,this.c,this.l).rgb()};n.lab=function(t,i,r){return 1===arguments.length?t instanceof ru?tr(t.l,t.a,t.b):t instanceof iu?to(t.l,t.c,t.h):kl((t=n.rgb(t)).r,t.g,t.b):tr(+t,+i,+r)};var yf=18,pp=.95047,wp=1,bp=1.08883,lh=ru.prototype=new di;lh.brighter=function(n){return tr(Math.min(100,this.l+yf*(arguments.length?n:1)),this.a,this.b)};lh.darker=function(n){return tr(Math.max(0,this.l-yf*(arguments.length?n:1)),this.a,this.b)};lh.rgb=function(){return vl(this.l,this.a,this.b)};n.rgb=function(n,t,i){return 1===arguments.length?n instanceof fo?ht(n.r,n.g,n.b):wl(""+n,ht,no):ht(~~n,~~t,~~i)};pr=fo.prototype=new di;pr.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var i=this.r,r=this.g,u=this.b,t=30;return i||r||u?(i&&t>i&&(i=t),r&&t>r&&(r=t),u&&t>u&&(u=t),ht(Math.min(255,~~(i/n)),Math.min(255,~~(r/n)),Math.min(255,~~(u/n)))):ht(t,t,t)};pr.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),ht(~~(n*this.r),~~(n*this.g),~~(n*this.b))};pr.hsl=function(){return bl(this.r,this.g,this.b)};pr.toString=function(){return"#"+ir(this.r)+ir(this.g)+ir(this.b)};wr=n.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});wr.forEach(function(n,t){wr.set(n,pl(t))});n.functor=e;n.xhr=so(l);n.dsv=function(t,i){function r(t,r,u){arguments.length<3&&(u=r,r=null);var o=n.xhr(t,i,u);return o.row=function(n){return arguments.length?o.response(null==(r=n)?f:e(n)):r},o.row(r)}function f(n){return r.parse(n.responseText)}function e(n){return function(t){return r.parse(t.responseText,n)}}function o(n){return n.map(u).join(t)}function u(n){return s.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var s=new RegExp('["'+t+"\n]"),h=t.charCodeAt(0);return r.parse=function(n,t){var i;return r.parseRows(n,function(n,r){if(i)return i(n,r-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");i=t?function(n,i){return t(u(n),i)}:u})},r.parseRows=function(n,t){function s(){var f,t,u,s;if(i>=o)return e;if(r)return r=!1,c;if(f=i,34===n.charCodeAt(f)){for(t=f;t++<o;)if(34===n.charCodeAt(t)){if(34!==n.charCodeAt(t+1))break;++t}return i=t+2,u=n.charCodeAt(t+1),13===u?(r=!0,10===n.charCodeAt(t+2)&&++i):10===u&&(r=!0),n.substring(f+1,t).replace(/""/g,'"')}for(;o>i;){if(u=n.charCodeAt(i++),s=1,10===u)r=!0;else if(13===u)r=!0,10===n.charCodeAt(i)&&(++i,++s);else if(u!==h)continue;return n.substring(f,i-s)}return n.substring(f)}for(var f,u,r,c={},e={},l=[],o=n.length,i=0,a=0;(u=s())!==e;){for(f=[];u!==c&&u!==e;)f.push(u),u=s();(!t||(f=t(f,a++)))&&l.push(f)}return l},r.format=function(n){if(Array.isArray(n[0]))return r.formatRows(n);var f=new ve,i=[];return n.forEach(function(n){for(var t in n)f.has(t)||i.push(f.add(t))}),[i.map(u).join(t)].concat(n.map(function(n){return i.map(function(t){return u(n[t])}).join(t)})).join("\n")},r.formatRows=function(n){return n.map(o).join("\n")},r};n.csv=n.dsv(",","text/csv");n.tsv=n.dsv("\t","text/tab-separated-values");ah=a[ye(a,"requestAnimationFrame")]||function(n){setTimeout(n,17)};n.timer=function(n,t,i){var u=arguments.length,f,r;2>u&&(t=0);3>u&&(i=Date.now());f=i+t;r={callback:n,time:f,next:null};wf?wf.next=r:pf=r;wf=r;bf||(kf=clearTimeout(kf),bf=1,ah(co))};n.timer.flush=function(){gl();na()};var uit=".",fit=",",df=[3,3],eit="$",oit=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(hb);n.formatPrefix=function(t,i){var r=0;return t&&(0>t&&(t*=-1),i&&(t=n.round(t,lo(t,i))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((0>=r?r+1:r-1)/3)))),oit[8+r/3]};n.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};n.format=function(t){var u=kp.exec(t),v=u[1]||" ",e=u[2]||">",p=u[3]||"",f=u[4]||"",s=u[5],h=+u[6],c=u[7],r=u[8],i=u[9],o=1,l="",y=!1,a;switch(r&&(r=+r.substring(1)),(s||"0"===v&&"="===e)&&(s=v="0",e="=",c&&(h-=Math.floor((h-1)/4))),i){case"n":c=!0;i="g";break;case"%":o=100;l="%";i="f";break;case"p":o=100;l="%";i="r";break;case"b":case"o":case"x":case"X":"#"===f&&(f="0"+i.toLowerCase());case"c":case"d":y=!0;r=0;break;case"s":o=-1;i="r"}return"#"===f?f="":"$"===f&&(f=eit),"r"!=i||r||(i="g"),null!=r&&("g"==i?r=Math.max(1,Math.min(21,r)):("e"==i||"f"==i)&&(r=Math.max(0,Math.min(20,r)))),i=sit.get(i)||cb,a=s&&c,function(t){var u,g,k,w;if(y&&t%1)return"";u=0>t||0===t&&0>1/t?(t=-t,"-"):p;0>o?(g=n.formatPrefix(t,r),t=g.scale(t),l=g.symbol):t*=o;t=i(t,r);var d=t.lastIndexOf("."),b=0>d?t:t.substring(0,d),nt=0>d?"":uit+t.substring(d+1);return!s&&c&&(b=vh(b)),k=f.length+b.length+nt.length+(a?0:u.length),w=h>k?new Array(k=h-k+1).join(v):"",a&&(b=vh(w+b)),u+=f,t=b+nt,("<"===e?u+t+w:">"===e?w+u+t:"^"===e?w.substring(0,k>>=1)+u+t+w.substring(k):u+(a?t:w+t))+l}};var kp=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,sit=n.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(t,i){return(t=n.round(t,lo(t,i))).toFixed(Math.max(0,Math.min(20,lo(t*(1+1e-15),i))))}}),vh=l;df&&(dp=df.length,vh=function(n){for(var i=n.length,r=[],u=0,t=df[0];i>0&&t>0;)r.push(n.substring(i-=t,i+t)),t=df[u=(u+1)%dp];return r.reverse().join(fit)});n.geo={};ao.prototype={s:0,t:0,add:function(n){ta(n,this.t,br);ta(br.s,this.s,this);this.s?this.t+=br.t:this.s=br.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};br=new ao;n.geo.stream=function(n,t){n&&yh.hasOwnProperty(n.type)?yh[n.type](n,t):fu(n,t)};yh={Feature:function(n,t){fu(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,r=-1,u=i.length;++r<u;)fu(i[r].geometry,t)}};ph={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates;t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)n=i[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){vo(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)vo(i[r],t,0)},Polygon:function(n,t){ia(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)ia(i[r],t)},GeometryCollection:function(n,t){for(var i=n.geometries,r=-1,u=i.length;++r<u;)fu(i[r],t)}};n.geo.area=function(t){return gf=0,n.geo.stream(t,b),gf};ii=new ao;b={sphere:function(){gf+=4*u},point:h,lineStart:h,lineEnd:h,polygonStart:function(){ii.reset();b.lineStart=lb},polygonEnd:function(){var n=2*ii;gf+=0>n?4*u+n:n;b.lineStart=b.lineEnd=b.point=h}};n.geo.bounds=function(){function p(n,i){a.push(c=[t=n,u=n]);e>i&&(e=i);i>s&&(s=i)}function w(n,i){var k=ci([n*r,i*r]),a;if(v){var w=rr(v,k),g=[w[1],-w[0],0],h=rr(g,w);su(h);h=hu(h);var d=n-l,y=d>0?1:-1,c=h[0]*o*y,b=Math.abs(d)>180;b^(c>y*l&&y*n>c)?(a=h[1]*o,a>s&&(s=a)):(c=(c+360)%360-180,b^(c>y*l&&y*n>c))?(a=-h[1]*o,e>a&&(e=a)):(e>i&&(e=i),i>s&&(s=i));b?l>n?f(t,n)>f(t,u)&&(u=n):f(n,u)>f(t,u)&&(t=n):u>=t?(t>n&&(t=n),n>u&&(u=n)):n>l?f(t,n)>f(t,u)&&(u=n):f(n,u)>f(t,u)&&(t=n)}else p(n,i);v=k;l=n}function k(){h.point=w}function d(){c[0]=t;c[1]=u;h.point=p;v=null}function g(n,t){if(v){var i=n-l;y+=Math.abs(i)>180?i+(i>0?360:-360):i}else tt=n,it=t;b.point(n,t);w(n,t)}function rt(){b.lineStart()}function ut(){g(tt,it);b.lineEnd();Math.abs(y)>i&&(t=-(u=180));c[0]=t;c[1]=u;v=null}function f(n,t){return(t-=n)<0?t+360:t}function ft(n,t){return n[0]-t[0]}function nt(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var t,e,u,s,l,tt,it,v,y,a,c,h={point:p,lineStart:k,lineEnd:d,polygonStart:function(){h.point=g;h.lineStart=rt;h.lineEnd=ut;y=0;b.polygonStart()},polygonEnd:function(){b.polygonEnd();h.point=p;h.lineStart=k;h.lineEnd=d;0>ii?(t=-(u=180),e=-(s=90)):y>i?s=90:-i>y&&(e=-90);c[0]=t;c[1]=u}};return function(i){var v;if(s=u=-(t=e=1/0),a=[],n.geo.stream(i,h),v=a.length,v){a.sort(ft);for(var o,l=1,r=a[0],y=[r];v>l;++l)o=a[l],nt(o[0],r)||nt(o[1],r)?(f(r[0],o[1])>f(r[0],r[1])&&(r[1]=o[1]),f(o[0],r[1])>f(r[0],r[1])&&(r[0]=o[0])):y.push(r=o);for(var p,o,w=-1/0,v=y.length-1,l=0,r=y[v];v>=l;r=o,++l)o=y[l],(p=f(r[1],o[0]))>w&&(w=p,t=o[0],u=r[1])}return a=c=null,1/0===t||1/0===e?[[NaN,NaN],[NaN,NaN]]:[[t,e],[u,s]]}}();n.geo.centroid=function(t){kr=ne=pi=wi=pt=ri=ui=st=fr=er=fi=0;n.geo.stream(t,tt);var r=fr,u=er,f=fi,e=r*r+u*u+f*f;return ap>e&&(r=ri,u=ui,f=st,i>ne&&(r=pi,u=wi,f=pt),e=r*r+u*u+f*f,ap>e)?[NaN,NaN]:[Math.atan2(u,r)*o,hi(f/Math.sqrt(e))*o]};var kr,ne,pi,wi,pt,ri,ui,st,fr,er,fi,tt={sphere:h,point:po,lineStart:ra,lineEnd:ua,polygonStart:function(){tt.lineStart=ab},polygonEnd:function(){tt.lineStart=ra}},gp=oa(sr,wb,kb,[-u,-u/2]),te=1e9;n.geo.clipExtent=function(){var t,i,r,u,n,f,e={stream:function(t){return n&&(n.valid=!1),n=f(t),n.valid=!0,n},extent:function(o){return arguments.length?(f=ha(t=+o[0][0],i=+o[0][1],r=+o[1][0],u=+o[1][1]),n&&(n.valid=!1,n=null),e):[[t,i],[r,u]]}};return e.extent([[0,0],[960,500]])};(n.geo.conicEqualArea=function(){return wo(la)}).raw=la;n.geo.albers=function(){return n.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};n.geo.albersUsa=function(){function r(n){var t=n[0],i=n[1];return u=null,s(t,i),u||(h(t,i),u)||c(t,i),u}var u,s,h,c,t=n.geo.albers(),f=n.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),e=n.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o={point:function(n,t){u=[n,t]}};return r.invert=function(n){var u=t.scale(),o=t.translate(),i=(n[0]-o[0])/u,r=(n[1]-o[1])/u;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?f:r>=.166&&.234>r&&i>=-.214&&-.115>i?e:t).invert(n)},r.stream=function(n){var i=t.stream(n),r=f.stream(n),u=e.stream(n);return{point:function(n,t){i.point(n,t);r.point(n,t);u.point(n,t)},sphere:function(){i.sphere();r.sphere();u.sphere()},lineStart:function(){i.lineStart();r.lineStart();u.lineStart()},lineEnd:function(){i.lineEnd();r.lineEnd();u.lineEnd()},polygonStart:function(){i.polygonStart();r.polygonStart();u.polygonStart()},polygonEnd:function(){i.polygonEnd();r.polygonEnd();u.polygonEnd()}}},r.precision=function(n){return arguments.length?(t.precision(n),f.precision(n),e.precision(n),r):t.precision()},r.scale=function(n){return arguments.length?(t.scale(n),f.scale(.35*n),e.scale(n),r.translate(t.translate())):t.scale()},r.translate=function(n){if(!arguments.length)return t.translate();var u=t.scale(),l=+n[0],a=+n[1];return s=t.translate(n).clipExtent([[l-.455*u,a-.238*u],[l+.455*u,a+.238*u]]).stream(o).point,h=f.translate([l-.307*u,a+.201*u]).clipExtent([[l-.425*u+i,a+.12*u+i],[l-.214*u-i,a+.234*u-i]]).stream(o).point,c=e.translate([l-.205*u,a+.212*u]).clipExtent([[l-.214*u+i,a+.166*u+i],[l-.115*u-i,a+.234*u-i]]).stream(o).point,r},r.scale(1070)};var wh,bh,ie,re,ue,fe,ei={point:h,lineStart:h,lineEnd:h,polygonStart:function(){bh=0;ei.lineStart=gb},polygonEnd:function(){ei.lineStart=ei.lineEnd=ei.point=h;wh+=Math.abs(bh/2)}},hit={point:nk,lineStart:h,lineEnd:h,polygonStart:h,polygonEnd:h},it={point:li,lineStart:va,lineEnd:ya,polygonStart:function(){it.lineStart=ik},polygonEnd:function(){it.point=li;it.lineStart=va;it.lineEnd=ya}};n.geo.transform=function(n){return{stream:function(t){var i=new au(t);for(var r in n)i[r]=n[r];return i}}};au.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};n.geo.path=function(){function t(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),f&&f.valid||(f=u(i)),n.geo.stream(t,f)),i.result()}function e(){return f=null,t}var o,s,u,i,f,r=4.5;return t.area=function(t){return wh=0,n.geo.stream(t,u(ei)),wh},t.centroid=function(t){return pi=wi=pt=ri=ui=st=fr=er=fi=0,n.geo.stream(t,u(it)),fi?[fr/fi,er/fi]:st?[ri/st,ui/st]:pt?[pi/pt,wi/pt]:[NaN,NaN]},t.bounds=function(t){return ue=fe=-(ie=re=1/0),n.geo.stream(t,u(hit)),[[ie,re],[ue,fe]]},t.projection=function(n){return arguments.length?(u=(o=n)?n.stream||uk(n):l,e()):o},t.context=function(n){return arguments.length?(i=null==(s=n)?new tk:new rk(n),"function"!=typeof r&&i.pointRadius(r),e()):s},t.pointRadius=function(n){return arguments.length?(r="function"==typeof n?n:(i.pointRadius(+n),+n),t):r},t.projection(n.geo.albersUsa()).context(null)};n.geo.projection=gt;n.geo.projectionMutator=bo;(n.geo.equirectangular=function(){return gt(hr)}).raw=hr.invert=hr;n.geo.rotation=function(n){function t(t){return t=n(t[0]*r,t[1]*r),t[0]*=o,t[1]*=o,t}return n=ko(n[0]%360*r,n[1]*r,n.length>2?n[2]*r:0),t.invert=function(t){return t=n.invert(t[0]*r,t[1]*r),t[0]*=o,t[1]*=o,t},t};wa.invert=hr;n.geo.circle=function(){function n(){var n="function"==typeof t?t.apply(this,arguments):t,f=ko(-n[0]*r,-n[1]*r,0).invert,i=[];return u(null,null,1,{point:function(n,t){i.push(n=f(n,t));n[0]*=o;n[1]*=o}}),{type:"Polygon",coordinates:[i]}}var i,u,t=[0,0],f=6;return n.origin=function(i){return arguments.length?(t=i,n):t},n.angle=function(t){return arguments.length?(u=go((i=+t)*r,f*r),n):i},n.precision=function(t){return arguments.length?(u=go(i*r,(f=+t)*r),n):f},n.angle(90)};n.geo.distance=function(n,t){var i,f=(t[0]-n[0])*r,e=n[1]*r,o=t[1]*r,a=Math.sin(f),s=Math.cos(f),h=Math.sin(e),c=Math.cos(e),l=Math.sin(o),u=Math.cos(o);return Math.atan2(Math.sqrt((i=u*a)*i+(i=c*l-h*u*s)*i),h*l+c*u*s)};n.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:k()}}function k(){return n.range(Math.ceil(u/a)*a,r,a).map(w).concat(n.range(Math.ceil(e/v)*v,f,v).map(b)).concat(n.range(Math.ceil(s/l)*l,o,l).filter(function(n){return Math.abs(n%a)>i}).map(d)).concat(n.range(Math.ceil(c/p)*p,h,p).filter(function(n){return Math.abs(n%v)>i}).map(g))}var o,s,r,u,h,c,f,e,d,g,w,b,l=10,p=l,a=90,v=360,y=2.5;return t.lines=function(){return k().map(function(n){return{type:"LineString",coordinates:n}})},t.outline=function(){return{type:"Polygon",coordinates:[w(u).concat(b(f).slice(1),w(r).reverse().slice(1),b(e).reverse().slice(1))]}},t.extent=function(n){return arguments.length?t.majorExtent(n).minorExtent(n):t.minorExtent()},t.majorExtent=function(n){return arguments.length?(u=+n[0][0],r=+n[1][0],e=+n[0][1],f=+n[1][1],u>r&&(n=u,u=r,r=n),e>f&&(n=e,e=f,f=n),t.precision(y)):[[u,e],[r,f]]},t.minorExtent=function(n){return arguments.length?(s=+n[0][0],o=+n[1][0],c=+n[0][1],h=+n[1][1],s>o&&(n=s,s=o,o=n),c>h&&(n=c,c=h,h=n),t.precision(y)):[[s,c],[o,h]]},t.step=function(n){return arguments.length?t.majorStep(n).minorStep(n):t.minorStep()},t.majorStep=function(n){return arguments.length?(a=+n[0],v=+n[1],t):[a,v]},t.minorStep=function(n){return arguments.length?(l=+n[0],p=+n[1],t):[l,p]},t.precision=function(n){return arguments.length?(y=+n,d=nv(c,h,90),g=tv(s,o,y),w=nv(e,f,90),b=tv(u,r,y),t):y},t.majorExtent([[-180,-90+i],[180,90-i]]).minorExtent([[-180,-80-i],[180,80+i]])};n.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[u||i.apply(this,arguments),f||r.apply(this,arguments)]}}var u,f,i=ns,r=ts;return t.distance=function(){return n.geo.distance(u||i.apply(this,arguments),f||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,u="function"==typeof n?null:n,t):i},t.target=function(n){return arguments.length?(r=n,f="function"==typeof n?null:n,t):r},t.precision=function(){return arguments.length?t:0},t};n.geo.interpolate=function(n,t){return ek(n[0]*r,n[1]*r,t[0]*r,t[1]*r)};n.geo.length=function(t){return kh=0,n.geo.stream(t,bi),kh};bi={sphere:h,point:h,lineStart:ok,lineEnd:h,polygonStart:h,polygonEnd:h};dh=cr(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(n.geo.azimuthalEqualArea=function(){return gt(dh)}).raw=dh;gh=cr(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},l);(n.geo.azimuthalEquidistant=function(){return gt(gh)}).raw=gh;(n.geo.conicConformal=function(){return wo(iv)}).raw=iv;(n.geo.conicEquidistant=function(){return wo(rv)}).raw=rv;nc=cr(function(n){return 1/n},Math.atan);(n.geo.gnomonic=function(){return gt(nc)}).raw=nc;vu.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-w]};(n.geo.mercator=function(){return uv(vu)}).raw=vu;tc=cr(function(){return 1},Math.asin);(n.geo.orthographic=function(){return gt(tc)}).raw=tc;ic=cr(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(n.geo.stereographic=function(){return gt(ic)}).raw=ic;is.invert=function(n,t){return[Math.atan2(ll(n),Math.cos(t)),hi(Math.sin(t)/de(n))]};(n.geo.transverseMercator=function(){return uv(is)}).raw=is;n.geom={};n.svg={};n.svg.line=function(){return fv(l)};ee=n.map({linear:k,"linear-closed":sk,step:hk,"step-before":rs,"step-after":us,basis:ev,"basis-open":vk,"basis-closed":yk,bundle:pk,cardinal:ak,"cardinal-open":ck,"cardinal-closed":lk,monotone:kk});ee.forEach(function(n,t){t.key=n;t.closed=/-closed$/.test(n)});var nw=[0,2/3,1/3,0],tw=[0,1/3,2/3,0],oi=[0,1/6,2/3,1/6];n.geom.hull=function(n){function t(n){var d;if(n.length<3)return[];var u,g,t,o,l,a,p,w,b,v,k,c,nt=e(r),it=e(i),y=n.length,tt=y-1,f=[],h=[],s=0;if(nt===ut&&i===ct)u=n;else for(t=0,u=[];y>t;++t)u.push([+nt.call(this,g=n[t],t),+it.call(this,g,t)]);for(t=1;y>t;++t)(u[t][1]<u[s][1]||u[t][1]==u[s][1]&&u[t][0]<u[s][0])&&(s=t);for(t=0;y>t;++t)t!==s&&(a=u[t][1]-u[s][1],l=u[t][0]-u[s][0],f.push({angle:Math.atan2(a,l),index:t}));for(f.sort(function(n,t){return n.angle-t.angle}),k=f[0].angle,v=f[0].index,b=0,t=1;tt>t;++t){if(o=f[t].index,k==f[t].angle){if(l=u[v][0]-u[s][0],a=u[v][1]-u[s][1],p=u[o][0]-u[s][0],w=u[o][1]-u[s][1],l*l+a*a>=p*p+w*w){f[t].index=-1;continue}f[b].index=-1}k=f[t].angle;b=t;v=o}for(h.push(s),t=0,o=0;2>t;++o)f[o].index>-1&&(h.push(f[o].index),t++);for(c=h.length;tt>o;++o)if(!(f[o].index<0)){for(;!dk(h[c-2],h[c-1],f[o].index,u);)--c;h[c++]=f[o].index}for(d=[],t=c-1;t>=0;--t)d.push(n[h[t]]);return d}var r=ut,i=ct;return arguments.length?t(n):(t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(i=n,t):i},t)};n.geom.polygon=function(n){return ff(n,dr),n};dr=n.geom.polygon.prototype=[];dr.area=function(){for(var t,i=-1,r=this.length,n=this[r-1],u=0;++i<r;)t=n,n=this[i],u+=t[1]*n[0]-t[0]*n[1];return.5*u};dr.centroid=function(n){var i,r,u=-1,f=this.length,e=0,o=0,t=this[f-1];for(arguments.length||(n=-1/(6*this.area()));++u<f;)i=t,t=this[u],r=i[0]*t[1]-t[0]*i[1],e+=(i[0]+t[0])*r,o+=(i[1]+t[1])*r;return[e*n,o*n]};dr.clip=function(n){for(var f,e,o,t,i,r,s=sv(n),h=-1,c=this.length-sv(this),u=this[c-1];++h<c;){for(f=n.slice(),n.length=0,t=this[h],i=f[(o=f.length-s)-1],e=-1;++e<o;)r=f[e],ss(r,u,t)?(ss(i,u,t)||n.push(ov(i,r,u,t)),n.push(r)):ss(i,u,t)&&n.push(ov(i,r,u,t)),i=r;s&&n.push(n[0]);u=t}return n};n.geom.delaunay=function(n){var t=n.map(function(){return[]}),i=[];return hs(n,function(i){t[i.region.l.index].push(n[i.region.r.index])}),t.forEach(function(t,r){var f=n[r],o=f[0],s=f[1],u,e;for(t.forEach(function(n){n.angle=Math.atan2(n[0]-o,n[1]-s)}),t.sort(function(n,t){return n.angle-t.angle}),u=0,e=t.length-1;e>u;u++)i.push([f,t[u],t[u+1]])}),i};n.geom.voronoi=function(t){function r(t){var c,a,s,h=t.map(function(){return[]}),v=e(f),y=e(o),l=t.length,r=1e6;if(v===ut&&y===ct)c=t;else for(c=new Array(l),s=0;l>s;++s)c[s]=[+v.call(this,a=t[s],s),+y.call(this,a,s)];if(hs(c,function(n){var t,i,u,f,e,o,s,c;1===n.a&&n.b>=0?(t=n.ep.r,i=n.ep.l):(t=n.ep.l,i=n.ep.r);1===n.a?(e=t?t.y:-r,u=n.c-n.b*e,o=i?i.y:r,f=n.c-n.b*o):(u=t?t.x:-r,e=n.c-n.a*u,f=i?i.x:r,o=n.c-n.a*f);s=[u,e];c=[f,o];h[n.region.l.index].push(s,c);h[n.region.r.index].push(s,c)}),h=h.map(function(t,r){var e=c[r][0],o=c[r][1],u=t.map(function(n){return Math.atan2(n[0]-e,n[1]-o)}),f=n.range(t.length).sort(function(n,t){return u[n]-u[t]});return f.filter(function(n,t){return!t||u[n]-u[f[t-1]]>i}).map(function(n){return t[n]})}),h.forEach(function(n,t){var l=n.length,s,u,h;if(!l)return n.push([-r,-r],[-r,r],[r,r],[r,-r]);if(!(l>2)){var a=c[t],v=n[0],y=n[1],p=a[0],w=a[1],f=v[0],e=v[1],b=y[0],k=y[1],d=Math.abs(b-f),o=k-e;Math.abs(o)<i?(u=e>w?-r:r,n.push([-r,u],[r,u])):i>d?(s=f>p?-r:r,n.push([s,-r],[s,r])):(u=(f-p)*(k-e)>(b-f)*(e-w)?r:-r,h=Math.abs(o)-d,Math.abs(h)<i?n.push([0>o?u:-u,u]):(h>0&&(u*=-1),n.push([-r,u],[r,u])))}}),u)for(s=0;l>s;++s)u.clip(h[s]);for(s=0;l>s;++s)h[s].point=t[s];return h}var f=ut,o=ct,u=null;return arguments.length?r(t):(r.x=function(n){return arguments.length?(f=n,r):f},r.y=function(n){return arguments.length?(o=n,r):o},r.clipExtent=function(t){if(!arguments.length)return u&&[u[0],u[2]];if(null==t)u=null;else{var i=+t[0][0],f=+t[0][1],e=+t[1][0],o=+t[1][1];u=n.geom.polygon([[i,f],[i,o],[e,o],[e,f]])}return r},r.size=function(n){return arguments.length?r.clipExtent(n&&[[0,0],n]):u&&u[2]},r.links=function(n){var i,u,t,r=n.map(function(){return[]}),s=[],h=e(f),c=e(o),l=n.length;if(h===ut&&c===ct)i=n;else for(i=new Array(l),t=0;l>t;++t)i[t]=[+h.call(this,u=n[t],t),+c.call(this,u,t)];return hs(i,function(t){var i=t.region.l.index,u=t.region.r.index;r[i][u]||(r[i][u]=r[u][i]=!0,s.push({source:n[i],target:n[u]}))}),s},r.triangles=function(t){if(f===ut&&o===ct)return n.geom.delaunay(t);for(var r,u=new Array(s),h=e(f),c=e(o),i=-1,s=t.length;++i<s;)(u[i]=[+h.call(this,r=t[i],i),+c.call(this,r,i)]).data=r;return n.geom.delaunay(u).map(function(n){return n.map(function(n){return n.data})})},r)};oe={l:"r",r:"l"};n.geom.quadtree=function(n,t,i,r,u){function f(n){function tt(n,t,i,r,u,f,e,o){var s,h,c;isNaN(i)||isNaN(r)||(n.leaf?(s=n.x,h=n.y,null!=s?Math.abs(s-i)+Math.abs(h-r)<.01?g(n,t,i,r,u,f,e,o):(c=n.point,n.x=n.y=n.point=null,g(n,c,s,h,u,f,e,o),g(n,t,i,r,u,f,e,o)):(n.x=i,n.y=r,n.point=t)):g(n,t,i,r,u,f,e,o))}function g(n,t,i,r,u,f,e,o){var s=.5*(u+e),h=.5*(f+o),c=i>=s,l=r>=h,a=(l<<1)+c;n.leaf=!1;n=n.nodes[a]||(n.nodes[a]=hv());c?u=s:e=s;l?f=h:o=h;tt(n,t,i,r,u,f,e,o)}var c,k,d,f,nt,l,a,v,y,ut=e(o),ft=e(s),w,b,it,rt,p;if(null!=t)l=t,a=i,v=r,y=u;else if(v=y=-(l=a=1/0),k=[],d=[],nt=n.length,h)for(f=0;nt>f;++f)c=n[f],c.x<l&&(l=c.x),c.y<a&&(a=c.y),c.x>v&&(v=c.x),c.y>y&&(y=c.y),k.push(c.x),d.push(c.y);else for(f=0;nt>f;++f)w=+ut(c=n[f],f),b=+ft(c,f),l>w&&(l=w),a>b&&(a=b),w>v&&(v=w),b>y&&(y=b),k.push(w),d.push(b);if(it=v-l,rt=y-a,it>rt?y=a+it:v=l+rt,p=hv(),p.add=function(n){tt(p,n,+ut(n,++f),+ft(n,f),l,a,v,y)},p.visit=function(n){lr(n,p,l,a,v,y)},f=-1,null==t){for(;++f<nt;)tt(p,n[f],k[f],d[f],l,a,v,y);--f}else n.forEach(p.add);return k=d=n=c=null,p}var h,o=ut,s=ct;return(h=arguments.length)?(o=gk,s=nd,3===h&&(u=i,r=t,i=t=0),f(n)):(f.x=function(n){return arguments.length?(o=n,f):o},f.y=function(n){return arguments.length?(s=n,f):s},f.extent=function(n){return arguments.length?(null==n?t=i=r=u=null:(t=+n[0][0],i=+n[0][1],r=+n[1][0],u=+n[1][1]),f):null==t?null:[[t,i],[r,u]]},f.size=function(n){return arguments.length?(null==n?t=i=r=u=null:(t=i=0,r=+n[0],u=+n[1]),f):null==t?null:[r-t,u-i]},f)};n.interpolateRgb=cs;n.interpolateObject=cv;n.interpolateNumber=lt;n.interpolateString=lv;gr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;n.interpolate=ai;n.interpolators=[function(n,t){var i=typeof t;return("string"===i?wr.has(t)||/^(#|rgb\(|hsl\()/.test(t)?cs:lv:t instanceof di?cs:"object"===i?Array.isArray(t)?pu:cv:lt)(n,t)}];n.interpolateArray=pu;var iw=function(){return l},cit=n.map({linear:iw,poly:fd,quad:function(){return id},cubic:function(){return rd},sin:function(){return ed},exp:function(){return od},circle:function(){return sd},elastic:hd,back:cd,bounce:function(){return ld}}),lit=n.map({"in":l,out:av,"in-out":vv,"out-in":function(n){return vv(av(n))}});n.ease=function(n){var t=n.indexOf("-"),i=t>=0?n.substring(0,t):n,r=t>=0?n.substring(t+1):"in";return i=cit.get(i)||iw,r=lit.get(r)||l,td(r(i.apply(null,Array.prototype.slice.call(arguments,1))))};n.interpolateHcl=ad;n.interpolateHsl=vd;n.interpolateLab=yd;n.interpolateRound=yv;n.transform=function(t){var i=g.createElementNS(n.ns.prefix.svg,"g");return(n.transform=function(n){if(null!=n){i.setAttribute("transform",n);var t=i.transform.baseVal.consolidate()}return new pv(t?t.matrix:rw)})(t)};pv.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};rw={a:1,b:0,c:0,d:1,e:0,f:0};n.interpolateTransform=kv;n.layout={};n.layout.bundle=function(){return function(n){for(var t=[],i=-1,r=n.length;++i<r;)t.push(kd(n[i]));return t}};n.layout.chord=function(){function c(){var v,t,b,c,a,k={},d=[],it=n.range(r),g=[],p,w;for(i=[],u=[],v=0,c=-1;++c<r;){for(t=0,a=-1;++a<r;)t+=f[c][a];d.push(t);g.push(n.range(r));v+=t}for(e&&it.sort(function(n,t){return e(d[n],d[t])}),o&&g.forEach(function(n,t){n.sort(function(n,i){return o(f[t][n],f[t][i])})}),v=(nt-h*r)/v,t=0,c=-1;++c<r;){for(b=t,a=-1;++a<r;){var y=it[c],tt=g[y][a],rt=f[y][tt],ut=t,ft=t+=rt*v;k[y+"-"+tt]={index:y,subindex:tt,startAngle:ut,endAngle:ft,value:rt}}u[y]={index:y,startAngle:b,endAngle:t,value:(t-b)/v};t+=h}for(c=-1;++c<r;)for(a=c-1;++a<r;)p=k[c+"-"+a],w=k[a+"-"+c],(p.value||w.value)&&i.push(p.value<w.value?{source:w,target:p}:{source:p,target:w});s&&l()}function l(){i.sort(function(n,t){return s((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var i,u,f,r,e,o,s,t={},h=0;return t.matrix=function(n){return arguments.length?(r=(f=n)&&f.length,i=u=null,t):f},t.padding=function(n){return arguments.length?(h=n,i=u=null,t):h},t.sortGroups=function(n){return arguments.length?(e=n,i=u=null,t):e},t.sortSubgroups=function(n){return arguments.length?(o=n,i=null,t):o},t.sortChords=function(n){return arguments.length?(s=n,i&&l(),t):s},t.chords=function(){return i||c(),i},t.groups=function(){return u||c(),u},t};n.layout.force=function(){function k(n){return function(t,i,r,u){var e;if(t.point!==n){var o=t.cx-n.x,s=t.cy-n.y,f=1/Math.sqrt(o*o+s*s);if(b>(u-i)*f)return e=t.charge*f*f,n.px-=o*e,n.py-=s*e,!0;t.point&&isFinite(f)&&(e=t.pointCharge*f*f,n.px-=o*e,n.py-=s*e)}return!t.charge}}function d(i){i.px=n.event.x;i.py=n.event.y;t.resume()}var h,r,c,a,v,t={},y=n.dispatch("start","tick","end"),f=[1,1],p=.9,o=uw,s=fw,e=-30,w=.1,b=.8,i=[],u=[];return t.tick=function(){if((r*=.99)<.005)return y.end({type:"end",alpha:r=0}),!0;for(var tt,t,b,g,d,s,h,l,nt=i.length,it=u.length,o=0;it>o;++o)t=u[o],b=t.source,g=t.target,h=g.x-b.x,l=g.y-b.y,(d=h*h+l*l)&&(d=r*a[o]*((d=Math.sqrt(d))-c[o])/d,h*=d,l*=d,g.x-=h*(s=b.weight/(g.weight+b.weight)),g.y-=l*s,b.x+=h*(s=1-s),b.y+=l*s);if((s=r*w)&&(h=f[0]/2,l=f[1]/2,o=-1,s))for(;++o<nt;)t=i[o],t.x+=(h-t.x)*s,t.y+=(l-t.y)*s;if(e)for(gv(tt=n.geom.quadtree(i),r,v),o=-1;++o<nt;)(t=i[o]).fixed||tt.visit(k(t));for(o=-1;++o<nt;)t=i[o],t.fixed?(t.x=t.px,t.y=t.py):(t.x-=(t.px-(t.px=t.x))*p,t.y-=(t.py-(t.py=t.y))*p);y.tick({type:"tick",alpha:r})},t.nodes=function(n){return arguments.length?(i=n,t):i},t.links=function(n){return arguments.length?(u=n,t):u},t.size=function(n){return arguments.length?(f=n,t):f},t.linkDistance=function(n){return arguments.length?(o="function"==typeof n?n:+n,t):o},t.distance=t.linkDistance,t.linkStrength=function(n){return arguments.length?(s="function"==typeof n?n:+n,t):s},t.friction=function(n){return arguments.length?(p=+n,t):p},t.charge=function(n){return arguments.length?(e="function"==typeof n?n:+n,t):e},t.gravity=function(n){return arguments.length?(w=+n,t):w},t.theta=function(n){return arguments.length?(b=+n,t):b},t.alpha=function(i){return arguments.length?(i=+i,r?r=i>0?i:0:i>0&&(y.start({type:"start",alpha:r=i}),n.timer(t.tick)),t):r},t.start=function(){function w(t,i){for(var r,u=b(n),f=-1,e=u.length;++f<e;)if(!isNaN(r=u[f][t]))return r;return Math.random()*i}function b(){if(!l){for(l=[],h=0;p>h;++h)l[h]=[];for(h=0;y>h;++h){var t=u[h];l[t.source.index].push(t.target);l[t.target.index].push(t.source)}}return l[n]}for(var h,l,r,p=i.length,y=u.length,k=f[0],d=f[1],n=0;p>n;++n)(r=i[n]).index=n,r.weight=0;for(n=0;y>n;++n)r=u[n],"number"==typeof r.source&&(r.source=i[r.source]),"number"==typeof r.target&&(r.target=i[r.target]),++r.source.weight,++r.target.weight;for(n=0;p>n;++n)r=i[n],isNaN(r.x)&&(r.x=w("x",k)),isNaN(r.y)&&(r.y=w("y",d)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(c=[],"function"==typeof o)for(n=0;y>n;++n)c[n]=+o.call(this,u[n],n);else for(n=0;y>n;++n)c[n]=o;if(a=[],"function"==typeof s)for(n=0;y>n;++n)a[n]=+s.call(this,u[n],n);else for(n=0;y>n;++n)a[n]=s;if(v=[],"function"==typeof e)for(n=0;p>n;++n)v[n]=+e.call(this,i[n],n);else for(n=0;p>n;++n)v[n]=e;return t.resume()},t.resume=function(){return t.alpha(.1)},t.stop=function(){return t.alpha(0)},t.drag=function(){return h||(h=n.behavior.drag().origin(l).on("dragstart.force",gd).on("drag.force",d).on("dragend.force",ng)),arguments.length?(this.on("mouseover.force",tg).on("mouseout.force",ig).call(h),void 0):h},n.rebind(t,y,"on")};uw=20;fw=1;n.layout.hierarchy=function(){function u(f,e,o){var h=r.call(n,f,e);if(f.depth=e,o.push(f),h&&(c=h.length)){for(var c,s,l=-1,a=f.children=[],v=0,y=e+1;++l<c;)s=u(h[l],y,o),s.parent=f,a.push(s),v+=s.value;i&&a.sort(i);t&&(f.value=v)}else t&&(f.value=+t.call(n,f,e)||0);return f}function f(i,r){var e=i.children,u=0,s,o,h;if(e&&(s=e.length))for(o=-1,h=r+1;++o<s;)u+=f(e[o],h);else t&&(u=+t.call(n,i,r)||0);return t&&(i.value=u),u}function n(n){var t=[];return u(n,0,t),t}var i=fg,r=rg,t=ug;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(i){return arguments.length?(t=i,n):t},n.revalue=function(n){return f(n,0),n},n};n.layout.partition=function(){function r(n,t,i,u){var f=n.children,o,s,h,e;if(n.x=t,n.y=n.depth*u,n.dx=i,n.dy=u,f&&(o=f.length))for(e=-1,i=n.value?i/n.value:0;++e<o;)r(s=f[e],t,h=s.value*i,u),t+=h}function u(n){var t=n.children,i=0,f,r;if(t&&(f=t.length))for(r=-1;++r<f;)i=Math.max(i,u(t[r]));return 1+i}function i(n,i){var e=f.call(this,n,i);return r(e[0],0,t[0],t[1]/u(e[0])),e}var f=n.layout.hierarchy(),t=[1,1];return i.size=function(n){return arguments.length?(t=n,i):t},ar(i,f)};n.layout.pie=function(){function t(e){var o=e.map(function(n,i){return+f.call(t,n,i)}),s=+("function"==typeof r?r.apply(this,arguments):r),l=(("function"==typeof u?u.apply(this,arguments):u)-s)/n.sum(o),c=n.range(e.length),h;return null!=i&&c.sort(i===rc?function(n,t){return o[t]-o[n]}:function(n,t){return i(e[n],e[t])}),h=[],c.forEach(function(n){var t;h[n]={data:e[n],value:t=o[n],startAngle:s,endAngle:s+=t*l}}),h}var f=Number,i=rc,r=0,u=nt;return t.value=function(n){return arguments.length?(f=n,t):f},t.sort=function(n){return arguments.length?(i=n,t):i},t.startAngle=function(n){return arguments.length?(r=n,t):r},t.endAngle=function(n){return arguments.length?(u=n,t):u},t};rc={};n.layout.stack=function(){function t(s,h){var l=s.map(function(n,i){return r.call(t,n,i)}),a=l.map(function(n){return n.map(function(n,i){return[e.call(t,n,i),o.call(t,n,i)]})}),y=u.call(t,a,h);l=n.permute(l,y);a=n.permute(a,y);for(var v,p,w=f.call(t,a,h),b=l.length,k=l[0].length,c=0;k>c;++c)for(i.call(t,l[0][c],p=w[c],a[0][c][1]),v=1;b>v;++v)i.call(t,l[v][c],p+=a[v-1][c][1],a[v][c][1]);return s}var r=l,u=ls,f=as,i=hg,e=og,o=sg;return t.values=function(n){return arguments.length?(r=n,t):r},t.order=function(n){return arguments.length?(u="function"==typeof n?n:ew.get(n)||ls,t):u},t.offset=function(n){return arguments.length?(f="function"==typeof n?n:ow.get(n)||as,t):f},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(o=n,t):o},t.out=function(n){return arguments.length?(i=n,t):i},t};ew=n.map({"inside-out":function(t){for(var i,u=t.length,f=t.map(cg),e=t.map(lg),l=n.range(u).sort(function(n,t){return f[n]-f[t]}),o=0,s=0,h=[],c=[],r=0;u>r;++r)i=l[r],s>o?(o+=e[i],h.push(i)):(s+=e[i],c.push(i));return c.reverse().concat(h)},reverse:function(t){return n.range(t.length).reverse()},"default":ls});ow=n.map({silhouette:function(n){for(var r,i,s=n.length,f=n[0].length,e=[],u=0,o=[],t=0;f>t;++t){for(r=0,i=0;s>r;r++)i+=n[r][t][1];i>u&&(u=i);e.push(i)}for(t=0;f>t;++t)o[t]=(u-e[t])/2;return o},wiggle:function(n){var i,t,r,u,h,c,f,e,o,a=n.length,l=n[0],v=l.length,s=[];for(s[0]=e=o=0,t=1;v>t;++t){for(i=0,u=0;a>i;++i)u+=n[i][t][1];for(i=0,h=0,f=l[t][0]-l[t-1][0];a>i;++i){for(r=0,c=(n[i][t][1]-n[i][t-1][1])/(2*f);i>r;++r)c+=(n[r][t][1]-n[r][t-1][1])/f;h+=c*n[i][t][1]}s[t]=e-=u?h/u*f:0;o>e&&(o=e)}for(t=0;v>t;++t)s[t]-=o;return s},expand:function(n){for(var t,r,u=n.length,f=n[0].length,o=1/u,e=[],i=0;f>i;++i){for(t=0,r=0;u>t;t++)r+=n[t][i][1];if(r)for(t=0;u>t;t++)n[t][i][1]/=r;else for(t=0;u>t;t++)n[t][i][1]=o}for(i=0;f>i;++i)e[i]=0;return e},zero:as});n.layout.histogram=function(){function t(t,e){for(var o,s,l=[],h=t.map(r,this),a=u.call(this,h,e),c=f.call(this,a,h,e),e=-1,y=h.length,v=c.length-1,p=i?1:1/y;++e<v;)o=l[e]=[],o.dx=c[e+1]-(o.x=c[e]),o.y=0;if(v>0)for(e=-1;++e<y;)s=h[e],s>=a[0]&&s<=a[1]&&(o=l[n.bisect(c,s,1,v)-1],o.y+=p,o.push(t[e]));return l}var i=!0,r=Number,u=yg,f=vg;return t.value=function(n){return arguments.length?(r=n,t):r},t.range=function(n){return arguments.length?(u=e(n),t):u},t.bins=function(n){return arguments.length?(f="number"==typeof n?function(t){return ny(t,n)}:e(n),t):f},t.frequency=function(n){return arguments.length?(i=!!n,t):i},t};n.layout.tree=function(){function i(n,i){function h(n,t){var f=n.children,i=n._tree,o;if(f&&(s=f.length)){for(var s,e,u,c=f[0],l=c,a=-1;++a<s;)u=f[a],h(u,e),l=v(u,e,l),e=u;kg(n);o=.5*(c._tree.prelim+u._tree.prelim);t?(i.prelim=t._tree.prelim+r(n,t),i.mod=i.prelim-o):i.prelim=o}else t&&(i.prelim=t._tree.prelim+r(n,t))}function c(n,t){var i,u,r;if(n.x=n._tree.prelim+t,i=n.children,i&&(u=i.length))for(r=-1,t+=n._tree.mod;++r<u;)c(i[r],t)}function v(n,t,i){if(t){for(var s,f=n,e=n,u=t,o=n.parent.children[0],h=f._tree.mod,c=e._tree.mod,l=u._tree.mod,a=o._tree.mod;u=ys(u),f=vs(f),u&&f;)o=vs(o),e=ys(e),e._tree.ancestor=n,s=u._tree.prelim+l-f._tree.prelim-h+r(u,f),s>0&&(dg(gg(u,n,i),n,s),h+=s,c+=s),l+=u._tree.mod,h+=f._tree.mod,a+=o._tree.mod,c+=e._tree.mod;u&&!ys(e)&&(e._tree.thread=u,e._tree.mod+=l-c);f&&!vs(o)&&(o._tree.thread=f,o._tree.mod+=h-a,i=n)}return i}var l=f.call(this,n,i),e=l[0];at(e,function(n,t){n._tree={ancestor:n,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}});h(e);c(e,-e._tree.prelim);var o=wu(e,wg),s=wu(e,pg),y=wu(e,bg),a=o.x-r(o,s)/2,p=s.x+r(s,o)/2,w=y.depth||1;return at(e,u?function(n){n.x*=t[0];n.y=n.depth*t[1];delete n._tree}:function(n){n.x=(n.x-a)/(p-a)*t[0];n.y=n.depth/w*t[1];delete n._tree}),l}var f=n.layout.hierarchy().sort(null).value(null),r=ty,t=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n),i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null!=(t=n),i):u?t:null},ar(i,f)};n.layout.pack=function(){function i(n,i){var c=f.call(this,n,i),e=c[0],o=u[0],s=u[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t},h;return(e.x=e.y=0,at(e,function(n){n.r=+l(n.value)}),at(e,uy),r)&&(h=r*(t?1:Math.max(2*e.r/o,2*e.r/s))/2,at(e,function(n){n.r+=h}),at(e,uy),at(e,function(n){n.r-=h})),fy(e,o/2,s/2,t?1:1/Math.max(2*e.r/o,2*e.r/s)),c}var t,f=n.layout.hierarchy().sort(nn),r=0,u=[1,1];return i.size=function(n){return arguments.length?(u=n,i):u},i.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,i):t},i.padding=function(n){return arguments.length?(r=+n,i):r},ar(i,f)};n.layout.cluster=function(){function i(n,i){var o,c=f.call(this,n,i),e=c[0],a=0;at(e,function(n){var t=n.children;t&&t.length?(n.x=fn(t),n.y=un(t)):(n.x=o?a+=r(n,o):0,n.y=0,o=n)});var s=oy(e),h=sy(e),l=s.x-r(s,h)/2,v=h.x+r(h,s)/2;return at(e,u?function(n){n.x=(n.x-e.x)*t[0];n.y=(e.y-n.y)*t[1]}:function(n){n.x=(n.x-l)/(v-l)*t[0];n.y=(1-(e.y?n.y/e.y:1))*t[1]}),c}var f=n.layout.hierarchy().sort(null).value(null),r=ty,t=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n),i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null!=(t=n),i):u?t:null},ar(i,f)};n.layout.treemap=function(){function o(n,t){for(var r,i,u=-1,f=n.length;++u<f;)i=(r=n[u]).value*(0>t?0:t),r.area=isNaN(i)||0>=i?0:i}function a(n){var u=n.children;if(u&&u.length){var l,v,y,r=c(n),t=[],f=u.slice(),h=1/0,e="slice"===i?r.dx:"dice"===i?r.dy:"slice-dice"===i?1&n.depth?r.dy:r.dx:Math.min(r.dx,r.dy);for(o(f,r.dx*r.dy/n.value),t.area=0;(y=f.length)>0;)t.push(l=f[y-1]),t.area+=l.area,"squarify"!==i||(v=p(t,e))<=h?(f.pop(),h=v):(t.area-=t.pop().area,s(t,e,r,!1),e=Math.min(r.dx,r.dy),t.length=t.area=0,h=1/0);t.length&&(s(t,e,r,!0),t.length=t.area=0);u.forEach(a)}}function v(n){var u=n.children;if(u&&u.length){var i,r=c(n),f=u.slice(),t=[];for(o(f,r.dx*r.dy/n.value),t.area=0;i=f.pop();)t.push(i),t.area+=i.area,null!=i.z&&(s(t,i.z?r.dx:r.dy,r,!f.length),t.length=t.area=0);u.forEach(v)}}function p(n,t){for(var i,r=n.area,u=0,f=1/0,o=-1,s=n.length;++o<s;)(i=n[o].area)&&(f>i&&(f=i),i>u&&(u=i));return r*=r,t*=t,r?Math.max(t*u*e/r,r/(t*f*e)):1/0}function s(n,t,i,r){var f,h=-1,c=n.length,o=i.x,s=i.y,e=t?u(n.area/t):0;if(t==i.dx){for((r||e>i.dy)&&(e=i.dy);++h<c;)f=n[h],f.x=o,f.y=s,f.dy=e,o+=f.dx=Math.min(i.x+i.dx-o,e?u(f.area/e):0);f.z=!0;f.dx+=i.x+i.dx-o;i.y+=e;i.dy-=e}else{for((r||e>i.dx)&&(e=i.dx);++h<c;)f=n[h],f.x=o,f.y=s,f.dx=e,s+=f.dy=Math.min(i.y+i.dy-s,e?u(f.area/e):0);f.z=!1;f.dy+=i.y+i.dy-s;i.x+=e;i.dx-=e}}function t(n){var i=r||h(n),t=i[0];return t.x=0,t.y=0,t.dx=f[0],t.dy=f[1],r&&h.revalue(t),o([t],t.dx*t.dy/t.value),(r?v:a)(t),l&&(r=i),i}var r,h=n.layout.hierarchy(),u=Math.round,f=[1,1],y=null,c=ws,l=!1,i="squarify",e=.5*(1+Math.sqrt(5));return t.size=function(n){return arguments.length?(f=n,t):f},t.padding=function(n){function u(i){var r=n.call(t,i,i.depth);return null==r?ws(i):hy(i,"number"==typeof r?[r,r,r,r]:r)}function i(t){return hy(t,n)}if(!arguments.length)return y;var r;return c=null==(y=n)?ws:"function"==(r=typeof n)?u:"number"===r?(n=[n,n,n,n],i):i,t},t.round=function(n){return arguments.length?(u=n?Math.round:Number,t):u!=Number},t.sticky=function(n){return arguments.length?(l=n,r=null,t):l},t.ratio=function(n){return arguments.length?(e=n,t):e},t.mode=function(n){return arguments.length?(i=n+"",t):i},ar(t,h)};n.random={normal:function(n,t){var i=arguments.length;return 2>i&&(t=1),1>i&&(n=0),function(){var r,u,i;do r=2*Math.random()-1,u=2*Math.random()-1,i=r*r+u*u;while(!i||i>1);return n+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=n.random.normal.apply(n,arguments);return function(){return Math.exp(t())}},irwinHall:function(n){return function(){for(var t=0,i=0;n>i;i++)t+=Math.random();return t/n}}};n.scale={};sw={floor:l,ceil:l};n.scale.linear=function(){return cy([0,1],[0,1],ai,!1)};n.scale.log=function(){return ay(n.scale.linear().domain([0,1]),10,!0,[1,10])};uc=n.format(".0e");hw={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};n.scale.pow=function(){return vy(n.scale.linear(),1,[0,1])};n.scale.sqrt=function(){return n.scale.pow().exponent(.5)};n.scale.ordinal=function(){return yy([],{t:"range",a:[[]]})};n.scale.category10=function(){return n.scale.ordinal().range(ait)};n.scale.category20=function(){return n.scale.ordinal().range(vit)};n.scale.category20b=function(){return n.scale.ordinal().range(yit)};n.scale.category20c=function(){return n.scale.ordinal().range(pit)};var ait=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(uu),vit=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(uu),yit=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(uu),pit=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(uu);n.scale.quantile=function(){return py([],[])};n.scale.quantize=function(){return wy(0,1,[0,1])};n.scale.threshold=function(){return by([.5],[0,1])};n.scale.identity=function(){return ky([0,1])};n.svg.arc=function(){function n(){var e=t.apply(this,arguments),n=i.apply(this,arguments),o=r.apply(this,arguments)+si,s=f.apply(this,arguments)+si,h=(o>s&&(h=o,o=s,s=h),s-o),c=u>h?"0":"1",l=Math.cos(o),a=Math.sin(o),v=Math.cos(s),y=Math.sin(s);return h>=cw?e?"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z":e?"M"+n*l+","+n*a+"A"+n+","+n+" 0 "+c+",1 "+n*v+","+n*y+"L"+e*v+","+e*y+"A"+e+","+e+" 0 "+c+",0 "+e*l+","+e*a+"Z":"M"+n*l+","+n*a+"A"+n+","+n+" 0 "+c+",1 "+n*v+","+n*y+"L0,0Z"}var t=hn,i=cn,r=dy,f=gy;return n.innerRadius=function(i){return arguments.length?(t=e(i),n):t},n.outerRadius=function(t){return arguments.length?(i=e(t),n):i},n.startAngle=function(t){return arguments.length?(r=e(t),n):r},n.endAngle=function(t){return arguments.length?(f=e(t),n):f},n.centroid=function(){var n=(t.apply(this,arguments)+i.apply(this,arguments))/2,u=(r.apply(this,arguments)+f.apply(this,arguments))/2+si;return[Math.cos(u)*n,Math.sin(u)*n]},n};si=-w;cw=nt-i;n.svg.line.radial=function(){var n=fv(np);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n};rs.reverse=us;us.reverse=rs;n.svg.area=function(){return tp(l)};n.svg.area.radial=function(){var n=tp(np);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n};n.svg.chord=function(){function n(n,u){var f=h(this,i,n,u),e=h(this,r,n,u);return"M"+f.p0+c(f.r,f.p1,f.a1-f.a0)+(l(f,e)?t(f.r,f.p1,f.r,f.p0):t(f.r,f.p1,e.r,e.p0)+c(e.r,e.p1,e.a1-e.a0)+t(e.r,e.p1,f.r,f.p0))+"Z"}function h(n,t,i,r){var e=t.call(n,i,r),u=f.call(n,e,r),h=o.call(n,e,r)+si,c=s.call(n,e,r)+si;return{r:u,a0:h,a1:c,p0:[u*Math.cos(h),u*Math.sin(h)],p1:[u*Math.cos(c),u*Math.sin(c)]}}function l(n,t){return n.a0==t.a0&&n.a1==t.a1}function c(n,t,i){return"A"+n+","+n+" 0 "+ +(i>u)+",1 "+t}function t(n,t,i,r){return"Q 0,0 "+r}var i=ns,r=ts,f=ln,o=dy,s=gy;return n.radius=function(t){return arguments.length?(f=e(t),n):f},n.source=function(t){return arguments.length?(i=e(t),n):i},n.target=function(t){return arguments.length?(r=e(t),n):r},n.startAngle=function(t){return arguments.length?(o=e(t),n):o},n.endAngle=function(t){return arguments.length?(s=e(t),n):s},n};n.svg.diagonal=function(){function n(n,u){var e=t.call(this,n,u),o=i.call(this,n,u),s=(e.y+o.y)/2,f=[e,{x:e.x,y:s},{x:o.x,y:s},o];return f=f.map(r),"M"+f[0]+"C"+f[1]+" "+f[2]+" "+f[3]}var t=ns,i=ts,r=ip;return n.source=function(i){return arguments.length?(t=e(i),n):t},n.target=function(t){return arguments.length?(i=e(t),n):i},n.projection=function(t){return arguments.length?(r=t,n):r},n};n.svg.diagonal.radial=function(){var t=n.svg.diagonal(),i=ip,r=t.projection;return t.projection=function(n){return arguments.length?r(an(i=n)):i},t};n.svg.symbol=function(){function n(n,r){return(fc.get(t.call(this,n,r))||rp)(i.call(this,n,r))}var t=yn,i=vn;return n.type=function(i){return arguments.length?(t=e(i),n):t},n.size=function(t){return arguments.length?(i=e(t),n):i},n};fc=n.map({circle:rp,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*lw)),i=t*lw;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/he),i=t*he/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/he),i=t*he/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});n.svg.symbolTypes=fc.keys();var ki,se,he=Math.sqrt(3),lw=Math.tan(30*r),c=[],aw=0;c.call=f.call;c.empty=f.empty;c.node=f.node;c.size=f.size;n.transition=function(n){return arguments.length?ki?n.transition():n:sh.transition()};n.transition.prototype=c;c.select=function(n){var f,i,t,e=this.id,o=[],r,s;for(n=be(n),r=-1,s=this.length;++r<s;){o.push(f=[]);for(var h=this[r],u=-1,c=h.length;++u<c;)(t=h[u])&&(i=n.call(t,t.__data__,u,r))?("__data__"in t&&(i.__data__=t.__data__),du(i,u,e,t.__transition__[e]),f.push(i)):f.push(null)}return yr(o,e)};c.selectAll=function(n){var s,u,t,f,h,e=this.id,c=[],i,l,r,v;for(n=bc(n),i=-1,l=this.length;++i<l;)for(var a=this[i],o=-1,y=a.length;++o<y;)if(t=a[o])for(h=t.__transition__[e],u=n.call(t,t.__data__,o,i),c.push(s=[]),r=-1,v=u.length;++r<v;)(f=u[r])&&du(f,r,e,h),s.push(f);return yr(c,e)};c.filter=function(n){var u,f,t,e=[],i,o;for("function"!=typeof n&&(n=ul(n)),i=0,o=this.length;o>i;i++){e.push(u=[]);for(var f=this[i],r=0,s=f.length;s>r;r++)(t=f[r])&&n.call(t,t.__data__,r)&&u.push(t)}return yr(e,this.id)};c.tween=function(n,t){var i=this.id;return arguments.length<2?this.node().__transition__[i].tween.get(n):dt(this,null==t?function(t){t.__transition__[i].tween.remove(n)}:function(r){r.__transition__[i].tween.set(n,t)})};c.attr=function(t,i){function f(){this.removeAttribute(r)}function e(){this.removeAttributeNS(r.space,r.local)}function o(n){return null==n?f:(n+="",function(){var t,i=this.getAttribute(r);return i!==n&&(t=u(i,n),function(n){this.setAttribute(r,t(n))})})}function s(n){return null==n?e:(n+="",function(){var t,i=this.getAttributeNS(r.space,r.local);return i!==n&&(t=u(i,n),function(n){this.setAttributeNS(r.space,r.local,t(n))})})}if(arguments.length<2){for(i in t)this.attr(i,t[i]);return this}var u="transform"==t?kv:ai,r=n.ns.qualify(t);return nh(this,"attr."+t,i,r.local?s:o)};c.attrTween=function(t,i){function u(n,t){var u=i.call(this,n,t,this.getAttribute(r));return u&&function(n){this.setAttribute(r,u(n))}}function f(n,t){var u=i.call(this,n,t,this.getAttributeNS(r.space,r.local));return u&&function(n){this.setAttributeNS(r.space,r.local,u(n))}}var r=n.ns.qualify(t);return this.tween("attr."+t,r.local?f:u)};c.style=function(n,t,i){function u(){this.style.removeProperty(n)}function f(t){return null==t?u:(t+="",function(){var r,u=a.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=ai(u,t),function(t){this.style.setProperty(n,r(t),i)})})}var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.style(i,n[i],t);return this}i=""}return nh(this,"style."+n,t,f)};c.styleTween=function(n,t,i){function r(r,u){var f=t.call(this,r,u,a.getComputedStyle(this,null).getPropertyValue(n));return f&&function(t){this.style.setProperty(n,f(t),i)}}return arguments.length<3&&(i=""),this.tween("style."+n,r)};c.text=function(n){return nh(this,"text",n,pn)};c.remove=function(){return this.each("end.transition",function(){var n;this.__transition__.count<2&&(n=this.parentNode)&&n.removeChild(this)})};c.ease=function(t){var i=this.id;return arguments.length<1?this.node().__transition__[i].ease:("function"!=typeof t&&(t=n.ease.apply(n,arguments)),dt(this,function(n){n.__transition__[i].ease=t}))};c.delay=function(n){var t=this.id;return dt(this,"function"==typeof n?function(i,r,u){i.__transition__[t].delay=+n.call(i,i.__data__,r,u)}:(n=+n,function(i){i.__transition__[t].delay=n}))};c.duration=function(n){var t=this.id;return dt(this,"function"==typeof n?function(i,r,u){i.__transition__[t].duration=Math.max(1,n.call(i,i.__data__,r,u))}:(n=Math.max(1,n),function(i){i.__transition__[t].duration=n}))};c.each=function(t,i){var r=this.id,u,f;return arguments.length<2?(u=se,f=ki,ki=r,dt(this,function(n,i,u){se=n.__transition__[r];t.call(n,n.__data__,i,u)}),se=u,ki=f):dt(this,function(u){var f=u.__transition__[r];(f.event||(f.event=n.dispatch("start","end"))).on(t,i)}),this};c.transition=function(){for(var u,f,n,t,s=this.id,e=++aw,o=[],r=0,h=this.length;h>r;r++){o.push(u=[]);for(var f=this[r],i=0,c=f.length;c>i;i++)(n=f[i])&&(t=Object.create(n.__transition__[s]),t.delay+=t.duration,du(n,i,e,t)),u.push(n)}return yr(o,e)};n.svg.axis=function(){function t(t){t.each(function(){var a,rt=n.select(this),et=this.__chart__||o,t=this.__chart__=o.copy(),ot=null==h?t.ticks?t.ticks.apply(t,s):t.domain():h,st=null==e?t.tickFormat?t.tickFormat.apply(t,s):l:e,p=rt.selectAll(".tick").data(ot,t),y=p.enter().insert("g",".domain").attr("class","tick").style("opacity",i),ht=n.transition(p.exit()).style("opacity",i).remove(),w=n.transition(p).style("opacity",1),v=bu(t),ut=rt.selectAll(".domain").data([0]),b=(ut.enter().append("path").attr("class","domain"),n.transition(ut)),ft,it;y.append("line");y.append("text");var k=y.select("line"),d=w.select("line"),g=p.select("text").text(st),nt=y.select("text"),tt=w.select("text");switch(c){case"bottom":a=up;k.attr("y2",r);nt.attr("y",Math.max(r,0)+f);d.attr("x2",0).attr("y2",r);tt.attr("x",0).attr("y",Math.max(r,0)+f);g.attr("dy",".71em").style("text-anchor","middle");b.attr("d","M"+v[0]+","+u+"V0H"+v[1]+"V"+u);break;case"top":a=up;k.attr("y2",-r);nt.attr("y",-(Math.max(r,0)+f));d.attr("x2",0).attr("y2",-r);tt.attr("x",0).attr("y",-(Math.max(r,0)+f));g.attr("dy","0em").style("text-anchor","middle");b.attr("d","M"+v[0]+","+-u+"V0H"+v[1]+"V"+-u);break;case"left":a=fp;k.attr("x2",-r);nt.attr("x",-(Math.max(r,0)+f));d.attr("x2",-r).attr("y2",0);tt.attr("x",-(Math.max(r,0)+f)).attr("y",0);g.attr("dy",".32em").style("text-anchor","end");b.attr("d","M"+-u+","+v[0]+"H0V"+v[1]+"H"+-u);break;case"right":a=fp;k.attr("x2",r);nt.attr("x",Math.max(r,0)+f);d.attr("x2",r).attr("y2",0);tt.attr("x",Math.max(r,0)+f).attr("y",0);g.attr("dy",".32em").style("text-anchor","start");b.attr("d","M"+u+","+v[0]+"H0V"+v[1]+"H"+u)}t.rangeBand?(ft=t.rangeBand()/2,it=function(n){return t(n)+ft},y.call(a,it),w.call(a,it)):(y.call(a,et),w.call(a,t),ht.call(a,t))})}var e,o=n.scale.linear(),c=ec,r=6,u=6,f=3,s=[10],h=null;return t.scale=function(n){return arguments.length?(o=n,t):o},t.orient=function(n){return arguments.length?(c=n in vw?n+"":ec,t):c},t.ticks=function(){return arguments.length?(s=arguments,t):s},t.tickValues=function(n){return arguments.length?(h=n,t):h},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(n){var i=arguments.length;return i?(r=+n,u=+arguments[i-1],t):r},t.innerTickSize=function(n){return arguments.length?(r=+n,t):r},t.outerTickSize=function(n){return arguments.length?(u=+n,t):u},t.tickPadding=function(n){return arguments.length?(f=+n,t):f},t.tickSubdivide=function(){return arguments.length&&t},t};ec="bottom";vw={top:1,right:1,bottom:1,left:1};n.svg.brush=function(){function f(t){t.each(function(){var i=n.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",b).on("touchstart.brush",b),h=i.selectAll(".background").data([0]),e,t,o,s;h.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");e=i.selectAll(".resize").data(v,l);e.exit().remove();e.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return wit[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");e.style("display",f.empty()?"none":null);o=n.transition(i);s=n.transition(h);r&&(t=bu(r),s.attr("x",t[0]).attr("width",t[1]-t[0]),p(o));u&&(t=bu(u),s.attr("y",t[0]).attr("height",t[1]-t[0]),w(o));y(o)})}function y(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+t[+/e$/.test(n)]+","+i[+/^s/.test(n)]+")"})}function p(n){n.select(".extent").attr("x",t[0]);n.selectAll(".extent,.n>rect,.s>rect").attr("width",t[1]-t[0])}function w(n){n.select(".extent").attr("y",i[0]);n.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function b(){function ht(){32==n.event.keyCode&&(b||(v=null,l[0]-=t[1],l[1]-=i[1],b=2),bt())}function ct(){32==n.event.keyCode&&2==b&&(l[0]+=t[1],l[1]+=i[1],b=0,bt())}function g(){var f=n.mouse(tt),e=!1;nt&&(f[0]+=nt[0],f[1]+=nt[1]);b||(n.event.altKey?(v||(v=[(t[0]+t[1])/2,(i[0]+i[1])/2]),l[0]=t[+(f[0]<v[0])],l[1]=i[+(f[1]<v[1])]):v=null);lt&&ot(f,r,0)&&(p(k),e=!0);at&&ot(f,u,1)&&(w(k),e=!0);e&&(y(k),rt({type:"brush",mode:b?"move":"resize"}))}function ot(n,r,u){var f,y,k=bu(r),p=k[0],w=k[1],c=l[u],a=u?i:t,d=a[1]-a[0];return b&&(p-=c,w-=d+c),f=(u?h:s)?Math.max(p,Math.min(w,n[u])):n[u],b?y=(f+=c)+d:(v&&(c=Math.max(p,Math.min(w,2*v[u]-f))),f>c?(y=f,f=c):y=c),a[0]!=f||a[1]!=y?(u?o=null:e=null,a[0]=f,a[1]=y,!0):void 0}function st(){g();k.style("pointer-events","all").selectAll(".resize").style("display",f.empty()?"none":null);n.select("body").style("cursor",null);ut.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);vt();rt({type:"brushend"})}var v,nt,tt=this,it=n.select(n.event.target),rt=c.of(tt,arguments),k=n.select(tt),d=it.datum(),lt=!/^(n|s)$/.test(d)&&r,at=!/^(e|w)$/.test(d)&&u,b=it.classed("extent"),vt=tu(),l=n.mouse(tt),ut=n.select(a).on("keydown.brush",ht).on("keyup.brush",ct),ft,et;(n.event.changedTouches?ut.on("touchmove.brush",g).on("touchend.brush",st):ut.on("mousemove.brush",g).on("mouseup.brush",st),k.interrupt().selectAll("*").interrupt(),b)?(l[0]=t[0]-l[0],l[1]=i[0]-l[1]):d?(ft=+/w$/.test(d),et=+/^n/.test(d),nt=[t[1-ft]-l[0],i[1-et]-l[1]],l[0]=t[ft],l[1]=i[et]):n.event.altKey&&(v=l.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null);n.select("body").style("cursor",it.style("cursor"));rt({type:"brushstart"});g()}var e,o,c=we(f,"brushstart","brush","brushend"),r=null,u=null,t=[0,0],i=[0,0],s=!0,h=!0,v=oc[0];return f.event=function(r){r.each(function(){var u=c.of(this,arguments),r={x:t,y:i,i:e,j:o},f=this.__chart__||r;this.__chart__=r;ki?n.select(this).transition().each("start.brush",function(){e=f.i;o=f.j;t=f.x;i=f.y;u({type:"brushstart"})}).tween("brush:brush",function(){var n=pu(t,r.x),f=pu(i,r.y);return e=o=null,function(e){t=r.x=n(e);i=r.y=f(e);u({type:"brush",mode:"resize"})}}).each("end.brush",function(){e=r.i;o=r.j;u({type:"brush",mode:"resize"});u({type:"brushend"})}):(u({type:"brushstart"}),u({type:"brush",mode:"resize"}),u({type:"brushend"}))})},f.x=function(n){return arguments.length?(r=n,v=oc[!r<<1|!u],f):r},f.y=function(n){return arguments.length?(u=n,v=oc[!r<<1|!u],f):u},f.clamp=function(n){return arguments.length?(r&&u?(s=!!n[0],h=!!n[1]):r?s=!!n:u&&(h=!!n),f):r&&u?[s,h]:r?s:u?h:null},f.extent=function(n){var s,h,c,l,a;return arguments.length?(r&&(s=n[0],h=n[1],u&&(s=s[0],h=h[0]),e=[s,h],r.invert&&(s=r(s),h=r(h)),s>h&&(a=s,s=h,h=a),(s!=t[0]||h!=t[1])&&(t=[s,h])),u&&(c=n[0],l=n[1],r&&(c=c[1],l=l[1]),o=[c,l],u.invert&&(c=u(c),l=u(l)),c>l&&(a=c,c=l,l=a),(c!=i[0]||l!=i[1])&&(i=[c,l])),f):(r&&(e?(s=e[0],h=e[1]):(s=t[0],h=t[1],r.invert&&(s=r.invert(s),h=r.invert(h)),s>h&&(a=s,s=h,h=a))),u&&(o?(c=o[0],l=o[1]):(c=i[0],l=i[1],u.invert&&(c=u.invert(c),l=u.invert(l)),c>l&&(a=c,c=l,l=a))),r&&u?[[s,c],[h,l]]:r?[s,h]:u&&[c,l])},f.clear=function(){return f.empty()||(t=[0,0],i=[0,0],e=o=null),f},f.empty=function(){return!!r&&t[0]==t[1]||!!u&&i[0]==i[1]},n.rebind(f,c,"on")};var wit={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},oc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],t=n.time={},v=Date;vt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){wt.setUTCDate.apply(this._,arguments)},setDay:function(){wt.setUTCDay.apply(this._,arguments)},setFullYear:function(){wt.setUTCFullYear.apply(this._,arguments)},setHours:function(){wt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){wt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){wt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){wt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){wt.setUTCSeconds.apply(this._,arguments)},setTime:function(){wt.setTime.apply(this._,arguments)}};var wt=Date.prototype,sc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],hc=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cc=["January","February","March","April","May","June","July","August","September","October","November","December"],lc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.year=vi(function(n){return n=t.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()});t.years=t.year.range;t.years.utc=t.year.utc.range;t.day=vi(function(n){var t=new v(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1});t.days=t.day.range;t.days.utc=t.day.utc.range;t.dayOfYear=function(n){var i=t.year(n);return Math.floor((n-i-6e4*(n.getTimezoneOffset()-i.getTimezoneOffset()))/864e5)};["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].forEach(function(n,i){n=n.toLowerCase();i=7-i;var r=t[n]=vi(function(n){return(n=t.day(n)).setDate(n.getDate()-(n.getDay()+i)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var r=t.year(n).getDay();return Math.floor((t.dayOfYear(n)+(r+i)%7)/7)-(r!==i)});t[n+"s"]=r.range;t[n+"s"].utc=r.utc.range;t[n+"OfYear"]=function(n){var r=t.year(n).getDay();return Math.floor((t.dayOfYear(n)+(r+i)%7)/7)}});t.week=t.sunday;t.weeks=t.sunday.range;t.weeks.utc=t.sunday.utc.range;t.weekOfYear=t.sundayOfYear;t.format=y;var yw=tf(sc),bit=rf(sc),pw=tf(hc),kit=rf(hc),ww=tf(cc),dit=rf(cc),bw=tf(lc),git=rf(lc),kw=/^%/,dw={"-":"",_:" ",0:"0"},ce={a:function(n){return hc[n.getDay()]},A:function(n){return sc[n.getDay()]},b:function(n){return lc[n.getMonth()]},B:function(n){return cc[n.getMonth()]},c:y("%a %b %e %X %Y"),d:function(n,t){return p(n.getDate(),t,2)},e:function(n,t){return p(n.getDate(),t,2)},H:function(n,t){return p(n.getHours(),t,2)},I:function(n,t){return p(n.getHours()%12||12,t,2)},j:function(n,i){return p(1+t.dayOfYear(n),i,3)},L:function(n,t){return p(n.getMilliseconds(),t,3)},m:function(n,t){return p(n.getMonth()+1,t,2)},M:function(n,t){return p(n.getMinutes(),t,2)},p:function(n){return n.getHours()>=12?"PM":"AM"},S:function(n,t){return p(n.getSeconds(),t,2)},U:function(n,i){return p(t.sundayOfYear(n),i,2)},w:function(n){return n.getDay()},W:function(n,i){return p(t.mondayOfYear(n),i,2)},x:y("%m/%d/%Y"),X:y("%H:%M:%S"),y:function(n,t){return p(n.getFullYear()%100,t,2)},Y:function(n,t){return p(n.getFullYear()%1e4,t,4)},Z:ptt,"%":function(){return"%"}},nrt={a:wn,A:bn,b:ntt,B:ttt,c:itt,d:ep,e:ep,H:op,I:op,j:ctt,L:vtt,m:htt,M:ltt,p:ytt,S:att,U:dn,w:kn,W:gn,x:rtt,X:utt,y:ett,Y:ftt,Z:ott,"%":wtt},s=/^\s*\d+/,trt=n.map({am:0,pm:1});y.utc=ft;ac=ft("%Y-%m-%dT%H:%M:%S.%LZ");y.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?th:ac;th.parse=function(n){var t=new Date(n);return isNaN(t)?null:t};th.toString=ac.toString;t.second=vi(function(n){return new v(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()});t.seconds=t.second.range;t.seconds.utc=t.second.utc.range;t.minute=vi(function(n){return new v(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()});t.minutes=t.minute.range;t.minutes.utc=t.minute.utc.range;t.hour=vi(function(n){var t=n.getTimezoneOffset()/60;return new v(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()});t.hours=t.hour.range;t.hours.utc=t.hour.utc.range;t.month=vi(function(n){return n=t.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()});t.months=t.month.range;t.months.utc=t.month.utc.range;var le=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],vc=[[t.second,1],[t.second,5],[t.second,15],[t.second,30],[t.minute,1],[t.minute,5],[t.minute,15],[t.minute,30],[t.hour,1],[t.hour,3],[t.hour,6],[t.hour,12],[t.day,1],[t.day,2],[t.week,1],[t.month,1],[t.month,3],[t.year,1]],irt=[[y("%Y"),sr],[y("%B"),function(n){return n.getMonth()}],[y("%b %d"),function(n){return 1!=n.getDate()}],[y("%a %d"),function(n){return n.getDay()&&1!=n.getDate()}],[y("%I %p"),function(n){return n.getHours()}],[y("%I:%M"),function(n){return n.getMinutes()}],[y(":%S"),function(n){return n.getSeconds()}],[y(".%L"),function(n){return n.getMilliseconds()}]],rrt=sp(irt);vc.year=t.year;t.scale=function(){return ih(n.scale.linear(),vc,rrt)};var urt={range:function(t,i,r){return n.range(+t,+i,r).map(yi)}},gw=vc.map(function(n){return[n[0].utc,n[1]]}),frt=[[ft("%Y"),sr],[ft("%B"),function(n){return n.getUTCMonth()}],[ft("%b %d"),function(n){return 1!=n.getUTCDate()}],[ft("%a %d"),function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],[ft("%I %p"),function(n){return n.getUTCHours()}],[ft("%I:%M"),function(n){return n.getUTCMinutes()}],[ft(":%S"),function(n){return n.getUTCSeconds()}],[ft(".%L"),function(n){return n.getUTCMilliseconds()}]],ert=sp(frt);return gw.year=t.year.utc,t.scale.utc=function(){return ih(n.scale.linear(),gw,ert)},n.text=so(function(n){return n.responseText}),n.json=function(n,t){return ho(n,"application/json",btt,t)},n.html=function(n,t){return ho(n,"text/html",ktt,t)},n.xml=so(function(n){return n.responseXML}),n}(),function(n,t){typeof define=="function"&&define.amd?define(["d3"],function(i){return n.Rickshaw=t(i)}):typeof exports=="object"?module.exports=t(require("d3")):n.Rickshaw=t(d3)}(this,function(n){var t={namespace:function(n){for(var r,f=n.split("."),i=t,u=1,e=f.length;u<e;u++)r=f[u],i[r]=i[r]||{},i=i[r];return i},keys:function(n){var t=[];for(var i in n)t.push(i);return t},extend:function(n,t){for(var i in t)n[i]=t[i];return n},clone:function(n){return JSON.parse(JSON.stringify(n))}};return function(n){function u(n){return o.call(n)===v}function y(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function p(n){var t,i;if(w(n)!==r)throw new TypeError;t=[];for(i in n)n.hasOwnProperty(i)&&t.push(i);return t}function w(n){switch(n){case null:return s;case void 0:return h}var t=typeof n;switch(t){case"boolean":return c;case"number":return l;case"string":return a}return r}function b(n){return typeof n=="undefined"}function k(n){var t=n.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return t.length==1&&!t[0]?[]:t}function d(n,i){var r=n;return function(){var n=e([t(r,this)],arguments);return i.apply(this,n)}}function e(n,t){for(var r=n.length,i=t.length;i--;)n[r+i]=t[i];return n}function g(n,t){return n=f.call(n,0),e(n,t)}function t(n,t){if(arguments.length<2&&b(arguments[0]))return this;var i=n,r=f.call(arguments,2);return function(){var n=g(r,arguments);return i.apply(t,n)}}var o=Object.prototype.toString,s="Null",h="Undefined",c="Boolean",l="Number",a="String",r="Object",v="[object Function]",f=Array.prototype.slice,nt=function(){},i=function(){function n(){}function f(){function t(){this.initialize.apply(this,arguments)}var r=null,f=[].slice.apply(arguments),e,o;if(u(f[0])&&(r=f.shift()),y(t,i.Methods),t.superclass=r,t.subclasses=[],r){n.prototype=r.prototype;t.prototype=new n;try{r.subclasses.push(t)}catch(s){}}for(e=0,o=f.length;e<o;e++)t.addMethods(f[e]);return t.prototype.initialize||(t.prototype.initialize=nt),t.prototype.constructor=t,t}function e(n){var h=this.superclass&&this.superclass.prototype,e=p(n),o,c,s,i,f;for(r&&(n.toString!=Object.prototype.toString&&e.push("toString"),n.valueOf!=Object.prototype.valueOf&&e.push("valueOf")),o=0,c=e.length;o<c;o++)s=e[o],i=n[s],h&&u(i)&&k(i)[0]=="$super"&&(f=i,i=d(function(n){return function(){return h[n].apply(this,arguments)}}(s),f),i.valueOf=t(f.valueOf,f),i.toString=t(f.toString,f)),this.prototype[s]=i;return this}var r=function(){for(var n in{toString:1})if(n==="toString")return!1;return!0}();return{create:f,Methods:{addMethods:e}}}();n.exports?n.exports.Class=i:n.Class=i}(t),t.namespace("Rickshaw.Compat.ClassList"),t.Compat.ClassList=function(){typeof document=="undefined"||"classList"in document.createElement("a")||function(n){"use strict";var e="classList",t="prototype",o=(n.HTMLElement||n.Element)[t],r=Object,l=String[t].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[t].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1},s=function(n,t){this.name=n;this.code=DOMException[n];this.message=t},u=function(n,t){if(t==="")throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(n,t)},h=function(n){for(var i=l.call(n.className),r=i?i.split(/\s+/):[],t=0,u=r.length;t<u;t++)this.push(r[t]);this._updateClassName=function(){n.className=this.toString()}},i=h[t]=[],c=function(){return new h(this)},f;if(s[t]=Error[t],i.item=function(n){return this[n]||null},i.contains=function(n){return n+="",u(this,n)!==-1},i.add=function(n){n+="";u(this,n)===-1&&(this.push(n),this._updateClassName())},i.remove=function(n){n+="";var t=u(this,n);t!==-1&&(this.splice(t,1),this._updateClassName())},i.toggle=function(n){n+="";u(this,n)===-1?this.add(n):this.remove(n)},i.toString=function(){return this.join(" ")},r.defineProperty){f={get:c,enumerable:!0,configurable:!0};try{r.defineProperty(o,e,f)}catch(v){v.number===-2146823252&&(f.enumerable=!1,r.defineProperty(o,e,f))}}else r[t].__defineGetter__&&o.__defineGetter__(e,c)}(window)},(typeof RICKSHAW_NO_COMPAT=="undefined"||RICKSHAW_NO_COMPAT)&&typeof RICKSHAW_NO_COMPAT!="undefined"||new t.Compat.ClassList,t.namespace("Rickshaw.Graph"),t.Graph=function(i){var r=this;this.initialize=function(t){if(!t.element)throw"Rickshaw.Graph needs a reference to an element";if(t.element.nodeType!==1)throw"Rickshaw.Graph element was defined but not an HTML element";this.element=t.element;this.series=t.series;this.window={};this.updateCallbacks=[];this.configureCallbacks=[];this.defaults={interpolation:"cardinal",offset:"zero",min:undefined,max:undefined,preserve:!1,xScale:undefined,yScale:undefined,stack:!0};this._loadRenderers();this.configure(t);this.validateSeries(t.series);this.series.active=function(){return r.series.filter(function(n){return!n.disabled})};this.setSize({width:t.width,height:t.height});this.element.classList.add("rickshaw_graph");this.vis=n.select(this.element).append("svg:svg").attr("width",this.width).attr("height",this.height);this.discoverRange()};this._loadRenderers=function(){var i,n;for(i in t.Graph.Renderer)i&&t.Graph.Renderer.hasOwnProperty(i)&&(n=t.Graph.Renderer[i],n&&n.prototype&&n.prototype.render)&&r.registerRenderer(new n({graph:r}))};this.validateSeries=function(n){var i;if(!Array.isArray(n)&&!(n instanceof t.Series)){i=Object.prototype.toString.apply(n);throw"series is not an array: "+i;}n.forEach(function(n){if(!(n instanceof Object))throw"series element is not an object: "+n;if(!n.data)throw"series has no data: "+JSON.stringify(n);if(!Array.isArray(n.data))throw"series data is not an array: "+JSON.stringify(n.data);if(n.data.length>0){var i=n.data[0].x,t=n.data[0].y;if(typeof i!="number"||typeof t!="number"&&t!==null)throw"x and y properties of points should be numbers instead of "+typeof i+" and "+typeof t;}if(n.data.length>=3&&(n.data[2].x<n.data[1].x||n.data[1].x<n.data[0].x||n.data[n.data.length-1].x<n.data[0].x))throw"series data needs to be sorted on x values for series name: "+n.name;},this)};this.dataDomain=function(){var t=this.series.map(function(n){return n.data}),i=n.min(t.map(function(n){return n[0].x})),r=n.max(t.map(function(n){return n[n.length-1].x}));return[i,r]};this.discoverRange=function(){var t=this.renderer.domain();this.x=(this.xScale||n.scale.linear()).copy().domain(t.x).range([0,this.width]);this.y=(this.yScale||n.scale.linear()).copy().domain(t.y).range([this.height,0]);this.x.magnitude=n.scale.linear().domain([t.x[0]-t.x[0],t.x[1]-t.x[0]]).range([0,this.width]);this.y.magnitude=n.scale.linear().domain([t.y[0]-t.y[0],t.y[1]-t.y[0]]).range([0,this.height])};this.render=function(){var n=this.stackData();this.discoverRange();this.renderer.render();this.updateCallbacks.forEach(function(n){n()})};this.update=this.render;this.stackData=function(){var i=this.series.active().map(function(n){return n.data}).map(function(n){return n.filter(function(n){return this._slice(n)},this)},this),f=this.preserve,u,e,o;return f||this.series.forEach(function(n){n.scale&&(f=!0)}),i=f?t.clone(i):i,this.series.active().forEach(function(n,t){if(n.scale){var r=i[t];r&&r.forEach(function(t){t.y=n.scale(t.y)})}}),this.stackData.hooks.data.forEach(function(n){i=n.f.apply(r,[i])}),this.renderer.unstack||(this._validateStackable(),e=n.layout.stack(),e.offset(r.offset),u=e(i)),u=u||i,this.renderer.unstack&&u.forEach(function(n){n.forEach(function(n){n.y0=n.y0===undefined?0:n.y0})}),this.stackData.hooks.after.forEach(function(n){u=n.f.apply(r,[i])}),o=0,this.series.forEach(function(n){n.disabled||(n.stack=u[o++])}),this.stackedData=u,u};this._validateStackable=function(){var t=this.series,n;t.forEach(function(t){if(n=n||t.data.length,n&&t.data.length!=n)throw"stacked series cannot have differing numbers of points: "+n+" vs "+t.data.length+"; see Rickshaw.Series.fill()";},this)};this.stackData.hooks={data:[],after:[]};this._slice=function(n){if(this.window.xMin||this.window.xMax){var t=!0;return this.window.xMin&&n.x<this.window.xMin&&(t=!1),this.window.xMax&&n.x>this.window.xMax&&(t=!1),t}return!0};this.onUpdate=function(n){this.updateCallbacks.push(n)};this.onConfigure=function(n){this.configureCallbacks.push(n)};this.registerRenderer=function(n){this._renderers=this._renderers||{};this._renderers[n.name]=n};this.configure=function(n){this.config=this.config||{};(n.width||n.height)&&this.setSize(n);t.keys(this.defaults).forEach(function(t){this.config[t]=t in n?n[t]:t in this?this[t]:this.defaults[t]},this);t.keys(this.config).forEach(function(n){this[n]=this.config[n]},this);"stack"in n&&(n.unstack=!n.stack);var i=n.renderer||this.renderer&&this.renderer.name||"stack";this.setRenderer(i,n);this.configureCallbacks.forEach(function(t){t(n)})};this.setRenderer=function(n,t){if(typeof n=="function")this.renderer=new n({graph:r}),this.registerRenderer(this.renderer);else{if(!this._renderers[n])throw"couldn't find renderer "+n;this.renderer=this._renderers[n]}typeof t=="object"&&this.renderer.configure(t)};this.setSize=function(n){if(n=n||{},typeof window!==undefined)var t=window.getComputedStyle(this.element,null),i=parseInt(t.getPropertyValue("width"),10),r=parseInt(t.getPropertyValue("height"),10);this.width=n.width||i||400;this.height=n.height||r||250;this.vis&&this.vis.attr("width",this.width).attr("height",this.height)};this.initialize(i)},t.namespace("Rickshaw.Fixtures.Color"),t.Fixtures.Color=function(){this.schemes={};this.schemes.spectrum14=["#ecb796","#dc8f70","#b2a470","#92875a","#716c49","#d2ed82","#bbe468","#a1d05d","#e7cbe6","#d8aad6","#a888c2","#9dc2d3","#649eb9","#387aa3"].reverse();this.schemes.spectrum2000=["#57306f","#514c76","#646583","#738394","#6b9c7d","#84b665","#a7ca50","#bfe746","#e2f528","#fff726","#ecdd00","#d4b11d","#de8800","#de4800","#c91515","#9a0000","#7b0429","#580839","#31082b"];this.schemes.spectrum2001=["#2f243f","#3c2c55","#4a3768","#565270","#6b6b7c","#72957f","#86ad6e","#a1bc5e","#b8d954","#d3e04e","#ccad2a","#cc8412","#c1521d","#ad3821","#8a1010","#681717","#531e1e","#3d1818","#320a1b"];this.schemes.classic9=["#423d4f","#4a6860","#848f39","#a2b73c","#ddcb53","#c5a32f","#7d5836","#963b20","#7c2626","#491d37","#2f254a"].reverse();this.schemes.httpStatus={503:"#ea5029",502:"#d23f14",500:"#bf3613",410:"#efacea",409:"#e291dc",403:"#f457e8",408:"#e121d2",401:"#b92dae",405:"#f47ceb",404:"#a82a9f",400:"#b263c6",301:"#6fa024",302:"#87c32b",307:"#a0d84c",304:"#28b55c",200:"#1a4f74",206:"#27839f",201:"#52adc9",202:"#7c979f",203:"#a5b8bd",204:"#c1cdd1"};this.schemes.colorwheel=["#b5b6a9","#858772","#785f43","#96557e","#4682b4","#65b9ac","#73c03a","#cb513a"].reverse();this.schemes.cool=["#5e9d2f","#73c03a","#4682b4","#7bc3b8","#a9884e","#c1b266","#a47493","#c09fb5"];this.schemes.munin=["#00cc00","#0066b3","#ff8000","#ffcc00","#330099","#990099","#ccff00","#ff0000","#808080","#008f00","#00487d","#b35a00","#b38f00","#6b006b","#8fb300","#b30000","#bebebe","#80ff80","#80c9ff","#ffc080","#ffe680","#aa80ff","#ee00cc","#ff8080","#666600","#ffbfff","#00ffcc","#cc6699","#999900"]},t.namespace("Rickshaw.Fixtures.RandomData"),t.Fixtures.RandomData=function(n){var t,i;n=n||1;t=200;i=Math.floor((new Date).getTime()/1e3);this.addData=function(r){var f=Math.random()*100+15+t,u=r[0].length,e=1;r.forEach(function(t){var r=Math.random()*20,o=f/25+e+++(Math.cos(u*e*11/960)+2)*15+(Math.cos(u/7)+2)*7+(Math.cos(u/17)+2)*1;t.push({x:u*n+i,y:o+r})});t=f*.85};this.removeData=function(t){t.forEach(function(n){n.shift()});i+=n}},t.namespace("Rickshaw.Fixtures.Time"),t.Fixtures.Time=function(){var t=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.units=[{name:"decade",seconds:86400*365.25*10,formatter:function(n){return parseInt(n.getUTCFullYear()/10,10)*10}},{name:"year",seconds:86400*365.25,formatter:function(n){return n.getUTCFullYear()}},{name:"month",seconds:86400*30.5,formatter:function(n){return t.months[n.getUTCMonth()]}},{name:"week",seconds:604800,formatter:function(n){return t.formatDate(n)}},{name:"day",seconds:86400,formatter:function(n){return n.getUTCDate()}},{name:"6 hour",seconds:21600,formatter:function(n){return t.formatTime(n)}},{name:"hour",seconds:3600,formatter:function(n){return t.formatTime(n)}},{name:"15 minute",seconds:900,formatter:function(n){return t.formatTime(n)}},{name:"minute",seconds:60,formatter:function(n){return n.getUTCMinutes()}},{name:"15 second",seconds:15,formatter:function(n){return n.getUTCSeconds()+"s"}},{name:"second",seconds:1,formatter:function(n){return n.getUTCSeconds()+"s"}},{name:"decisecond",seconds:1/10,formatter:function(n){return n.getUTCMilliseconds()+"ms"}},{name:"centisecond",seconds:1/100,formatter:function(n){return n.getUTCMilliseconds()+"ms"}}];this.unit=function(n){return this.units.filter(function(t){return n==t.name}).shift()};this.formatDate=function(t){return n.time.format("%b %e")(t)};this.formatTime=function(n){return n.toUTCString().match(/(\d+:\d+):/)[1]};this.ceil=function(n,t){var i,f,r,u;return t.name=="month"?(i=new Date(n*1e3),f=Date.UTC(i.getUTCFullYear(),i.getUTCMonth())/1e3,f==n)?n:(r=i.getUTCFullYear(),u=i.getUTCMonth(),u==11?(u=0,r=r+1):u+=1,Date.UTC(r,u)/1e3):t.name=="year"?(i=new Date(n*1e3),f=Date.UTC(i.getUTCFullYear(),0)/1e3,f==n)?n:(r=i.getUTCFullYear()+1,Date.UTC(r,0)/1e3):Math.ceil(n/t.seconds)*t.seconds}},t.namespace("Rickshaw.Fixtures.Time.Local"),t.Fixtures.Time.Local=function(){var t=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.units=[{name:"decade",seconds:86400*365.25*10,formatter:function(n){return parseInt(n.getFullYear()/10,10)*10}},{name:"year",seconds:86400*365.25,formatter:function(n){return n.getFullYear()}},{name:"month",seconds:86400*30.5,formatter:function(n){return t.months[n.getMonth()]}},{name:"week",seconds:604800,formatter:function(n){return t.formatDate(n)}},{name:"day",seconds:86400,formatter:function(n){return n.getDate()}},{name:"6 hour",seconds:21600,formatter:function(n){return t.formatTime(n)}},{name:"hour",seconds:3600,formatter:function(n){return t.formatTime(n)}},{name:"15 minute",seconds:900,formatter:function(n){return t.formatTime(n)}},{name:"minute",seconds:60,formatter:function(n){return n.getMinutes()}},{name:"15 second",seconds:15,formatter:function(n){return n.getSeconds()+"s"}},{name:"second",seconds:1,formatter:function(n){return n.getSeconds()+"s"}},{name:"decisecond",seconds:1/10,formatter:function(n){return n.getMilliseconds()+"ms"}},{name:"centisecond",seconds:1/100,formatter:function(n){return n.getMilliseconds()+"ms"}}];this.unit=function(n){return this.units.filter(function(t){return n==t.name}).shift()};this.formatDate=function(t){return n.time.format("%b %e")(t)};this.formatTime=function(n){return n.toString().match(/(\d+:\d+):/)[1]};this.ceil=function(n,t){var r,e,u,o,i,f;return t.name=="day"?(o=new Date((n+t.seconds-1)*1e3),i=new Date(0),i.setMilliseconds(0),i.setSeconds(0),i.setMinutes(0),i.setHours(0),i.setDate(o.getDate()),i.setMonth(o.getMonth()),i.setFullYear(o.getFullYear()),i.getTime()/1e3):t.name=="month"?(r=new Date(n*1e3),e=new Date(r.getFullYear(),r.getMonth()).getTime()/1e3,e==n)?n:(u=r.getFullYear(),f=r.getMonth(),f==11?(f=0,u=u+1):f+=1,new Date(u,f).getTime()/1e3):t.name=="year"?(r=new Date(n*1e3),e=new Date(r.getUTCFullYear(),0).getTime()/1e3,e==n)?n:(u=r.getFullYear()+1,new Date(u,0).getTime()/1e3):Math.ceil(n/t.seconds)*t.seconds}},t.namespace("Rickshaw.Fixtures.Number"),t.Fixtures.Number.formatKMBT=function(n){var t=Math.abs(n);return t>=1e12?n/1e12+"T":t>=1e9?n/1e9+"B":t>=1e6?n/1e6+"M":t>=1e3?n/1e3+"K":t<1&&n>0?n.toFixed(2):t===0?"":n},t.Fixtures.Number.formatBase1024KMGTP=function(n){var t=Math.abs(n);return t>=0x4000000000000?n/0x4000000000000+"P":t>=1099511627776?n/1099511627776+"T":t>=1073741824?n/1073741824+"G":t>=1048576?n/1048576+"M":t>=1024?n/1024+"K":t<1&&n>0?n.toFixed(2):t===0?"":n},t.namespace("Rickshaw.Color.Palette"),t.Color.Palette=function(i){var e=new t.Fixtures.Color,o,r,f,u,s;if(i=i||{},this.schemes={},this.scheme=e.schemes[i.scheme]||i.scheme||e.schemes.colorwheel,this.runningIndex=0,this.generatorIndex=0,i.interpolatedStopCount){for(o=this.scheme.length-1,u=[],r=0;r<o;r++)for(u.push(this.scheme[r]),s=n.interpolateHsl(this.scheme[r],this.scheme[r+1]),f=1;f<i.interpolatedStopCount;f++)u.push(s(1/i.interpolatedStopCount*f));u.push(this.scheme[this.scheme.length-1]);this.scheme=u}this.rotateCount=this.scheme.length;this.color=function(n){return this.scheme[n]||this.scheme[this.runningIndex++]||this.interpolateColor()||"#808080"};this.interpolateColor=function(){if(Array.isArray(this.scheme)){var t;return this.generatorIndex==this.rotateCount*2-1?(t=n.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[0])(.5),this.generatorIndex=0,this.rotateCount*=2):(t=n.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[this.generatorIndex+1])(.5),this.generatorIndex++),this.scheme.push(t),t}}},t.namespace("Rickshaw.Graph.Ajax"),t.Graph.Ajax=t.Class.create({initialize:function(n){this.dataURL=n.dataURL;this.onData=n.onData||function(n){return n};this.onComplete=n.onComplete||function(){};this.onError=n.onError||function(){};this.args=n;this.request()},request:function(){jQuery.ajax({url:this.dataURL,dataType:"json",success:this.success.bind(this),error:this.error.bind(this)})},error:function(){console.log("error loading dataURL: "+this.dataURL);this.onError(this)},success:function(n){n=this.onData(n);this.args.series=this._splice({data:n,series:this.args.series});this.graph=this.graph||new t.Graph(this.args);this.graph.render();this.onComplete(this)},_splice:function(n){var t=n.data,i=n.series;return n.series?(i.forEach(function(n){var i=n.key||n.name;if(!i)throw"series needs a key or a name";t.forEach(function(t){var r=t.key||t.name,u;if(!r)throw"data needs a key or a name";i==r&&(u=["color","name","data"],u.forEach(function(i){t[i]&&(n[i]=t[i])}))})}),i):t}}),t.namespace("Rickshaw.Graph.Annotate"),t.Graph.Annotate=function(n){var r=this.graph=n.graph,i;this.elements={intimeline:n.element};i=this;this.data={};this.elements.intimeline.classList.add("rickshaw_annotation_intimeline");this.add=function(n,t,r){i.data[n]=i.data[n]||{boxes:[]};i.data[n].boxes.push({content:t,end:r})};this.update=function(){t.keys(i.data).forEach(function(n){var t=i.data[n],r=i.graph.x(n),u;if(r<0||r>i.graph.x.range()[1]){t.element&&(t.line.classList.add("offscreen"),t.element.style.display="none");t.boxes.forEach(function(n){n.rangeElement&&n.rangeElement.classList.add("offscreen")});return}t.element||(u=t.element=document.createElement("div"),u.classList.add("annotation"),this.elements.intimeline.appendChild(u),u.addEventListener("click",function(){u.classList.toggle("active");t.line.classList.toggle("active");t.boxes.forEach(function(n){n.rangeElement&&n.rangeElement.classList.toggle("active")})},!1));t.element.style.left=r+"px";t.element.style.display="block";t.boxes.forEach(function(n){var u=n.element,f,e,o;u||(u=n.element=document.createElement("div"),u.classList.add("content"),u.innerHTML=n.content,t.element.appendChild(u),t.line=document.createElement("div"),t.line.classList.add("annotation_line"),i.graph.element.appendChild(t.line),n.end&&(n.rangeElement=document.createElement("div"),n.rangeElement.classList.add("annotation_range"),i.graph.element.appendChild(n.rangeElement)));n.end&&(f=r,e=Math.min(i.graph.x(n.end),i.graph.x.range()[1]),f>e&&(e=r,f=Math.max(i.graph.x(n.end),i.graph.x.range()[0])),o=e-f,n.rangeElement.style.left=f+"px",n.rangeElement.style.width=o+"px",n.rangeElement.classList.remove("offscreen"));t.line.classList.remove("offscreen");t.line.style.left=r+"px"})},this)};this.graph.onUpdate(function(){i.update()})},t.namespace("Rickshaw.Graph.Axis.Time"),t.Graph.Axis.Time=function(n){var i=this,r;this.graph=n.graph;this.elements=[];this.ticksTreatment=n.ticksTreatment||"plain";this.fixedTimeUnit=n.timeUnit;r=n.timeFixture||new t.Fixtures.Time;this.appropriateTimeUnit=function(){var n,i=r.units,t=this.graph.x.domain(),u=t[1]-t[0];return i.forEach(function(t){Math.floor(u/t.seconds)>=2&&(n=n||t)}),n||r.units[r.units.length-1]};this.tickOffsets=function(){for(var i,t=this.graph.x.domain(),n=this.fixedTimeUnit||this.appropriateTimeUnit(),o=Math.ceil((t[1]-t[0])/n.seconds),u=t[0],f=[],e=0;e<o;e++)i=r.ceil(u,n),u=i+n.seconds/2,f.push({value:i,unit:n});return f};this.render=function(){this.elements.forEach(function(n){n.parentNode.removeChild(n)});this.elements=[];var n=this.tickOffsets();n.forEach(function(n){var t,r;i.graph.x(n.value)>i.graph.x.range()[1]||(t=document.createElement("div"),t.style.left=i.graph.x(n.value)+"px",t.classList.add("x_tick"),t.classList.add(i.ticksTreatment),r=document.createElement("div"),r.classList.add("title"),r.innerHTML=n.unit.formatter(new Date(n.value*1e3)),t.appendChild(r),i.graph.element.appendChild(t),i.elements.push(t))})};this.graph.onUpdate(function(){i.render()})},t.namespace("Rickshaw.Graph.Axis.X"),t.Graph.Axis.X=function(t){var r=this,i=.1;this.initialize=function(t){this.graph=t.graph;this.orientation=t.orientation||"top";this.pixelsPerTick=t.pixelsPerTick||75;t.ticks&&(this.staticTicks=t.ticks);t.tickValues&&(this.tickValues=t.tickValues);this.tickSize=t.tickSize||4;this.ticksTreatment=t.ticksTreatment||"plain";t.element?(this.element=t.element,this._discoverSize(t.element,t),this.vis=n.select(t.element).append("svg:svg").attr("height",this.height).attr("width",this.width).attr("class","rickshaw_graph x_axis_d3"),this.element=this.vis[0][0],this.element.style.position="relative",this.setSize({width:t.width,height:t.height})):this.vis=this.graph.vis;this.graph.onUpdate(function(){r.render()})};this.setSize=function(n){if(n=n||{},this.element){this._discoverSize(this.element.parentNode,n);this.vis.attr("height",this.height).attr("width",this.width*(1+i));var t=Math.floor(this.width*i/2);this.element.style.left=-1*t+"px"}};this.render=function(){var r,u,f,e,o;this._renderWidth!==undefined&&this.graph.width!==this._renderWidth&&this.setSize({auto:!0});r=n.svg.axis().scale(this.graph.x).orient(this.orientation);r.tickFormat(t.tickFormat||function(n){return n});this.tickValues&&r.tickValues(this.tickValues);this.ticks=this.staticTicks||Math.floor(this.graph.width/this.pixelsPerTick);u=Math.floor(this.width*i/2)||0;this.orientation=="top"?(e=this.height||this.graph.height,f="translate("+u+","+e+")"):f="translate("+u+", 0)";this.element&&this.vis.selectAll("*").remove();this.vis.append("svg:g").attr("class",["x_ticks_d3",this.ticksTreatment].join(" ")).attr("transform",f).call(r.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));o=(this.orientation=="bottom"?1:-1)*this.graph.height;this.graph.vis.append("svg:g").attr("class","x_grid_d3").call(r.ticks(this.ticks).tickSubdivide(0).tickSize(o)).selectAll("text").each(function(){this.parentNode.setAttribute("data-x-value",this.textContent)});this._renderHeight=this.graph.height};this._discoverSize=function(n,t){var r,u,f;typeof window!="undefined"&&(r=window.getComputedStyle(n,null),u=parseInt(r.getPropertyValue("height"),10),t.auto||(f=parseInt(r.getPropertyValue("width"),10)));this.width=(t.width||f||this.graph.width)*(1+i);this.height=t.height||u||40};this.initialize(t)},t.namespace("Rickshaw.Graph.Axis.Y"),t.Graph.Axis.Y=t.Class.create({initialize:function(t){this.graph=t.graph;this.orientation=t.orientation||"right";this.pixelsPerTick=t.pixelsPerTick||75;t.ticks&&(this.staticTicks=t.ticks);t.tickValues&&(this.tickValues=t.tickValues);this.tickSize=t.tickSize||4;this.ticksTreatment=t.ticksTreatment||"plain";this.tickFormat=t.tickFormat||function(n){return n};this.berthRate=.1;t.element?(this.element=t.element,this.vis=n.select(t.element).append("svg:svg").attr("class","rickshaw_graph y_axis"),this.element=this.vis[0][0],this.element.style.position="relative",this.setSize({width:t.width,height:t.height})):this.vis=this.graph.vis;var i=this;this.graph.onUpdate(function(){i.render()})},setSize:function(n){var t,i,r,u;(n=n||{},this.element)&&(typeof window!="undefined"&&(t=window.getComputedStyle(this.element.parentNode,null),i=parseInt(t.getPropertyValue("width"),10),n.auto||(r=parseInt(t.getPropertyValue("height"),10))),this.width=n.width||i||this.graph.width*this.berthRate,this.height=n.height||r||this.graph.height,this.vis.attr("width",this.width).attr("height",this.height*(1+this.berthRate)),u=this.height*this.berthRate,this.orientation=="left"&&(this.element.style.top=-1*u+"px"))},render:function(){this._renderHeight!==undefined&&this.graph.height!==this._renderHeight&&this.setSize({auto:!0});this.ticks=this.staticTicks||Math.floor(this.graph.height/this.pixelsPerTick);var n=this._drawAxis(this.graph.y);this._drawGrid(n);this._renderHeight=this.graph.height},_drawAxis:function(t){var i=n.svg.axis().scale(t).orient(this.orientation),r,u;return i.tickFormat(this.tickFormat),this.tickValues&&i.tickValues(this.tickValues),this.orientation=="left"&&(r=this.height*this.berthRate,u="translate("+this.width+", "+r+")"),this.element&&this.vis.selectAll("*").remove(),this.vis.append("svg:g").attr("class",["y_ticks",this.ticksTreatment].join(" ")).attr("transform",u).call(i.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize)),i},_drawGrid:function(n){var t=(this.orientation=="right"?1:-1)*this.graph.width;this.graph.vis.append("svg:g").attr("class","y_grid").call(n.ticks(this.ticks).tickSubdivide(0).tickSize(t)).selectAll("text").each(function(){this.parentNode.setAttribute("data-y-value",this.textContent)})}}),t.namespace("Rickshaw.Graph.Axis.Y.Scaled"),t.Graph.Axis.Y.Scaled=t.Class.create(t.Graph.Axis.Y,{initialize:function($super,n){if(typeof n.scale=="undefined")throw new Error("Scaled requires scale");this.scale=n.scale;this.grid=typeof n.grid=="undefined"?!0:n.grid;$super(n)},_drawAxis:function($super,t){var i=this.scale.domain(),r=this.graph.renderer.domain().y,u=[Math.min.apply(Math,i),Math.max.apply(Math,i)],f=n.scale.linear().domain([0,1]).range(u),e=[f(r[0]),f(r[1])],o=n.scale.linear().domain(u).range(e),s=this.scale.copy().domain(i.map(o)).range(t.range());return $super(s)},_drawGrid:function($super,n){this.grid&&$super(n)}}),t.namespace("Rickshaw.Graph.Behavior.Series.Highlight"),t.Graph.Behavior.Series.Highlight=function(t){this.graph=t.graph;this.legend=t.legend;var i=this,r={},u=null,f=t.disabledColor||function(t){return n.interpolateRgb(t,n.rgb("#d8d8d8"))(.8).toString()};this.addHighlightEvents=function(n){n.element.addEventListener("mouseover",function(){u||(u=n,i.legend.lines.forEach(function(t){var u,e;if(n===t){i.graph.renderer.unstack&&(t.series.renderer?t.series.renderer.unstack:!0)&&(u=i.graph.series.indexOf(t.series),t.originalIndex=u,e=i.graph.series.splice(u,1)[0],i.graph.series.push(e));return}r[t.series.name]=r[t.series.name]||t.series.color;t.series.color=f(t.series.color)}),i.graph.update())},!1);n.element.addEventListener("mouseout",function(){if(u)u=null;else return;i.legend.lines.forEach(function(t){if(n===t&&t.hasOwnProperty("originalIndex")){var u=i.graph.series.pop();i.graph.series.splice(t.originalIndex,0,u);delete t.originalIndex}r[t.series.name]&&(t.series.color=r[t.series.name])});i.graph.update()},!1)};this.legend&&this.legend.lines.forEach(function(n){i.addHighlightEvents(n)})},t.namespace("Rickshaw.Graph.Behavior.Series.Order"),t.Graph.Behavior.Series.Order=function(n){this.graph=n.graph;this.legend=n.legend;var t=this;if(typeof jQuery=="undefined")throw"couldn't find jQuery at window.jQuery";if(typeof window.jQuery.ui=="undefined")throw"couldn't find jQuery UI at window.jQuery.ui";jQuery(function(){jQuery(t.legend.list).sortable({containment:"parent",tolerance:"pointer",update:function(){var i=[],n;for(jQuery(t.legend.list).find("li").each(function(n,t){t.series&&i.push(t.series)}),n=t.graph.series.length-1;n>=0;n--)t.graph.series[n]=i.shift();t.graph.update()}});jQuery(t.legend.list).disableSelection()});this.graph.onUpdate(function(){var n=window.getComputedStyle(t.legend.element).height;t.legend.element.style.height=n})},t.namespace("Rickshaw.Graph.Behavior.Series.Toggle"),t.Graph.Behavior.Series.Toggle=function(n){var t,i;this.graph=n.graph;this.legend=n.legend;t=this;this.addAnchor=function(n){var i=document.createElement("a"),r;i.innerHTML="&#10004;";i.classList.add("action");n.element.insertBefore(i,n.element.firstChild);i.onclick=function(){if(n.series.disabled)n.series.enable(),n.element.classList.remove("disabled");else{if(this.graph.series.filter(function(n){return!n.disabled}).length<=1)return;n.series.disable();n.element.classList.add("disabled")}}.bind(this);r=n.element.getElementsByTagName("span")[0];r.onclick=function(){var r=n.series.disabled,i,u;if(!r)for(i=0;i<t.legend.lines.length;i++)if(u=t.legend.lines[i],n.series!==u.series&&!u.series.disabled){r=!0;break}r?(n.series.enable(),n.element.classList.remove("disabled"),t.legend.lines.forEach(function(t){n.series===t.series||(t.series.disable(),t.element.classList.add("disabled"))})):t.legend.lines.forEach(function(n){n.series.enable();n.element.classList.remove("disabled")})}};this.legend&&(i=jQuery,typeof i!="undefined"&&i(this.legend.list).sortable&&i(this.legend.list).sortable({start:function(n,t){t.item.bind("no.onclick",function(n){n.preventDefault()})},stop:function(n,t){setTimeout(function(){t.item.unbind("no.onclick")},250)}}),this.legend.lines.forEach(function(n){t.addAnchor(n)}));this._addBehavior=function(){this.graph.series.forEach(function(n){n.disable=function(){if(t.graph.series.length<=1)throw"only one series left";n.disabled=!0;t.graph.update()};n.enable=function(){n.disabled=!1;t.graph.update()}})};this._addBehavior();this.updateBehaviour=function(){this._addBehavior()}},t.namespace("Rickshaw.Graph.HoverDetail"),t.Graph.HoverDetail=t.Class.create({initialize:function(n){var i=this.graph=n.graph,t;this.xFormatter=n.xFormatter||function(n){return new Date(n*1e3).toUTCString()};this.yFormatter=n.yFormatter||function(n){return n===null?n:n.toFixed(2)};t=this.element=document.createElement("div");t.className="detail";this.visible=!0;i.element.appendChild(t);this.lastEvent=null;this._addListeners();this.onShow=n.onShow;this.onHide=n.onHide;this.onRender=n.onRender;this.formatter=n.formatter||this.formatter},formatter:function(n,t,i,r,u){return n.name+":&nbsp;"+u},update:function(t){var e,h;if((t=t||this.lastEvent,t)&&(this.lastEvent=t,t.target.nodeName.match(/^(path|svg|rect|circle)$/))){var r=this.graph,u=t.offsetX||t.layerX,o=t.offsetY||t.layerY,s=0,f=[],i;(this.graph.series.active().forEach(function(t){var e=this.graph.stackedData[s++],a,h;if(e.length){var l=r.x.invert(u),w=n.scale.linear().domain([e[0].x,e.slice(-1)[0].x]).range([0,e.length-1]),v=Math.round(w(l));for(v==e.length-1&&v--,a=Math.min(v||0,e.length-1),h=v;h<e.length-1;){if(!e[h]||!e[h+1])break;if(e[h].x<=l&&e[h+1].x>l){a=Math.abs(l-e[h].x)<Math.abs(l-e[h+1].x)?h:h+1;break}e[h+1].x<=l?h++:h--}a<0&&(a=0);var c=e[a],y=Math.sqrt(Math.pow(Math.abs(r.x(c.x)-u),2)+Math.pow(Math.abs(r.y(c.y+c.y0)-o),2)),b=t.xFormatter||this.xFormatter,k=t.yFormatter||this.yFormatter,p={formattedXValue:b(c.x),formattedYValue:k(t.scale?t.scale.invert(c.y):c.y),series:t,value:c,distance:y,order:s,name:t.name};(!i||y<i.distance)&&(i=p);f.push(p)}},this),i)&&(i.active=!0,e=i.value.x,h=i.formattedXValue,this.element.innerHTML="",this.element.style.left=r.x(e)+"px",this.visible&&this.render({points:f,detail:f,mouseX:u,mouseY:o,formattedXValue:h,domainX:e}))}},hide:function(){this.visible=!1;this.element.classList.add("inactive");typeof this.onHide=="function"&&this.onHide()},show:function(){this.visible=!0;this.element.classList.remove("inactive");typeof this.onShow=="function"&&this.onShow()},render:function(n){var a=this.graph,v=n.points,t=v.filter(function(n){return n.active}).shift(),o,h,f,i,e,c,r,u,s,l;if(t.value.y!==null&&(o=t.formattedXValue,h=t.formattedYValue,this.element.innerHTML="",this.element.style.left=a.x(t.value.x)+"px",f=document.createElement("div"),f.className="x_label",f.innerHTML=o,this.element.appendChild(f),i=document.createElement("div"),i.className="item",e=t.series,c=e.scale?e.scale.invert(t.value.y):t.value.y,i.innerHTML=this.formatter(e,t.value.x,c,o,h,t),i.style.top=this.graph.y(t.value.y0+t.value.y)+"px",this.element.appendChild(i),r=document.createElement("div"),r.className="dot",r.style.top=i.style.top,r.style.borderColor=e.color,this.element.appendChild(r),t.active&&(i.classList.add("active"),r.classList.add("active")),u=[f,i],u.forEach(function(n){n.classList.add("left")}),this.show(),s=this._calcLayoutError(u),s>0&&(u.forEach(function(n){n.classList.remove("left");n.classList.add("right")}),l=this._calcLayoutError(u),l>s&&u.forEach(function(n){n.classList.remove("right");n.classList.add("left")})),typeof this.onRender=="function"))this.onRender(n)},_calcLayoutError:function(n){var t=this.element.parentNode.getBoundingClientRect(),i=0,r=n.forEach(function(n){var r=n.getBoundingClientRect();r.width&&(r.right>t.right&&(i+=r.right-t.right),r.left<t.left&&(i+=t.left-r.left))});return i},_addListeners:function(){this.graph.element.addEventListener("mousemove",function(n){this.visible=!0;this.update(n)}.bind(this),!1);this.graph.onUpdate(function(){this.update()}.bind(this));this.graph.element.addEventListener("mouseout",function(n){!n.relatedTarget||n.relatedTarget.compareDocumentPosition(this.graph.element)&Node.DOCUMENT_POSITION_CONTAINS||this.hide()}.bind(this),!1)}}),t.namespace("Rickshaw.Graph.JSONP"),t.Graph.JSONP=t.Class.create(t.Graph.Ajax,{request:function(){jQuery.ajax({url:this.dataURL,dataType:"jsonp",success:this.success.bind(this),error:this.error.bind(this)})}}),t.namespace("Rickshaw.Graph.Legend"),t.Graph.Legend=t.Class.create({className:"rickshaw_legend",initialize:function(n){this.element=n.element;this.graph=n.graph;this.naturalOrder=n.naturalOrder;this.element.classList.add(this.className);this.list=document.createElement("ul");this.element.appendChild(this.list);this.render();this.graph.onUpdate(function(){})},render:function(){for(var t=this,n;this.list.firstChild;)this.list.removeChild(this.list.firstChild);this.lines=[];n=this.graph.series.map(function(n){return n});this.naturalOrder||(n=n.reverse());n.forEach(function(n){t.addLine(n)})},addLine:function(t){var i=document.createElement("li"),r,u,f;return i.className="line",t.disabled&&(i.className+=" disabled"),t.className&&n.select(i).classed(t.className,!0),r=document.createElement("div"),r.className="swatch",r.style.backgroundColor=t.color,i.appendChild(r),u=document.createElement("span"),u.className="label",u.innerHTML=t.name,i.appendChild(u),this.list.appendChild(i),i.series=t,t.noLegend&&(i.style.display="none"),f={element:i,series:t},this.shelving&&(this.shelving.addAnchor(f),this.shelving.updateBehaviour()),this.highlighter&&this.highlighter.addHighlightEvents(f),this.lines.push(f),i}}),t.namespace("Rickshaw.Graph.RangeSlider"),t.Graph.RangeSlider=t.Class.create({initialize:function(n){var i=this.element=n.element,t=this.graph=n.graph;this.slideCallbacks=[];this.build();t.onUpdate(function(){this.update()}.bind(this))},build:function(){var r=this.element,n=this.graph,i=jQuery,t=n.dataDomain(),u=this;i(function(){i(r).slider({range:!0,min:t[0],max:t[1],values:[t[0],t[1]],slide:function(t,i){if(!(i.values[1]<=i.values[0])){n.window.xMin=i.values[0];n.window.xMax=i.values[1];n.update();var r=n.dataDomain();r[0]==i.values[0]&&(n.window.xMin=undefined);r[1]==i.values[1]&&(n.window.xMax=undefined);u.slideCallbacks.forEach(function(t){t(n,n.window.xMin,n.window.xMax)})}}})});i(r)[0].style.width=n.width+"px"},update:function(){var n=this.element,r=this.graph,t=jQuery,u=t(n).slider("option","values"),i=r.dataDomain();t(n).slider("option","min",i[0]);t(n).slider("option","max",i[1]);r.window.xMin==null&&(u[0]=i[0]);r.window.xMax==null&&(u[1]=i[1]);t(n).slider("option","values",u)},onSlide:function(n){this.slideCallbacks.push(n)}}),t.namespace("Rickshaw.Graph.RangeSlider.Preview"),t.Graph.RangeSlider.Preview=t.Class.create({initialize:function(t){if(!t.element)throw"Rickshaw.Graph.RangeSlider.Preview needs a reference to an element";if(!t.graph&&!t.graphs)throw"Rickshaw.Graph.RangeSlider.Preview needs a reference to an graph or an array of graphs";if(this.element=t.element,this.element.style.position="relative",this.graphs=t.graph?[t.graph]:t.graphs,this.defaults={height:75,width:400,gripperColor:undefined,frameTopThickness:3,frameHandleThickness:10,frameColor:"#d4d4d4",frameOpacity:1,minimumFrameWidth:0,heightRatio:.2},this.heightRatio=t.heightRatio||this.defaults.heightRatio,this.defaults.gripperColor=n.rgb(this.defaults.frameColor).darker().toString(),this.configureCallbacks=[],this.slideCallbacks=[],this.previews=[],t.width||(this.widthFromGraph=!0),t.height||(this.heightFromGraph=!0),this.widthFromGraph||this.heightFromGraph)this.graphs[0].onConfigure(function(){this.configure(t);this.render()}.bind(this));t.width=t.width||this.graphs[0].width||this.defaults.width;t.height=t.height||this.graphs[0].height*this.heightRatio||this.defaults.height;this.configure(t);this.render()},onSlide:function(n){this.slideCallbacks.push(n)},onConfigure:function(n){this.configureCallbacks.push(n)},configure:function(n){this.config=this.config||{};this.configureCallbacks.forEach(function(t){t(n)});t.keys(this.defaults).forEach(function(t){this.config[t]=t in n?n[t]:t in this.config?this.config[t]:this.defaults[t]},this);("width"in n||"height"in n)&&(this.widthFromGraph&&(this.config.width=this.graphs[0].width),this.heightFromGraph&&(this.config.height=this.graphs[0].height*this.heightRatio,this.previewHeight=this.config.height),this.previews.forEach(function(n){var t=this.previewHeight/this.graphs.length-this.config.frameTopThickness*2,i=this.config.width-this.config.frameHandleThickness*2,r,u;n.setSize({width:i,height:t});this.svg&&(r=t+this.config.frameHandleThickness*2,u=i+this.config.frameHandleThickness*2,this.svg.style("width",u+"px"),this.svg.style("height",r+"px"))},this))},render:function(){var i=this;this.svg=n.select(this.element).selectAll("svg.rickshaw_range_slider_preview").data([null]);this.previewHeight=this.config.height-this.config.frameTopThickness*2;this.previewWidth=this.config.width-this.config.frameHandleThickness*2;this.currentFrame=[0,this.previewWidth];var s=function(n){var u=t.extend({},n.config),f=i.previewHeight/i.graphs.length,e=n.renderer.name,r;t.extend(u,{element:this.appendChild(document.createElement("div")),height:f,width:i.previewWidth,series:n.series,renderer:e});r=new t.Graph(u);i.previews.push(r);n.onUpdate(function(){r.render();i.render()});n.onConfigure(function(n){delete n.height;n.width=n.width-i.config.frameHandleThickness*2;r.configure(n);r.render()});r.render()},e=n.select(this.element).selectAll("div.rickshaw_range_slider_preview_container").data(this.graphs),r="translate("+this.config.frameHandleThickness+"px, "+this.config.frameTopThickness+"px)";e.enter().append("div").classed("rickshaw_range_slider_preview_container",!0).style("-webkit-transform",r).style("-moz-transform",r).style("-ms-transform",r).style("transform",r).each(s);e.exit().remove();var f=this.graphs[0],o=n.scale.linear().domain([0,this.previewWidth]).range(f.dataDomain()),u=[f.window.xMin,f.window.xMax];this.currentFrame[0]=u[0]===undefined?0:Math.round(o.invert(u[0]));this.currentFrame[0]<0&&(this.currentFrame[0]=0);this.currentFrame[1]=u[1]===undefined?this.previewWidth:o.invert(u[1]);this.currentFrame[1]-this.currentFrame[0]<i.config.minimumFrameWidth&&(this.currentFrame[1]=(this.currentFrame[0]||0)+i.config.minimumFrameWidth);this.svg.enter().append("svg").classed("rickshaw_range_slider_preview",!0).style("height",this.config.height+"px").style("width",this.config.width+"px").style("position","absolute").style("top",0);this._renderDimming();this._renderFrame();this._renderGrippers();this._renderHandles();this._renderMiddle();this._registerMouseEvents()},_renderDimming:function(){var t=this.svg.selectAll("path.dimming").data([null]),n;t.enter().append("path").attr("fill","white").attr("fill-opacity","0.7").attr("fill-rule","evenodd").classed("dimming",!0);n="";n+=" M "+this.config.frameHandleThickness+" "+this.config.frameTopThickness;n+=" h "+this.previewWidth;n+=" v "+this.previewHeight;n+=" h "+-this.previewWidth;n+=" z ";n+=" M "+Math.max(this.currentFrame[0],this.config.frameHandleThickness)+" "+this.config.frameTopThickness;n+=" H "+Math.min(this.currentFrame[1]+this.config.frameHandleThickness*2,this.previewWidth+this.config.frameHandleThickness);n+=" v "+this.previewHeight;n+=" H "+Math.max(this.currentFrame[0],this.config.frameHandleThickness);n+=" z";t.attr("d",n)},_renderFrame:function(){var t=this.svg.selectAll("path.frame").data([null]),n;t.enter().append("path").attr("stroke","white").attr("stroke-width","1px").attr("stroke-linejoin","round").attr("fill",this.config.frameColor).attr("fill-opacity",this.config.frameOpacity).attr("fill-rule","evenodd").classed("frame",!0);n="";n+=" M "+this.currentFrame[0]+" 0";n+=" H "+(this.currentFrame[1]+this.config.frameHandleThickness*2);n+=" V "+this.config.height;n+=" H "+this.currentFrame[0];n+=" z";n+=" M "+(this.currentFrame[0]+this.config.frameHandleThickness)+" "+this.config.frameTopThickness;n+=" H "+(this.currentFrame[1]+this.config.frameHandleThickness);n+=" v "+this.previewHeight;n+=" H "+(this.currentFrame[0]+this.config.frameHandleThickness);n+=" z";t.attr("d",n)},_renderGrippers:function(){var t=this.svg.selectAll("path.gripper").data([null]),n;t.enter().append("path").attr("stroke",this.config.gripperColor).classed("gripper",!0);n="";[.4,.6].forEach(function(t){n+=" M "+Math.round(this.currentFrame[0]+this.config.frameHandleThickness*t)+" "+Math.round(this.config.height*.3);n+=" V "+Math.round(this.config.height*.7);n+=" M "+Math.round(this.currentFrame[1]+this.config.frameHandleThickness*(1+t))+" "+Math.round(this.config.height*.3);n+=" V "+Math.round(this.config.height*.7)}.bind(this));t.attr("d",n)},_renderHandles:function(){var t=this.svg.selectAll("rect.left_handle").data([null]),n;t.enter().append("rect").attr("width",this.config.frameHandleThickness).style("cursor","ew-resize").style("fill-opacity","0").classed("left_handle",!0);t.attr("x",this.currentFrame[0]).attr("height",this.config.height);n=this.svg.selectAll("rect.right_handle").data([null]);n.enter().append("rect").attr("width",this.config.frameHandleThickness).style("cursor","ew-resize").style("fill-opacity","0").classed("right_handle",!0);n.attr("x",this.currentFrame[1]+this.config.frameHandleThickness).attr("height",this.config.height)},_renderMiddle:function(){var n=this.svg.selectAll("rect.middle_handle").data([null]);n.enter().append("rect").style("cursor","move").style("fill-opacity","0").classed("middle_handle",!0);n.attr("width",Math.max(0,this.currentFrame[1]-this.currentFrame[0])).attr("x",this.currentFrame[0]+this.config.frameHandleThickness).attr("height",this.config.height)},_registerMouseEvents:function(){function e(){var e;t.stop=i._getClientXFromEvent(n.event,t);var f=t.stop-t.start,r=i.frameBeforeDrag.slice(0),u=i.config.minimumFrameWidth;t.rigid&&(u=i.frameBeforeDrag[1]-i.frameBeforeDrag[0]);t.left&&(r[0]=Math.max(r[0]+f,0));t.right&&(r[1]=Math.min(r[1]+f,i.previewWidth));e=r[1]-r[0];e<=u&&(t.left&&(r[0]=r[1]-u),t.right&&(r[1]=r[0]+u),r[0]<=0&&(r[1]-=r[0],r[0]=0),r[1]>=i.previewWidth&&(r[0]-=r[1]-i.previewWidth,r[1]=i.previewWidth));i.graphs.forEach(function(t){var f=n.scale.linear().interpolate(n.interpolateNumber).domain([0,i.previewWidth]).range(t.dataDomain()),u=[f(r[0]),f(r[1])];i.slideCallbacks.forEach(function(n){n(t,u[0],u[1])});r[0]===0&&(u[0]=undefined);r[1]===i.previewWidth&&(u[1]=undefined);t.window.xMin=u[0];t.window.xMax=u[1];t.update()})}function u(){t.target=n.event.target;t.start=i._getClientXFromEvent(n.event,t);i.frameBeforeDrag=i.currentFrame.slice();n.event.preventDefault?n.event.preventDefault():n.event.returnValue=!1;n.select(document).on("mousemove.rickshaw_range_slider_preview",e);n.select(document).on("mouseup.rickshaw_range_slider_preview",f);n.select(document).on("touchmove.rickshaw_range_slider_preview",e);n.select(document).on("touchend.rickshaw_range_slider_preview",f);n.select(document).on("touchcancel.rickshaw_range_slider_preview",f)}function o(){t.left=!0;u()}function s(){t.right=!0;u()}function h(){t.left=!0;t.right=!0;t.rigid=!0;u()}function f(){n.select(document).on("mousemove.rickshaw_range_slider_preview",null);n.select(document).on("mouseup.rickshaw_range_slider_preview",null);n.select(document).on("touchmove.rickshaw_range_slider_preview",null);n.select(document).on("touchend.rickshaw_range_slider_preview",null);n.select(document).on("touchcancel.rickshaw_range_slider_preview",null);delete i.frameBeforeDrag;t.left=!1;t.right=!1;t.rigid=!1}var r=n.select(this.element),t={target:null,start:null,stop:null,left:!1,right:!1,rigid:!1},i=this;r.select("rect.left_handle").on("mousedown",o);r.select("rect.right_handle").on("mousedown",s);r.select("rect.middle_handle").on("mousedown",h);r.select("rect.left_handle").on("touchstart",o);r.select("rect.right_handle").on("touchstart",s);r.select("rect.middle_handle").on("touchstart",h)},_getClientXFromEvent:function(n,t){var r,u,i;switch(n.type){case"touchstart":case"touchmove":for(r=n.changedTouches,u=null,i=0;i<r.length;i++)if(r[i].target===t.target){u=r[i];break}return u!==null?u.clientX:undefined;default:return n.clientX}}}),t.namespace("Rickshaw.Graph.Renderer"),t.Graph.Renderer=t.Class.create({initialize:function(n){this.graph=n.graph;this.tension=n.tension||this.tension;this.configure(n)},seriesPathFactory:function(){},seriesStrokeFactory:function(){},defaults:function(){return{tension:.8,strokeWidth:2,unstack:!0,padding:{top:.01,right:0,bottom:.01,left:0},stroke:!1,fill:!1}},domain:function(n){var f=n||this.graph.stackedData||this.graph.stackData(),r=+Infinity,u=-Infinity,t=+Infinity,i=-Infinity;return f.forEach(function(n){(n.forEach(function(n){if(n.y!=null){var r=n.y+n.y0;r<t&&(t=r);r>i&&(i=r)}}),n.length)&&(n[0].x<r&&(r=n[0].x),n[n.length-1].x>u&&(u=n[n.length-1].x))}),r-=(u-r)*this.padding.left,u+=(u-r)*this.padding.right,t=this.graph.min==="auto"?t:this.graph.min||0,i=this.graph.max===undefined?i:this.graph.max,(this.graph.min==="auto"||t<0)&&(t-=(i-t)*this.padding.bottom),this.graph.max===undefined&&(i+=(i-t)*this.padding.top),{x:[r,u],y:[t,i]}},render:function(n){var r,e,o,t;n=n||{};var u=this.graph,f=n.series||u.series,i=n.vis||u.vis;i.selectAll("*").remove();r=f.filter(function(n){return!n.disabled}).map(function(n){return n.stack});e=i.selectAll("path.path").data(r).enter().append("svg:path").classed("path",!0).attr("d",this.seriesPathFactory());this.stroke&&(o=i.selectAll("path.stroke").data(r).enter().append("svg:path").classed("stroke",!0).attr("d",this.seriesStrokeFactory()));t=0;f.forEach(function(n){n.disabled||(n.path=e[0][t],this.stroke&&(n.stroke=o[0][t]),this._styleSeries(n),t++)},this)},_styleSeries:function(t){var i=this.fill?t.color:"none",r=this.stroke?t.color:"none";t.path.setAttribute("fill",i);t.path.setAttribute("stroke",r);t.path.setAttribute("stroke-width",this.strokeWidth);t.className&&n.select(t.path).classed(t.className,!0);t.className&&this.stroke&&n.select(t.stroke).classed(t.className,!0)},configure:function(n){n=n||{};t.keys(this.defaults()).forEach(function(i){if(!n.hasOwnProperty(i)){this[i]=this[i]||this.graph[i]||this.defaults()[i];return}typeof this.defaults()[i]=="object"?t.keys(this.defaults()[i]).forEach(function(t){this[i][t]=n[i][t]!==undefined?n[i][t]:this[i][t]!==undefined?this[i][t]:this.defaults()[i][t]},this):this[i]=n[i]!==undefined?n[i]:this[i]!==undefined?this[i]:this.graph[i]!==undefined?this.graph[i]:this.defaults()[i]},this)},setStrokeWidth:function(n){n!==undefined&&(this.strokeWidth=n)},setTension:function(n){n!==undefined&&(this.tension=n)}}),t.namespace("Rickshaw.Graph.Renderer.Line"),t.Graph.Renderer.Line=t.Class.create(t.Graph.Renderer,{name:"line",defaults:function($super){return t.extend($super(),{unstack:!0,fill:!1,stroke:!0})},seriesPathFactory:function(){var i=this.graph,t=n.svg.line().x(function(n){return i.x(n.x)}).y(function(n){return i.y(n.y)}).interpolate(this.graph.interpolation).tension(this.tension);return t.defined&&t.defined(function(n){return n.y!==null}),t}}),t.namespace("Rickshaw.Graph.Renderer.Stack"),t.Graph.Renderer.Stack=t.Class.create(t.Graph.Renderer,{name:"stack",defaults:function($super){return t.extend($super(),{fill:!0,stroke:!1,unstack:!1})},seriesPathFactory:function(){var t=this.graph,i=n.svg.area().x(function(n){return t.x(n.x)}).y0(function(n){return t.y(n.y0)}).y1(function(n){return t.y(n.y+n.y0)}).interpolate(this.graph.interpolation).tension(this.tension);return i.defined&&i.defined(function(n){return n.y!==null}),i}}),t.namespace("Rickshaw.Graph.Renderer.Bar"),t.Graph.Renderer.Bar=t.Class.create(t.Graph.Renderer,{name:"bar",defaults:function($super){var n=t.extend($super(),{gapSize:.05,unstack:!1});return delete n.tension,n},initialize:function($super,n){n=n||{};this.gapSize=n.gapSize||this.gapSize;$super(n)},domain:function($super){var n=$super(),t=this._frequentInterval(this.graph.stackedData.slice(-1).shift());return n.x[1]+=Number(t.magnitude),n},barWidth:function(n){var t=this._frequentInterval(n.stack);return this.graph.x.magnitude(t.magnitude)*(1-this.gapSize)},render:function(n){n=n||{};var t=this.graph,i=n.series||t.series,r=n.vis||t.vis;r.selectAll("*").remove();var u=this.barWidth(i.active()[0]),f=0,o=i.filter(function(n){return!n.disabled}).length,e=this.unstack?u/o:u,s=function(n){var i=[1,0,0,n.y<0?-1:1,0,n.y<0?t.y.magnitude(Math.abs(n.y))*2:0];return"matrix("+i.join(",")+")"};i.forEach(function(n){if(!n.disabled){var u=this.barWidth(n),i=r.selectAll("path").data(n.stack.filter(function(n){return n.y!==null})).enter().append("svg:rect").attr("x",function(n){return t.x(n.x)+f}).attr("y",function(n){return t.y(n.y0+Math.abs(n.y))*(n.y<0?-1:1)}).attr("width",e).attr("height",function(n){return t.y.magnitude(Math.abs(n.y))}).attr("transform",s);Array.prototype.forEach.call(i[0],function(t){t.setAttribute("fill",n.color)});this.unstack&&(f+=e)}},this)},_frequentInterval:function(n){for(var u,f,i={},r=0;r<n.length-1;r++)u=n[r+1].x-n[r].x,i[u]=i[u]||0,i[u]++;return f={count:0,magnitude:1},t.keys(i).forEach(function(n){f.count<i[n]&&(f={count:i[n],magnitude:n})}),f}}),t.namespace("Rickshaw.Graph.Renderer.Area"),t.Graph.Renderer.Area=t.Class.create(t.Graph.Renderer,{name:"area",defaults:function($super){return t.extend($super(),{unstack:!1,fill:!1,stroke:!1})},seriesPathFactory:function(){var t=this.graph,i=n.svg.area().x(function(n){return t.x(n.x)}).y0(function(n){return t.y(n.y0)}).y1(function(n){return t.y(n.y+n.y0)}).interpolate(t.interpolation).tension(this.tension);return i.defined&&i.defined(function(n){return n.y!==null}),i},seriesStrokeFactory:function(){var t=this.graph,i=n.svg.line().x(function(n){return t.x(n.x)}).y(function(n){return t.y(n.y+n.y0)}).interpolate(t.interpolation).tension(this.tension);return i.defined&&i.defined(function(n){return n.y!==null}),i},render:function(n){var f;n=n||{};var i=this.graph,r=n.series||i.series,u=n.vis||i.vis;u.selectAll("*").remove();var e=this.unstack?"append":"insert",o=r.filter(function(n){return!n.disabled}).map(function(n){return n.stack}),t=u.selectAll("path").data(o).enter()[e]("svg:g","g");t.append("svg:path").attr("d",this.seriesPathFactory()).attr("class","area");this.stroke&&t.append("svg:path").attr("d",this.seriesStrokeFactory()).attr("class","line");f=0;r.forEach(function(n){n.disabled||(n.path=t[0][f++],this._styleSeries(n))},this)},_styleSeries:function(t){t.path&&(n.select(t.path).select(".area").attr("fill",t.color),this.stroke&&n.select(t.path).select(".line").attr("fill","none").attr("stroke",t.stroke||n.interpolateRgb(t.color,"black")(.125)).attr("stroke-width",this.strokeWidth),t.className&&t.path.setAttribute("class",t.className))}}),t.namespace("Rickshaw.Graph.Renderer.ScatterPlot"),t.Graph.Renderer.ScatterPlot=t.Class.create(t.Graph.Renderer,{name:"scatterplot",defaults:function($super){return t.extend($super(),{unstack:!0,fill:!0,stroke:!1,padding:{top:.01,right:.01,bottom:.01,left:.01},dotSize:4})},initialize:function($super,n){$super(n)},render:function(n){n=n||{};var t=this.graph,r=n.series||t.series,i=n.vis||t.vis,u=this.dotSize;i.selectAll("*").remove();r.forEach(function(n){if(!n.disabled){var r=i.selectAll("path").data(n.stack.filter(function(n){return n.y!==null})).enter().append("svg:circle").attr("cx",function(n){return t.x(n.x)}).attr("cy",function(n){return t.y(n.y)}).attr("r",function(n){return"r"in n?n.r:u});n.className&&r.classed(n.className,!0);Array.prototype.forEach.call(r[0],function(t){t.setAttribute("fill",n.color)})}},this)}}),t.namespace("Rickshaw.Graph.Renderer.Multi"),t.Graph.Renderer.Multi=t.Class.create(t.Graph.Renderer,{name:"multi",initialize:function($super,n){$super(n)},defaults:function($super){return t.extend($super(),{unstack:!0,fill:!1,stroke:!0})},configure:function($super,n){n=n||{};this.config=n;$super(n)},domain:function($super){var t,i;this.graph.stackData();t=[];i=this._groups();this._stack(i);i.forEach(function(n){var i=n.series.filter(function(n){return!n.disabled}).map(function(n){return n.stack}),r;i.length&&(r=null,r=n.renderer&&n.renderer.domain?n.renderer.domain(i):$super(i),t.push(r))});var r=n.min(t.map(function(n){return n.x[0]})),u=n.max(t.map(function(n){return n.x[1]})),f=n.min(t.map(function(n){return n.y[0]})),e=n.max(t.map(function(n){return n.y[1]}));return{x:[r,u],y:[f,e]}},_groups:function(){var r=this.graph,i={},u;return r.series.forEach(function(u){var o,f;if(!u.disabled){if(!i[u.renderer]){o="http://www.w3.org/2000/svg";f=document.createElementNS(o,"g");r.vis[0][0].appendChild(f);var e=r._renderers[u.renderer],s={},h=[this.defaults(),e.defaults(),this.config,this.graph];h.forEach(function(n){t.extend(s,n)});e.configure(s);i[u.renderer]={renderer:e,series:[],vis:n.select(f)}}i[u.renderer].series.push(u)}},this),u=[],Object.keys(i).forEach(function(n){var t=i[n];u.push(t)}),u},_stack:function(i){return i.forEach(function(i){var r=i.series.filter(function(n){return!n.disabled}),e=r.map(function(n){return n.stack}),u,f;i.renderer.unstack||(u=n.layout.stack(),f=t.clone(u(e)),r.forEach(function(n,i){n._stack=t.clone(f[i])}))},this),i},render:function(){this.graph.series.forEach(function(n){if(!n.renderer)throw new Error("Each series needs a renderer for graph 'multi' renderer");});this.graph.vis.selectAll("*").remove();var n=this._groups();n=this._stack(n);n.forEach(function(n){var t=n.series.filter(function(n){return!n.disabled});t.active=function(){return t};n.renderer.render({series:t,vis:n.vis});t.forEach(function(n){n.stack=n._stack||n.stack||n.data})})}}),t.namespace("Rickshaw.Graph.Renderer.LinePlot"),t.Graph.Renderer.LinePlot=t.Class.create(t.Graph.Renderer,{name:"lineplot",defaults:function($super){return t.extend($super(),{unstack:!0,fill:!1,stroke:!0,padding:{top:.01,right:.01,bottom:.01,left:.01},dotSize:3,strokeWidth:2})},seriesPathFactory:function(){var i=this.graph,t=n.svg.line().x(function(n){return i.x(n.x)}).y(function(n){return i.y(n.y)}).interpolate(this.graph.interpolation).tension(this.tension);return t.defined&&t.defined(function(n){return n.y!==null}),t},render:function(n){n=n||{};var t=this.graph,i=n.series||t.series,r=n.vis||t.vis,u=this.dotSize;r.selectAll("*").remove();var f=i.filter(function(n){return!n.disabled}).map(function(n){return n.stack}),e=r.selectAll("path").data(f).enter().append("svg:path").attr("d",this.seriesPathFactory()),o=0;i.forEach(function(n){n.disabled||(n.path=e[0][o++],this._styleSeries(n))},this);i.forEach(function(n){if(!n.disabled){var i=r.selectAll("x").data(n.stack.filter(function(n){return n.y!==null})).enter().append("svg:circle").attr("cx",function(n){return t.x(n.x)}).attr("cy",function(n){return t.y(n.y)}).attr("r",function(n){return"r"in n?n.r:u});Array.prototype.forEach.call(i[0],function(t){t&&(t.setAttribute("data-color",n.color),t.setAttribute("fill","white"),t.setAttribute("stroke",n.color),t.setAttribute("stroke-width",this.strokeWidth))}.bind(this))}},this)}}),t.namespace("Rickshaw.Graph.Smoother"),t.Graph.Smoother=t.Class.create({initialize:function(n){this.graph=n.graph;this.element=n.element;this.aggregationScale=1;this.build();this.graph.stackData.hooks.data.push({name:"smoother",orderPosition:50,f:this.transformer.bind(this)})},build:function(){var n=this,t=jQuery;this.element&&t(function(){t(n.element).slider({min:1,max:100,slide:function(t,i){n.setScale(i.value);n.graph.update()}})})},setScale:function(n){if(n<1)throw"scale out of range: "+n;this.aggregationScale=n;this.graph.update()},transformer:function(n){if(this.aggregationScale==1)return n;var t=[];return n.forEach(function(n){for(var r=[];n.length;){var u=0,f=0,i=n.splice(0,this.aggregationScale);i.forEach(function(n){u+=n.x/i.length;f+=n.y/i.length});r.push({x:u,y:f})}t.push(r)}.bind(this)),t}}),t.namespace("Rickshaw.Graph.Socketio"),t.Graph.Socketio=t.Class.create(t.Graph.Ajax,{request:function(){var n=io.connect(this.dataURL),t=this;n.on("rickshaw",function(n){t.success(n)})}}),t.namespace("Rickshaw.Series"),t.Series=t.Class.create(Array,{initialize:function(n,i,r){r=r||{};this.palette=new t.Color.Palette(i);this.timeBase=typeof r.timeBase=="undefined"?Math.floor((new Date).getTime()/1e3):r.timeBase;var u=typeof r.timeInterval=="undefined"?1e3:r.timeInterval;this.setTimeInterval(u);n&&typeof n=="object"&&Array.isArray(n)&&n.forEach(function(n){this.addItem(n)},this)},addItem:function(n){if(typeof n.name=="undefined")throw"addItem() needs a name";n.color=n.color||this.palette.color(n.name);n.data=n.data||[];n.data.length===0&&this.length&&this.getIndex()>0?this[0].data.forEach(function(t){n.data.push({x:t.x,y:0})}):n.data.length===0&&n.data.push({x:this.timeBase-(this.timeInterval||0),y:0});this.push(n);this.legend&&this.legend.addLine(this.itemByName(n.name))},addData:function(n,i){var r=this.getIndex();t.keys(n).forEach(function(n){this.itemByName(n)||this.addItem({name:n})},this);this.forEach(function(t){t.data.push({x:i||(r*this.timeInterval||1)+this.timeBase,y:n[t.name]||0})},this)},getIndex:function(){return this[0]&&this[0].data&&this[0].data.length?this[0].data.length:0},itemByName:function(n){for(var t=0;t<this.length;t++)if(this[t].name==n)return this[t]},setTimeInterval:function(n){this.timeInterval=n/1e3},setTimeBase:function(n){this.timeBase=n},dump:function(){var n={timeBase:this.timeBase,timeInterval:this.timeInterval,items:[]};return this.forEach(function(t){var i={color:t.color,name:t.name,data:[]};t.data.forEach(function(n){i.data.push({x:n.x,y:n.y})});n.items.push(i)}),n},load:function(n){n.timeInterval&&(this.timeInterval=n.timeInterval);n.timeBase&&(this.timeBase=n.timeBase);n.items&&n.items.forEach(function(n){this.push(n);this.legend&&this.legend.addLine(this.itemByName(n.name))},this)}}),t.Series.zeroFill=function(n){t.Series.fill(n,0)},t.Series.fill=function(n,t){for(var r,i=0,u=n.map(function(n){return n.data});i<Math.max.apply(null,u.map(function(n){return n.length}));)r=Math.min.apply(null,u.filter(function(n){return n[i]}).map(function(n){return n[i].x})),u.forEach(function(n){n[i]&&n[i].x==r||n.splice(i,0,{x:r,y:t})}),i++},t.namespace("Rickshaw.Series.FixedDuration"),t.Series.FixedDuration=t.Class.create(t.Series,{initialize:function(n,i,r){if(r=r||{},typeof r.timeInterval=="undefined")throw new Error("FixedDuration series requires timeInterval");if(typeof r.maxDataPoints=="undefined")throw new Error("FixedDuration series requires maxDataPoints");if(this.palette=new t.Color.Palette(i),this.timeBase=typeof r.timeBase=="undefined"?Math.floor((new Date).getTime()/1e3):r.timeBase,this.setTimeInterval(r.timeInterval),this[0]&&this[0].data&&this[0].data.length?(this.currentSize=this[0].data.length,this.currentIndex=this[0].data.length):(this.currentSize=0,this.currentIndex=0),this.maxDataPoints=r.maxDataPoints,n&&typeof n=="object"&&Array.isArray(n)&&(n.forEach(function(n){this.addItem(n)},this),this.currentSize+=1,this.currentIndex+=1),this.timeBase-=(this.maxDataPoints-this.currentSize)*this.timeInterval,typeof this.maxDataPoints!="undefined"&&this.currentSize<this.maxDataPoints)for(var u=this.maxDataPoints-this.currentSize-1;u>1;u--)this.currentSize+=1,this.currentIndex+=1,this.forEach(function(n){n.data.unshift({x:((u-1)*this.timeInterval||1)+this.timeBase,y:0,i:u})},this)},addData:function($super,n,t){if($super(n,t),this.currentSize+=1,this.currentIndex+=1,this.maxDataPoints!==undefined)while(this.currentSize>this.maxDataPoints)this.dropData()},dropData:function(){this.forEach(function(n){n.data.splice(0,1)});this.currentSize-=1},getIndex:function(){return this.currentIndex}}),t})