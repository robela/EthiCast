!function(n){"function"==typeof define&&define.amd?define(["jquery","codemirror"],n):n(window.jQuery,window.CodeMirror)}(function(n,t){var o,h;"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});var u={bMac:navigator.appVersion.indexOf("Mac")>-1,bMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,bFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(n.fn.jquery),bCodeMirror:!!t},e=function(){var n=function(n){return function(t){return n===t}},t=function(n,t){return n===t},i=function(){return!0},r=function(){return!1},u=function(n){return function(){return!n.apply(n,arguments)}},f=function(n){return n};return{eq:n,eq2:t,ok:i,fail:r,not:u,self:f}}(),f=function(){var t=function(n){return n[0]},n=function(n){return n[n.length-1]},r=function(n){return n.slice(0,n.length-1)},i=function(n){return n.slice(1)},u=function(n,t){var i=n.indexOf(t);return-1===i?null:n[i+1]},f=function(n,t){var i=n.indexOf(t);return-1===i?null:n[i-1]},o=function(n,t){return t=t||e.self,n.reduce(function(n,i){return n+t(i)},0)},s=function(n){for(var i=[],t=-1,r=n.length;++t<r;)i[t]=n[t];return i},h=function(r,u){if(0===r.length)return[];var f=i(r);return f.reduce(function(t,i){var r=n(t);return u(n(r),i)?r[r.length]=i:t[t.length]=[i],t},[[t(r)]])},c=function(n){for(var i=[],t=0,r=n.length;r>t;t++)n[t]&&i.push(n[t]);return i};return{head:t,last:n,initial:r,tail:i,prev:f,next:u,sum:o,from:s,compact:c,clusterBy:h}}(),i=function(){var c=function(t){return t&&n(t).hasClass("note-editable")},w=function(t){return t&&n(t).hasClass("note-control-sizing")},b=function(n){var t=function(t){return function(){return n.find(t)}};return{editor:function(){return n},dropzone:t(".note-dropzone"),toolbar:t(".note-toolbar"),editable:t(".note-editable"),codable:t(".note-codable"),statusbar:t(".note-statusbar"),popover:t(".note-popover"),handle:t(".note-handle"),dialog:t(".note-dialog")}},t=function(n){return function(t){return t&&t.nodeName===n}},k=function(n){return n&&/^DIV|^P|^LI|^H[1-7]/.test(n.nodeName)},d=function(n){return n&&/^UL|^OL/.test(n.nodeName)},g=function(n){return n&&/^TD|^TH/.test(n.nodeName)},l=function(n,t){for(;n;){if(t(n))return n;if(c(n))break;n=n.parentNode}return null},r=function(n,t){t=t||e.fail;var i=[];return l(n,function(n){return i.push(n),t(n)}),i},a=function(t,i){for(var f=r(t),u=i;u;u=u.parentNode)if(n.inArray(u,f)>-1)return u;return null},nt=function(n,t){var i=[],r=!1,u=!1;return function f(e){if(e){if(e===n&&(r=!0),r&&!u&&i.push(e),e===t)return void(u=!0);for(var o=0,s=e.childNodes.length;s>o;o++)f(e.childNodes[o])}}(a(n,t)),i},tt=function(n,t){t=t||e.fail;for(var i=[];n&&(i.push(n),!t(n));)n=n.previousSibling;return i},o=function(n,t){t=t||e.fail;for(var i=[];n&&(i.push(n),!t(n));)n=n.nextSibling;return i},it=function(n,t){var i=[];return t=t||e.ok,function r(u){n!==u&&t(u)&&i.push(u);for(var f=0,e=u.childNodes.length;e>f;f++)r(u.childNodes[f])}(n),i},s=function(n,t){var i=t.nextSibling,r=t.parentNode;return i?r.insertBefore(n,i):r.appendChild(n),n},v=function(t,i){return n.each(i,function(n,i){t.appendChild(i)}),t},h=t("#text"),rt=function(n){return h(n)?n.nodeValue.length:n.childNodes.length},y=function(n){for(var t=0;n=n.previousSibling;)t+=1;return t},ut=function(t,i){var u=f.initial(r(i,e.eq(t)));return n.map(u,y).reverse()},ft=function(n,t){for(var i=n,r=0,u=t.length;u>r;r++)i=i.childNodes[t[r]];return i},p=function(n,t){if(0===t)return n;if(t>=rt(n))return n.nextSibling;if(h(n))return n.splitText(t);var i=n.childNodes[t];return n=s(n.cloneNode(!1),n),v(n,o(i))},et=function(n,t,i){var u=r(t,e.eq(n));return 1===u.length?p(t,i):u.reduce(function(n,r){var u=r.cloneNode(!1);return s(u,r),n===t&&(n=p(n,i)),v(u,o(n)),u})},ot=function(n,t){var f,i,r,u;if(n&&n.parentNode){if(n.removeNode)return n.removeNode(t);if(f=n.parentNode,!t){for(u=[],i=0,r=n.childNodes.length;r>i;i++)u.push(n.childNodes[i]);for(i=0,r=u.length;r>i;i++)f.insertBefore(u[i],n)}f.removeChild(n)}},st=function(n){return i.isTextarea(n[0])?n.val():n.html()};return{blank:u.bMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/><\/p>",isEditable:c,isControlSizing:w,buildLayoutInfo:b,isText:h,isPara:k,isList:d,isTable:t("TABLE"),isCell:g,isAnchor:t("A"),isDiv:t("DIV"),isLi:t("LI"),isSpan:t("SPAN"),isB:t("B"),isU:t("U"),isS:t("S"),isI:t("I"),isImg:t("IMG"),isTextarea:t("TEXTAREA"),ancestor:l,listAncestor:r,listNext:o,listPrev:tt,listDescendant:it,commonAncestor:a,listBetween:nt,insertAfter:s,position:y,makeOffsetPath:ut,fromOffsetPath:ft,split:et,remove:ot,html:st}}(),c=function(){var t=function(t){return n.Deferred(function(i){n.extend(new FileReader,{onload:function(n){var t=n.target.result;i.resolve(t)},onerror:function(){i.reject(this)}}).readAsDataURL(t)}).promise()},i=function(t){return n.Deferred(function(i){n("<img>").one("load",function(){i.resolve(n(this))}).one("error abort",function(){i.reject(n(this))}).css({display:"none"}).appendTo(document.body).attr("src",t)}).promise()};return{readFileAsDataURL:t,createImage:i}}(),s={isEdit:function(n){return-1!==[8,9,13,32].indexOf(n)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},l=function(){var t=function(t,i){if(u.jqueryVersion<1.9){var r={};return n.each(i,function(n,i){r[i]=t.css(i)}),r}return t.css.call(t,i)};this.stylePara=function(t,r){n.each(t.nodes(i.isPara),function(t,i){n(i).css(r)})};this.current=function(r,u){var c=n(i.isText(r.sc)?r.sc.parentNode:r.sc),f=t(c,["font-family","font-size","text-align","list-style-type","line-height"])||{},o,s,e,h;return(f["font-size"]=parseInt(f["font-size"],10),f["font-bold"]=document.queryCommandState("bold")?"bold":"normal",f["font-italic"]=document.queryCommandState("italic")?"italic":"normal",f["font-underline"]=document.queryCommandState("underline")?"underline":"normal",f["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",r.isOnList())?(o=["circle","disc","disc-leading-zero","square"],s=n.inArray(f["list-style-type"],o)>-1,f["list-style"]=s?"unordered":"ordered"):f["list-style"]="none",e=i.ancestor(r.sc,i.isPara),e&&e.style["line-height"]?f["line-height"]=e.style.lineHeight:(h=parseInt(f["line-height"],10)/parseInt(f["font-size"],10),f["line-height"]=h.toFixed(1)),f.image=i.isImg(u)&&u,f.anchor=r.isOnAnchor()&&i.ancestor(r.sc,i.isAnchor),f.aAncestor=i.listAncestor(r.sc,i.isEditable),f}},r=function(){var t=!!document.createRange,r=function(n,t){for(var o,s=n.parentElement(),a=document.body.createTextRange(),h=f.from(s.childNodes),c,r,l,e,u=0;u<h.length;u++)if(!i.isText(h[u])){if(a.moveToElementText(h[u]),a.compareEndPoints("StartToStart",n)>=0)break;o=h[u]}if(0!==u&&i.isText(h[u-1])){for(c=document.body.createTextRange(),r=null,c.moveToElementText(o||s),c.collapse(!o),r=o?o.nextSibling:s.firstChild,l=n.duplicate(),l.setEndPoint("StartToStart",c),e=l.text.replace(/[\r\n]/g,"").length;e>r.nodeValue.length&&r.nextSibling;)e-=r.nodeValue.length,r=r.nextSibling;r.nodeValue;t&&r.nextSibling&&i.isText(r.nextSibling)&&e===r.nodeValue.length&&(e-=r.nodeValue.length,r=r.nextSibling);s=r;u=e}return{cont:s,offset:u}},u=function(n){var u=function(n,t){var r,o,s,h;if(i.isText(n))s=i.listPrev(n,e.not(i.isText)),h=f.last(s).previousSibling,r=h||n.parentNode,t+=f.sum(f.tail(s),i.length),o=!h;else{if(r=n.childNodes[t]||n,i.isText(r))return u(r,t);t=0;o=!1}return{cont:r,collapseToStart:o,offset:t}},t=document.body.createTextRange(),r=u(n.cont,n.offset);return t.moveToElementText(r.cont),t.collapse(r.collapseToStart),t.moveStart("character",r.offset),t},o=function(r,o,s,h){var l,c;this.sc=r;this.so=o;this.ec=s;this.eo=h;l=function(){var n,i;return t?(n=document.createRange(),n.setStart(r,o),n.setEnd(s,h),n):(i=u({cont:r,offset:o}),i.setEndPoint("EndToEnd",u({cont:s,offset:h})),i)};this.select=function(){var i=l(),n;t?(n=document.getSelection(),n.rangeCount>0&&n.removeAllRanges(),n.addRange(i)):i.select()};this.nodes=function(t){var u=i.listBetween(r,s),o=f.compact(n.map(u,function(n){return i.ancestor(n,t)}));return n.map(f.clusterBy(o,e.eq2),f.head)};this.commonAncestor=function(){return i.commonAncestor(r,s)};c=function(n){return function(){var t=i.ancestor(r,n);return!!t&&t===i.ancestor(s,n)}};this.isOnEditable=c(i.isEditable);this.isOnList=c(i.isList);this.isOnAnchor=c(i.isAnchor);this.isOnCell=c(i.isCell);this.isCollapsed=function(){return r===s&&o===h};this.insertNode=function(n){var i=l();t?i.insertNode(n):i.pasteHTML(n.outerHTML)};this.toString=function(){var n=l();return t?n.toString():n.text};this.bookmark=function(n){return{s:{path:i.makeOffsetPath(n,r),offset:o},e:{path:i.makeOffsetPath(n,s),offset:h}}}};return{create:function(n,i,u,f){var s,e,h,c,l,a,v;if(0===arguments.length)if(t){if(s=document.getSelection(),0===s.rangeCount)return null;e=s.getRangeAt(0);n=e.startContainer;i=e.startOffset;u=e.endContainer;f=e.endOffset}else h=document.selection.createRange(),c=h.duplicate(),c.collapse(!1),l=h,l.collapse(!0),a=r(l,!0),v=r(c,!1),n=a.cont,i=a.offset,u=v.cont,f=v.offset;else 2===arguments.length&&(u=n,f=i);return new o(n,i,u,f)},createFromNode:function(n){return this.create(n,0,n,1)},createFromBookmark:function(n,t){var r=i.fromOffsetPath(n,t.s.path),u=t.s.offset,f=i.fromOffsetPath(n,t.e.path),e=t.e.offset;return new o(r,u,f,e)}}}(),a=function(){this.tab=function(n,t){var u=i.ancestor(n.commonAncestor(),i.isCell),o=i.ancestor(u,i.isTable),s=i.listDescendant(o,i.isCell),e=f[t?"prev":"next"](s,u);e&&r.create(e,0).select()};this.createTable=function(t,r){for(var s,h,e,o,c,u=[],f=0;t>f;f++)u.push("<td>"+i.blank+"<\/td>");for(s=u.join(""),e=[],o=0;r>o;o++)e.push("<tr>"+s+"<\/tr>");return h=e.join(""),c='<table class="table table-bordered">'+h+"<\/table>",n(c)[0]}},v=function(){var s=new l,e=new a,h,f;this.saveRange=function(n){n.data("range",r.create())};this.restoreRange=function(n){var t=n.data("range");t&&t.select()};this.currentStyle=function(n){var t=r.create();return t.isOnEditable()&&s.current(t,n)};this.undo=function(n){n.data("NoteHistory").undo(n)};this.redo=function(n){n.data("NoteHistory").redo(n)};for(var t=this.recordUndo=function(n){n.data("NoteHistory").recordUndo(n)},o=["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],f=0,v=o.length;v>f;f++)this[o[f]]=function(n){return function(i,r){t(i);document.execCommand(n,!1,r)}}(o[f]);for(h=function(u,f,e){var s,o;t(u);s=new Array(e+1).join("&nbsp;");f.insertNode(n('<span id="noteTab">'+s+"<\/span>")[0]);o=n("#noteTab").removeAttr("id");f=r.create(o[0],1);f.select();i.remove(o[0])},this.tab=function(n,t){var i=r.create();i.isCollapsed()&&i.isOnCell()?e.tab(i):h(n,i,t.tabsize)},this.untab=function(){var n=r.create();n.isCollapsed()&&n.isOnCell()&&e.tab(n,!0)},this.insertImage=function(n,i){c.createImage(i).then(function(i){t(n);i.css({display:"",width:Math.min(n.width(),i.width())});r.create().insertNode(i[0])}).fail(function(){var t=n.data("callbacks");t.onImageUploadError&&t.onImageUploadError()})},this.insertVideo=function(i,u){var l;t(i);var f,e=u.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),o=u.match(/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/),s=u.match(/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/),h=u.match(/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/),c=u.match(/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/);e&&11===e[2].length?(l=e[2],f=n("<iframe>").attr("src","//www.youtube.com/embed/"+l).attr("width","640").attr("height","360")):o&&o[0].length>0?f=n("<iframe>").attr("src",o[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):s&&s[0].length>0?f=n("<iframe>").attr("src",s[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):h&&h[3].length>0?f=n("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360"):c&&c[2].length>0&&(f=n("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+c[2]).attr("width","640").attr("height","360"));f&&(f.attr("frameborder",0),r.create().insertNode(f[0]))},this.formatBlock=function(n,i){t(n);i=u.bMSIE?"<"+i+">":i;document.execCommand("FormatBlock",!1,i)},this.formatPara=function(n){this.formatBlock(n,"P")},f=1;6>=f;f++)this["formatH"+f]=function(n){return function(t){this.formatBlock(t,"H"+n)}}(f);this.fontSize=function(n,i){t(n);document.execCommand("fontSize",!1,3);u.bFF?n.find("font[size=3]").removeAttr("size").css("font-size",i+"px"):n.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",i+"px")};this.lineHeight=function(n,i){t(n);s.stylePara(r.create(),{lineHeight:i})};this.unlink=function(n){var u=r.create(),f;u.isOnAnchor()&&(t(n),f=i.ancestor(u.sc,i.isAnchor),u=r.createFromNode(f),u.select(),document.execCommand("unlink"))};this.createLink=function(f,e,o){var s=r.create(),h,c;t(f);h=e;(-1!==e.indexOf("@")&&-1===e.indexOf(":")?h="mailto:"+e:-1===e.indexOf("://")&&(h="http://"+e),(u.bMSIE||u.bFF)&&s.isCollapsed())?(s.insertNode(n('<A id="linkAnchor">'+e+"<\/A>")[0]),c=n("#linkAnchor").attr("href",h).removeAttr("id"),s=r.createFromNode(c[0]),s.select()):(document.execCommand("createlink",!1,h),s=r.create());n.each(s.nodes(i.isAnchor),function(t,i){o?n(i).attr("target","_blank"):n(i).removeAttr("target")})};this.getLinkInfo=function(){var t=r.create(),f=!0,e="",u;return t.isOnAnchor()&&(u=i.ancestor(t.sc,i.isAnchor),t=r.createFromNode(u),f="_blank"===n(u).attr("target"),e=u.href),{text:t.toString(),url:e,newWindow:f}};this.getVideoInfo=function(){var n=r.create(),t;return n.isOnAnchor()&&(t=i.ancestor(n.sc,i.isAnchor),n=r.createFromNode(t)),{text:n.toString()}};this.color=function(n,i){var r=JSON.parse(i),u=r.foreColor,f=r.backColor;t(n);u&&document.execCommand("foreColor",!1,u);f&&document.execCommand("backColor",!1,f)};this.insertTable=function(n,i){t(n);var u=i.split("x");r.create().insertNode(e.createTable(u[0],u[1]))};this.floatMe=function(n,i,r){t(n);r.css("float",i)};this.resize=function(n,i,r){t(n);r.css({width:n.width()*i+"px",height:""})};this.resizeTo=function(n,t,i){var u,f,r;i?(f=n.y/n.x,r=t.data("ratio"),u={width:r>f?n.x:n.y/r,height:r>f?n.x*r:n.y}):u={width:n.x,height:n.y};t.css(u)};this.removeMedia=function(n,i,r){t(n);r.detach()}},y=function(){var n=[],t=[],i=function(n){var t=n[0],i=r.create();return{contents:n.html(),bookmark:i.bookmark(t),scrollTop:n.scrollTop()}},u=function(n,t){n.html(t.contents).scrollTop(t.scrollTop);r.createFromBookmark(n[0],t.bookmark).select()};this.undo=function(r){var f=i(r);0!==n.length&&(u(r,n.pop()),t.push(f))};this.redo=function(r){var f=i(r);0!==t.length&&(u(r,t.pop()),n.push(f))};this.recordUndo=function(r){t=[];n.push(i(r))}},p=function(){this.update=function(t,i){var e=function(t,i){t.find(".dropdown-menu li a").each(function(){var t=n(this).data("value")+""==i+"";this.className=t?"checked":""})},r=function(n,i){var r=t.find(n);r.toggleClass("active",i())},o=t.find(".note-fontname"),u,s,h;o.length>0&&(u=i["font-family"],u&&(u=f.head(u.split(",")),u=u.replace(/\'/g,""),o.find(".note-current-fontname").text(u),e(o,u)));s=t.find(".note-fontsize");s.find(".note-current-fontsize").text(i["font-size"]);e(s,parseFloat(i["font-size"]));h=t.find(".note-height");e(h,parseFloat(i["line-height"]));r('button[data-event="bold"]',function(){return"bold"===i["font-bold"]});r('button[data-event="italic"]',function(){return"italic"===i["font-italic"]});r('button[data-event="underline"]',function(){return"underline"===i["font-underline"]});r('button[data-event="strikethrough"]',function(){return"strikethrough"===i["font-strikethrough"]});r('button[data-event="justifyLeft"]',function(){return"left"===i["text-align"]||"start"===i["text-align"]});r('button[data-event="justifyCenter"]',function(){return"center"===i["text-align"]});r('button[data-event="justifyRight"]',function(){return"right"===i["text-align"]});r('button[data-event="justifyFull"]',function(){return"justify"===i["text-align"]});r('button[data-event="insertUnorderedList"]',function(){return"unordered"===i["list-style"]});r('button[data-event="insertOrderedList"]',function(){return"ordered"===i["list-style"]})};this.updateRecentColor=function(t,i,r){var o=n(t).closest(".note-color"),u=o.find(".note-recent-color"),f=JSON.parse(u.attr("data-value")),e;f[i]=r;u.attr("data-value",JSON.stringify(f));e="backColor"===i?"background-color":"color";u.find("i").css(e,r)};this.updateFullscreen=function(n,t){var i=n.find('button[data-event="fullscreen"]');i.toggleClass("active",t)};this.updateCodeview=function(n,t){var i=n.find('button[data-event="codeview"]');i.toggleClass("active",t)};this.activate=function(n){n.find("button").not('button[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(n){n.find("button").not('button[data-event="codeview"]').addClass("disabled")}},w=function(){var t=function(t,i){var r=n(i),u=r.position(),f=r.height();t.css({display:"block",left:u.left,top:u.top+f})};this.update=function(n,i){var r=n.find(".note-link-popover"),f,u;i.anchor?(f=r.find("a"),f.attr("href",i.anchor.href).html(i.anchor.href),t(r,i.anchor)):r.hide();u=n.find(".note-image-popover");i.image?t(u,i.image):u.hide()};this.hide=function(n){n.children().hide()}},b=function(){this.update=function(t,i){var u=t.find(".note-control-selection"),o;if(i.image){var f=n(i.image),e=f.position(),r={w:f.width(),h:f.height()};u.css({display:"block",left:e.left,top:e.top,width:r.w,height:r.h}).data("target",i.image);o=r.w+"x"+r.h;u.find(".note-control-selection-info").text(o)}else u.hide()};this.hide=function(n){n.children().hide()}},k=function(){var t=function(n,t){n.toggleClass("disabled",!t);n.attr("disabled",!t)};this.showImageDialog=function(i,r){return n.Deferred(function(n){var f=r.find(".note-image-dialog"),e=r.find(".note-image-input"),u=r.find(".note-image-url"),o=r.find(".note-image-btn");f.one("shown.bs.modal",function(){e.replaceWith(e.clone().on("change",function(){f.modal("hide");n.resolve(this.files)}));o.click(function(t){t.preventDefault();f.modal("hide");n.resolve(u.val())});u.keyup(function(){t(o,u.val())}).val("").focus()}).one("hidden.bs.modal",function(){i.focus();e.off("change");u.off("keyup");o.off("click")}).modal("show")})};this.showVideoDialog=function(i,r,u){return n.Deferred(function(n){var f=r.find(".note-video-dialog"),e=f.find(".note-video-url"),o=f.find(".note-video-btn");f.one("shown.bs.modal",function(){e.val(u.text).keyup(function(){t(o,e.val())}).trigger("keyup").trigger("focus");o.click(function(t){t.preventDefault();f.modal("hide");n.resolve(e.val())})}).one("hidden.bs.modal",function(){i.focus();e.off("keyup");o.off("click")}).modal("show")})};this.showLinkDialog=function(i,r,u){return n.Deferred(function(n){var f=r.find(".note-link-dialog"),o=f.find(".note-link-text"),e=f.find(".note-link-url"),s=f.find(".note-link-btn"),h=f.find("input[type=checkbox]");f.one("shown.bs.modal",function(){o.val(u.text);e.keyup(function(){t(s,e.val());u.text||o.val(e.val())}).val(u.url).trigger("focus");h.prop("checked",u.newWindow);s.one("click",function(t){t.preventDefault();f.modal("hide");n.resolve(e.val(),h.is(":checked"))})}).one("hidden.bs.modal",function(){i.focus();e.off("keyup")}).modal("show")}).promise()};this.showHelpDialog=function(n,t){var i=t.find(".note-help-dialog");i.one("hidden.bs.modal",function(){n.focus()}).modal("show")}},d=function(){var r=new v,o=new p,l=new w,a=new b,h=new k,e=function(t){var r=n(t).closest(".note-editor");return r.length>0&&i.buildLayoutInfo(r)},d=function(t,i){r.restoreRange(t);var u=t.data("callbacks");u.onImageUpload?u.onImageUpload(i,r,t):n.each(i,function(n,i){c.readFileAsDataURL(i).then(function(n){r.insertImage(t,n)}).fail(function(){u.onImageUploadError&&u.onImageUploadError()})})},rt=function(n){i.isImg(n.target)&&n.preventDefault()},g=function(n){var i=e(n.currentTarget||n.target),t=r.currentStyle(n.target);t&&(o.update(i.toolbar(),t),l.update(i.popover(),t),a.update(i.handle(),t))},ut=function(n){var t=e(n.currentTarget||n.target);l.hide(t.popover());a.hide(t.handle())},ft=function(n){var t=n.originalEvent;if(t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length){var r=e(n.currentTarget||n.target),i=f.head(t.clipboardData.items),u="file"===i.kind&&-1!==i.type.indexOf("image/");u&&d(r.editable(),[i.getAsFile()])}},et=function(t){if(i.isControlSizing(t.target)){var f=e(t.target),s=f.handle(),v=f.popover(),y=f.editable(),h=f.editor(),o=s.find(".note-control-selection").data("target"),u=n(o),c=u.offset(),p=n(document).scrollTop();h.on("mousemove",function(n){r.resizeTo({x:n.clientX-c.left,y:n.clientY-(c.top-p)},u,!n.shiftKey);a.update(s,{image:o});l.update(v,{image:o})}).one("mouseup",function(){h.off("mousemove")});u.data("ratio")||u.data("ratio",u.height()/u.width());r.recordUndo(y);t.stopPropagation();t.preventDefault()}},nt=function(t){var i=n(t.target).closest("[data-event]");i.length>0&&t.preventDefault()},tt=function(f){var p=n(f.target).closest("[data-event]"),st,ht,ct,lt,tt,it,rt,ut,ft;if(p.length>0){var k,c,et,a=p.attr("data-event"),ot=p.attr("data-value"),v=e(f.target),y=v.editor(),w=v.toolbar(),b=v.dialog(),s=v.editable(),l=v.codable(),nt=y.data("options");-1!==n.inArray(a,["resize","floatMe","removeMedia"])&&(st=v.handle(),ht=st.find(".note-control-selection"),et=n(ht.data("target")));(r[a]&&(s.trigger("focus"),r[a](s,ot,et)),-1!==n.inArray(a,["backColor","foreColor"]))?o.updateRecentColor(p[0],a,ot):"showLinkDialog"===a?(s.focus(),ct=r.getLinkInfo(),r.saveRange(s),h.showLinkDialog(s,b,ct).then(function(n,t){r.restoreRange(s);r.createLink(s,n,t)})):"showImageDialog"===a?(s.focus(),h.showImageDialog(s,b).then(function(n){"string"==typeof n?(r.restoreRange(s),r.insertImage(s,n)):d(s,n)})):"showVideoDialog"===a?(s.focus(),lt=r.getVideoInfo(),r.saveRange(s),h.showVideoDialog(s,b,lt).then(function(n){r.restoreRange(s);r.insertVideo(s,n)})):"showHelpDialog"===a?h.showHelpDialog(s,b):"fullscreen"===a?(tt=n("html, body"),it=function(n){y.css("width",n.w);s.css("height",n.h);l.css("height",n.h);l.data("cmEditor")&&l.data("cmEditor").setSize(null,n.h)},y.toggleClass("fullscreen"),rt=y.hasClass("fullscreen"),rt?(s.data("orgHeight",s.css("height")),n(window).on("resize",function(){it({w:n(window).width(),h:n(window).height()-w.outerHeight()})}).trigger("resize"),tt.css("overflow","hidden")):(n(window).off("resize"),it({w:nt.width||"",h:s.data("orgHeight")}),tt.css("overflow","auto")),o.updateFullscreen(w,rt)):"codeview"===a&&(y.toggleClass("codeview"),ut=y.hasClass("codeview"),ut?(l.val(s.html()),l.height(s.height()),o.deactivate(w),l.focus(),u.bCodeMirror)&&(c=t.fromTextArea(l[0],n.extend({mode:"text/html",lineNumbers:!0},nt.codemirror)),ft=y.data("options").codemirror.tern||!1,ft&&(k=new t.TernServer(ft),c.ternServer=k,c.on("cursorActivity",function(n){k.updateArgHints(n)})),c.setSize(null,s.outerHeight()),c.autoFormatRange&&c.autoFormatRange({line:0,ch:0},{line:c.lineCount(),ch:c.getTextArea().value.length}),l.data("cmEditor",c)):(u.bCodeMirror&&(c=l.data("cmEditor"),l.val(c.getValue()),c.toTextArea()),s.html(l.val()||i.emptyPara),s.height(nt.height?l.height():"auto"),o.activate(w),s.focus()),o.updateCodeview(v.toolbar(),ut));g(f)}},ot=24,st=function(t){var i=n(document),r=e(t.target).editable(),u=r.offset().top-i.scrollTop();i.on("mousemove",function(n){var t=n.clientY-(u+ot);r.height(t)}).one("mouseup",function(){i.off("mousemove")});t.stopPropagation();t.preventDefault()},it=18,ht=function(t){var r,u=n(t.target.parentNode),o=u.next(),s=u.find(".note-dimension-picker-mousecatcher"),h=u.find(".note-dimension-picker-highlighted"),e=u.find(".note-dimension-picker-unhighlighted"),f,i;void 0===t.offsetX?(f=n(t.target).offset(),r={x:t.pageX-f.left,y:t.pageY-f.top}):r={x:t.offsetX,y:t.offsetY};i={c:Math.ceil(r.x/it)||1,r:Math.ceil(r.y/it)||1};h.css({width:i.c+"em",height:i.r+"em"});s.attr("data-value",i.c+"x"+i.r);3<i.c&&i.c<10&&e.css({width:i.c+1+"em"});3<i.r&&i.r<10&&e.css({height:i.r+1+"em"});o.html(i.c+" x "+i.r)},ct=function(t){var i=n(),r=t.dropzone,u=t.dropzone.find(".note-dropzone-message");n(document).on("dragenter",function(n){var f=t.editor.hasClass("codeview");f||0!==i.length||(t.editor.addClass("dragover"),r.width(t.editor.width()),r.height(t.editor.height()),u.text("Drag Image Here"));i=i.add(n.target)}).on("dragleave",function(n){i=i.not(n.target);0===i.length&&t.editor.removeClass("dragover")}).on("drop",function(){i=n();t.editor.removeClass("dragover")});r.on("dragenter",function(){r.addClass("hover");u.text("Drop Image")}).on("dragleave",function(){r.removeClass("hover");u.text("Drag Image Here")});r.on("drop",function(n){var t=n.originalEvent.dataTransfer,i;t&&t.files&&(i=e(n.currentTarget||n.target),i.editable().focus(),d(i.editable(),t.files));n.preventDefault()}).on("dragover",!1)};this.bindKeyMap=function(n,t){var u=n.editor,i=n.editable;i.on("keydown",function(n){var f=[],e,o;n.metaKey&&f.push("CMD");n.ctrlKey&&f.push("CTRL");n.shiftKey&&f.push("SHIFT");e=s.nameFromCode[n.keyCode];e&&f.push(e);o=t[f.join("+")];o?(n.preventDefault(),r[o](i,u.data("options"))):s.isEdit(n.keyCode)&&r.recordUndo(i)})};this.attach=function(n,t){var f,e,i;this.bindKeyMap(n,t.keyMap[u.bMac?"mac":"pc"]);n.editable.on("mousedown",rt);n.editable.on("keyup mouseup",g);n.editable.on("scroll",ut);n.editable.on("paste",ft);t.disableDragAndDrop||ct(n);n.handle.on("mousedown",et);n.toolbar.on("click",tt);n.popover.on("click",tt);n.toolbar.on("mousedown",nt);n.popover.on("mousedown",nt);n.statusbar.on("mousedown",st);f=n.toolbar;e=f.find(".note-dimension-picker-mousecatcher");(e.on("mousemove",ht),n.editable.on("blur",function(){r.saveRange(n.editable)}),n.editor.data("options",t),t.styleWithSpan&&!u.bMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)}),n.editable.data("NoteHistory",new y),t.onenter&&n.editable.keypress(function(n){n.keyCode===s.ENTER&&t.onenter(n)}),t.onfocus&&n.editable.focus(t.onfocus),t.onblur&&n.editable.blur(t.onblur),t.onkeyup&&n.editable.keyup(t.onkeyup),t.onkeydown&&n.editable.keydown(t.onkeydown),t.onpaste&&n.editable.on("paste",t.onpaste),t.onToolbarClick&&n.toolbar.click(t.onToolbarClick),t.onChange)&&(i=function(){t.onChange(n.editable,n.editable.html())},u.bMSIE?n.editable.on("DOMCharacterDataModified, DOMSubtreeModified, DOMNodeInserted",i):n.editable.on("input",i));n.editable.data("callbacks",{onAutoSave:t.onAutoSave,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onFileUpload:t.onFileUpload,onFileUploadError:t.onFileUpload})};this.dettach=function(n){n.editable.off();n.toolbar.off();n.handle.off();n.popover.off()}},g=function(){var t,r,c,f,e;t={picture:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.image+'" data-event="showImageDialog" tabindex="-1"><i class="fa fa-picture-o icon-picture"><\/i><\/button>'},link:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.link.link+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-link icon-link"><\/i><\/button>'},video:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.video.video+'" data-event="showVideoDialog" tabindex="-1"><i class="fa fa-youtube-play icon-play"><\/i><\/button>'},table:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+n.table.table+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-table icon-table"><\/i> <span class="caret"><\/span><\/button><ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"><\/div><div class="note-dimension-picker-highlighted"><\/div><div class="note-dimension-picker-unhighlighted"><\/div><\/div><div class="note-dimension-display"> 1 x 1 <\/div><\/ul>'},style:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+n.style.style+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-magic icon-magic"><\/i> <span class="caret"><\/span><\/button><ul class="dropdown-menu"><li><a data-event="formatBlock" data-value="p">'+n.style.normal+'<\/a><\/li><li><a data-event="formatBlock" data-value="blockquote"><blockquote>'+n.style.blockquote+'<\/blockquote><\/a><\/li><li><a data-event="formatBlock" data-value="pre">'+n.style.pre+'<\/a><\/li><li><a data-event="formatBlock" data-value="h1"><h1>'+n.style.h1+'<\/h1><\/a><\/li><li><a data-event="formatBlock" data-value="h2"><h2>'+n.style.h2+'<\/h2><\/a><\/li><li><a data-event="formatBlock" data-value="h3"><h3>'+n.style.h3+'<\/h3><\/a><\/li><li><a data-event="formatBlock" data-value="h4"><h4>'+n.style.h4+'<\/h4><\/a><\/li><li><a data-event="formatBlock" data-value="h5"><h5>'+n.style.h5+'<\/h5><\/a><\/li><li><a data-event="formatBlock" data-value="h6"><h6>'+n.style.h6+"<\/h6><\/a><\/li><\/ul>"},fontname:function(n){var i=["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],r='<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+n.font.name+'" tabindex="-1"><span class="note-current-fontname">Arial<\/span> <b class="caret"><\/b><\/button>',t;for(r+='<ul class="dropdown-menu">',t=0;t<i.length;t++)r+='<li><a data-event="fontName" data-value="'+i[t]+'"><i class="fa fa-check icon-ok"><\/i> '+i[t]+"<\/a><\/li>";return r+"<\/ul>"},fontsize:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+n.font.size+'" tabindex="-1"><span class="note-current-fontsize">11<\/span> <b class="caret"><\/b><\/button><ul class="dropdown-menu"><li><a data-event="fontSize" data-value="8"><i class="fa fa-check icon-ok"><\/i> 8<\/a><\/li><li><a data-event="fontSize" data-value="9"><i class="fa fa-check icon-ok"><\/i> 9<\/a><\/li><li><a data-event="fontSize" data-value="10"><i class="fa fa-check icon-ok"><\/i> 10<\/a><\/li><li><a data-event="fontSize" data-value="11"><i class="fa fa-check icon-ok"><\/i> 11<\/a><\/li><li><a data-event="fontSize" data-value="12"><i class="fa fa-check icon-ok"><\/i> 12<\/a><\/li><li><a data-event="fontSize" data-value="14"><i class="fa fa-check icon-ok"><\/i> 14<\/a><\/li><li><a data-event="fontSize" data-value="18"><i class="fa fa-check icon-ok"><\/i> 18<\/a><\/li><li><a data-event="fontSize" data-value="24"><i class="fa fa-check icon-ok"><\/i> 24<\/a><\/li><li><a data-event="fontSize" data-value="36"><i class="fa fa-check icon-ok"><\/i> 36<\/a><\/li><\/ul>'},color:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small note-recent-color" title="'+n.color.recent+'" data-event="color" data-value=\'{"backColor":"yellow"}\' tabindex="-1"><i class="fa fa-font icon-font" style="color:black;background-color:yellow;"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+n.color.more+'" data-toggle="dropdown" tabindex="-1"><span class="caret"><\/span><\/button><ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+n.color.background+'<\/div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+n.color.transparent+'">'+n.color.setTransparent+'<\/div><div class="note-color-palette" data-target-event="backColor"><\/div><\/div><div class="btn-group"><div class="note-palette-title">'+n.color.foreground+'<\/div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+n.color.reset+'">'+n.color.resetToDefault+'<\/div><div class="note-color-palette" data-target-event="foreColor"><\/div><\/div><\/li><\/ul>'},bold:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.font.bold+'" data-shortcut="Ctrl+B" data-mac-shortcut="⌘+B" data-event="bold" tabindex="-1"><i class="fa fa-bold icon-bold"><\/i><\/button>'},italic:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.font.italic+'" data-shortcut="Ctrl+I" data-mac-shortcut="⌘+I" data-event="italic" tabindex="-1"><i class="fa fa-italic icon-italic"><\/i><\/button>'},underline:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.font.underline+'" data-shortcut="Ctrl+U" data-mac-shortcut="⌘+U" data-event="underline" tabindex="-1"><i class="fa fa-underline icon-underline"><\/i><\/button>'},strike:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.font.strike+'" data-event="strikethrough" tabindex="-1"><i class="fa fa-strikethrough icon-strikethrough"><\/i><\/button>'},clear:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.font.clear+'" data-shortcut="Ctrl+\\" data-mac-shortcut="⌘+\\" data-event="removeFormat" tabindex="-1"><i class="fa fa-eraser icon-eraser"><\/i><\/button>'},ul:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.lists.unordered+'" data-shortcut="Ctrl+Shift+8" data-mac-shortcut="⌘+⇧+7" data-event="insertUnorderedList" tabindex="-1"><i class="fa fa-list-ul icon-list-ul"><\/i><\/button>'},ol:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.lists.ordered+'" data-shortcut="Ctrl+Shift+7" data-mac-shortcut="⌘+⇧+8" data-event="insertOrderedList" tabindex="-1"><i class="fa fa-list-ol icon-list-ol"><\/i><\/button>'},paragraph:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+n.paragraph.paragraph+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-align-left icon-align-left"><\/i>  <span class="caret"><\/span><\/button><div class="dropdown-menu"><div class="note-align btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.left+'" data-shortcut="Ctrl+Shift+L" data-mac-shortcut="⌘+⇧+L" data-event="justifyLeft" tabindex="-1"><i class="fa fa-align-left icon-align-left"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.center+'" data-shortcut="Ctrl+Shift+E" data-mac-shortcut="⌘+⇧+E" data-event="justifyCenter" tabindex="-1"><i class="fa fa-align-center icon-align-center"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.right+'" data-shortcut="Ctrl+Shift+R" data-mac-shortcut="⌘+⇧+R" data-event="justifyRight" tabindex="-1"><i class="fa fa-align-right icon-align-right"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.justify+'" data-shortcut="Ctrl+Shift+J" data-mac-shortcut="⌘+⇧+J" data-event="justifyFull" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"><\/i><\/button><\/div><div class="note-list btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.outdent+'" data-shortcut="Ctrl+[" data-mac-shortcut="⌘+[" data-event="outdent" tabindex="-1"><i class="fa fa-outdent icon-indent-left"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.paragraph.indent+'" data-shortcut="Ctrl+]" data-mac-shortcut="⌘+]" data-event="indent" tabindex="-1"><i class="fa fa-indent icon-indent-right"><\/i><\/button><\/div><\/div>'},height:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+n.font.height+'" tabindex="-1"><i class="fa fa-text-height icon-text-height"><\/i>&nbsp; <b class="caret"><\/b><\/button><ul class="dropdown-menu"><li><a data-event="lineHeight" data-value="1.0"><i class="fa fa-check icon-ok"><\/i> 1.0<\/a><\/li><li><a data-event="lineHeight" data-value="1.2"><i class="fa fa-check icon-ok"><\/i> 1.2<\/a><\/li><li><a data-event="lineHeight" data-value="1.4"><i class="fa fa-check icon-ok"><\/i> 1.4<\/a><\/li><li><a data-event="lineHeight" data-value="1.5"><i class="fa fa-check icon-ok"><\/i> 1.5<\/a><\/li><li><a data-event="lineHeight" data-value="1.6"><i class="fa fa-check icon-ok"><\/i> 1.6<\/a><\/li><li><a data-event="lineHeight" data-value="1.8"><i class="fa fa-check icon-ok"><\/i> 1.8<\/a><\/li><li><a data-event="lineHeight" data-value="2.0"><i class="fa fa-check icon-ok"><\/i> 2.0<\/a><\/li><li><a data-event="lineHeight" data-value="3.0"><i class="fa fa-check icon-ok"><\/i> 3.0<\/a><\/li><\/ul>'},help:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.options.help+'" data-event="showHelpDialog" tabindex="-1"><i class="fa fa-question icon-question"><\/i><\/button>'},fullscreen:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.options.fullscreen+'" data-event="fullscreen" tabindex="-1"><i class="fa fa-arrows-alt icon-fullscreen"><\/i><\/button>'},codeview:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.options.codeview+'" data-event="codeview" tabindex="-1"><i class="fa fa-code icon-code"><\/i><\/button>'},undo:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.history.undo+'" data-event="undo" tabindex="-1"><i class="fa fa-undo icon-undo"><\/i><\/button>'},redo:function(n){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+n.history.redo+'" data-event="redo" tabindex="-1"><i class="fa fa-repeat icon-repeat"><\/i><\/button>'}};r=function(n){return'<div class="note-popover"><div class="note-link-popover popover bottom in" style="display: none;"><div class="arrow"><\/div><div class="popover-content note-link-content"><a href="http://www.google.com" target="_blank">www.google.com<\/a>&nbsp;&nbsp;<div class="note-insert btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.link.edit+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-edit icon-edit"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.link.unlink+'" data-event="unlink" tabindex="-1"><i class="fa fa-unlink icon-unlink"><\/i><\/button><\/div><\/div><\/div><div class="note-image-popover popover bottom in" style="display: none;"><div class="arrow"><\/div><div class="popover-content note-image-content"><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.resizeFull+'" data-event="resize" data-value="1" tabindex="-1"><span class="note-fontsize-10">100%<\/span> <\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.resizeHalf+'" data-event="resize" data-value="0.5" tabindex="-1"><span class="note-fontsize-10">50%<\/span> <\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.resizeQuarter+'" data-event="resize" data-value="0.25" tabindex="-1"><span class="note-fontsize-10">25%<\/span> <\/button><\/div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.floatLeft+'" data-event="floatMe" data-value="left" tabindex="-1"><i class="fa fa-align-left icon-align-left"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.floatRight+'" data-event="floatMe" data-value="right" tabindex="-1"><i class="fa fa-align-right icon-align-right"><\/i><\/button><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.floatNone+'" data-event="floatMe" data-value="none" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"><\/i><\/button><\/div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+n.image.remove+'" data-event="removeMedia" data-value="none" tabindex="-1"><i class="fa fa-trash-o icon-trash"><\/i><\/button><\/div><\/div><\/div><\/div>'};var c=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"><\/div><div class="note-control-holder note-control-nw"><\/div><div class="note-control-holder note-control-ne"><\/div><div class="note-control-holder note-control-sw"><\/div><div class="note-control-sizing note-control-se"><\/div><div class="note-control-selection-info"><\/div><\/div><\/div>'},l=function(n){return'<table class="note-shortcut"><thead><tr><th><\/th><th>'+n.shortcut.textFormatting+"<\/th><\/tr><\/thead><tbody><tr><td>⌘ + B<\/td><td>"+n.font.bold+"<\/td><\/tr><tr><td>⌘ + I<\/td><td>"+n.font.italic+"<\/td><\/tr><tr><td>⌘ + U<\/td><td>"+n.font.underline+"<\/td><\/tr><tr><td>⌘ + ⇧ + S<\/td><td>"+n.font.strike+"<\/td><\/tr><tr><td>⌘ + \\<\/td><td>"+n.font.clear+"<\/td><\/tr><\/tr><\/tbody><\/table>"},a=function(n){return'<table class="note-shortcut"><thead><tr><th><\/th><th>'+n.shortcut.action+"<\/th><\/tr><\/thead><tbody><tr><td>⌘ + Z<\/td><td>"+n.history.undo+"<\/td><\/tr><tr><td>⌘ + ⇧ + Z<\/td><td>"+n.history.redo+"<\/td><\/tr><tr><td>⌘ + ]<\/td><td>"+n.paragraph.indent+"<\/td><\/tr><tr><td>⌘ + [<\/td><td>"+n.paragraph.outdent+"<\/td><\/tr><tr><td>⌘ + ENTER<\/td><td>"+n.hr.insert+"<\/td><\/tr><\/tbody><\/table>"},v=function(n,t){var r='<table class="note-shortcut"><thead><tr><th><\/th><th>'+n.shortcut.extraKeys+"<\/th><\/tr><\/thead><tbody>";for(var i in t.extraKeys)t.extraKeys.hasOwnProperty(i)&&(r+="<tr><td>"+i+"<\/td><td>"+t.extraKeys[i]+"<\/td><\/tr>");return r+"<\/tbody><\/table>"},y=function(n){return'<table class="note-shortcut"><thead><tr><th><\/th><th>'+n.shortcut.paragraphFormatting+"<\/th><\/tr><\/thead><tbody><tr><td>⌘ + ⇧ + L<\/td><td>"+n.paragraph.left+"<\/td><\/tr><tr><td>⌘ + ⇧ + E<\/td><td>"+n.paragraph.center+"<\/td><\/tr><tr><td>⌘ + ⇧ + R<\/td><td>"+n.paragraph.right+"<\/td><\/tr><tr><td>⌘ + ⇧ + J<\/td><td>"+n.paragraph.justify+"<\/td><\/tr><tr><td>⌘ + ⇧ + NUM7<\/td><td>"+n.lists.ordered+"<\/td><\/tr><tr><td>⌘ + ⇧ + NUM8<\/td><td>"+n.lists.unordered+"<\/td><\/tr><\/tbody><\/table>"},p=function(n){return'<table class="note-shortcut"><thead><tr><th><\/th><th>'+n.shortcut.documentStyle+"<\/th><\/tr><\/thead><tbody><tr><td>⌘ + NUM0<\/td><td>"+n.style.normal+"<\/td><\/tr><tr><td>⌘ + NUM1<\/td><td>"+n.style.h1+"<\/td><\/tr><tr><td>⌘ + NUM2<\/td><td>"+n.style.h2+"<\/td><\/tr><tr><td>⌘ + NUM3<\/td><td>"+n.style.h3+"<\/td><\/tr><tr><td>⌘ + NUM4<\/td><td>"+n.style.h4+"<\/td><\/tr><tr><td>⌘ + NUM5<\/td><td>"+n.style.h5+"<\/td><\/tr><tr><td>⌘ + NUM6<\/td><td>"+n.style.h6+"<\/td><\/tr><\/tbody><\/table>"},o=function(n,t){var i='<table class="note-shortcut-layout"><tbody><tr><td>'+a(n,t)+"<\/td><td>"+l(n,t)+"<\/td><\/tr><tr><td>"+p(n,t)+"<\/td><td>"+y(n,t)+"<\/td><\/tr>";return t.extraKeys&&(i+='<tr><td colspan="2">'+v(n,t)+"<\/td><\/tr>"),i+"<\/tbody<\/table>"},w=function(n){return n.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")};f=function(n,t){var i=function(){return'<div class="note-image-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;<\/button><h4>'+n.image.insert+'<\/h4><\/div><div class="modal-body"><div class="row-fluid"><h5>'+n.image.selectFromFiles+'<\/h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+n.image.url+'<\/h5><input class="note-image-url form-control span12" type="text" /><\/div><\/div><div class="modal-footer"><button href="#" class="btn btn-primary note-image-btn disabled" disabled="disabled">'+n.image.insert+"<\/button><\/div><\/div><\/div><\/div>"},r=function(){return'<div class="note-link-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;<\/button><h4>'+n.link.insert+'<\/h4><\/div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+n.link.textToDisplay+'<\/label><input class="note-link-text form-control span12" disabled type="text" /><\/div><div class="form-group"><label>'+n.link.url+'<\/label><input class="note-link-url form-control span12" type="text" /><\/div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+n.link.openInNewWindow+"<\/label><\/div>")+'<\/div><\/div><div class="modal-footer"><button href="#" class="btn btn-primary note-link-btn disabled" disabled="disabled">'+n.link.insert+"<\/button><\/div><\/div><\/div><\/div>"},f=function(){return'<div class="note-video-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;<\/button><h4>'+n.video.insert+'<\/h4><\/div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+n.video.url+'<\/label>&nbsp;<small class="text-muted">'+n.video.providers+'<\/small><input class="note-video-url form-control span12" type="text" /><\/div><\/div><\/div><div class="modal-footer"><button href="#" class="btn btn-primary note-video-btn disabled" disabled="disabled">'+n.video.insert+"<\/button><\/div><\/div><\/div><\/div>"},e=function(){return'<div class="note-help-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+n.shortcut.close+'<\/a><div class="title">'+n.shortcut.shortcuts+"<\/div>"+(u.bMac?o(n,t):w(o(n,t)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.2<\/a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project<\/a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues<\/a><\/p><\/div><\/div><\/div><\/div>'};return'<div class="note-dialog">'+i()+r()+f()+e()+"<\/div>"};e=function(){return'<div class="note-resizebar"><div class="note-icon-bar"><\/div><div class="note-icon-bar"><\/div><div class="note-icon-bar"><\/div><\/div>'};var s=function(t,i){t.find("button").each(function(t,i){var r=n(i),f=r.attr(u.bMac?"data-mac-shortcut":"data-shortcut");f&&r.attr("title",function(n,t){return t+" ("+f+")"})}).tooltip({container:"body",trigger:"hover",placement:i||"top"}).on("click",function(){n(this).tooltip("hide")})},h=[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],b=function(t){t.find(".note-color-palette").each(function(){for(var t,u=n(this),s=u.attr("data-target-event"),f=[],i=0,c=h.length;c>i;i++){for(var e=h[i],o=[],r=0,l=e.length;l>r;r++)t=e[r],o.push(['<button type="button" class="note-color-btn" style="background-color:',t,';" data-event="',s,'" data-value="',t,'" title="',t,'" data-toggle="button" tabindex="-1"><\/button>'].join(""));f.push("<div>"+o.join("")+"<\/div>")}u.html(f.join(""))})};this.createLayout=function(u,o){var d=u.next(),h,g,a,v,y,nt,k,tt,it;if(!d||!d.hasClass("note-editor")){h=n('<div class="note-editor"><\/div>');o.width&&h.width(o.width);o.height>0&&n('<div class="note-statusbar">'+e()+"<\/div>").prependTo(h);g=!u.is(":disabled");a=n('<div class="note-editable" contentEditable="'+g+'"><\/div>').prependTo(h);o.height&&a.height(o.height);o.direction&&a.attr("dir",o.direction);a.html(i.html(u)||i.emptyPara);n('<textarea class="note-codable"><\/textarea>').prependTo(h);for(var p=n.summernote.lang[o.lang],l="",w=0,rt=o.toolbar.length;rt>w;w++){for(v=o.toolbar[w],l+='<div class="note-'+v[0]+' btn-group">',y=0,nt=v[1].length;nt>y;y++)l+=t[v[1][y]](p);l+="<\/div>"}l='<div class="note-toolbar btn-toolbar">'+l+"<\/div>";k=n(l).prependTo(h);b(k);s(k,"bottom");tt=n(r(p)).prependTo(h);s(tt);n(c()).prependTo(h);it=n(f(p,o)).prependTo(h);it.find("button.close, a.modal-close").click(function(){n(this).closest(".modal").modal("hide")});n('<div class="note-dropzone"><div class="note-dropzone-message"><\/div><\/div>').prependTo(h);h.insertAfter(u);u.hide()}};this.layoutInfoFromHolder=function(n){var u=n.next(),t,r;if(u.hasClass("note-editor")){t=i.buildLayoutInfo(u);for(r in t)t.hasOwnProperty(r)&&(t[r]=t[r].call());return t}};this.removeLayout=function(n){var t=this.layoutInfoFromHolder(n);t&&(n.html(t.editable.html()),t.editor.remove(),n.show())}};n.summernote=n.summernote||{};n.extend(n.summernote,{version:"0.5.2",options:{width:null,height:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,codemirror:null,lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview"]],["help",["help"]]],oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, or DailyMotion)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"BackColor",foreground:"FontColor",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}});o=new g;h=new d;n.fn.extend({summernote:function(t){if(t=n.extend({},n.summernote.options,t),this.each(function(r,u){var f=n(u),e;o.createLayout(f,t);e=o.layoutInfoFromHolder(f);h.attach(e,t);i.isTextarea(f[0])&&f.closest("form").submit(function(){f.html(f.code())})}),this.first()&&t.focus){var r=o.layoutInfoFromHolder(this.first());r.editable.focus()}return this.length>0&&t.oninit&&t.oninit(),this},code:function(t){var r,i,f;return void 0===t?(r=this.first(),0===r.length)?void 0:(i=o.layoutInfoFromHolder(r),i&&i.editable)?(f=i.editor.hasClass("codeview"),f&&u.bCodeMirror&&i.codable.data("cmEditor").save(),f?i.codable.val():i.editable.html()):r.html():(this.each(function(i,r){var u=o.layoutInfoFromHolder(n(r));u&&u.editable&&u.editable.html(t)}),this)},destroy:function(){return this.each(function(t,i){var u=n(i),r=o.layoutInfoFromHolder(u);r&&r.editable&&(h.dettach(r),o.removeLayout(u))}),this}})})